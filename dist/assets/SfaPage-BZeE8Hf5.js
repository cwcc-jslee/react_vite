var Jl=a=>{throw TypeError(a)};var Zi=(a,l,s)=>l.has(a)||Jl("Cannot "+s);var q=(a,l,s)=>(Zi(a,l,"read from private field"),s?s.call(a):l.get(a)),Ge=(a,l,s)=>l.has(a)?Jl("Cannot add the same private member more than once"):l instanceof WeakSet?l.add(a):l.set(a,s),Re=(a,l,s,f)=>(Zi(a,l,"write to private field"),f?f.call(a,s):l.set(a,s),s),$e=(a,l,s)=>(Zi(a,l,"access private method"),s);import{r as vy,j as i,S as by,p as eu,a as zt,s as ia,b as Is,n as wy,i as aa,c as tu,t as Sy,f as jy,d as Iy,e as nu,g as bu,h as L,u as Cy,k as wu,q as yn,l as wt,o as Gn,m as Ay,B as De,v as ws,I as it,M as oa,w as dt,C as ma,x as ya,F as As,G as bt,y as Ue,L as qe,z as Ar,T as Ey,D as Su,A as ht,E as oe,H as me,J as ru,K as su,N as Ny}from"./index-76PMqpms.js";const Ty=({isOpen:a,onClose:l,title:s,children:f,size:p="md",hideClose:y=!1,footer:_,titleClassName:C="",bodyClassName:A="",footerClassName:P=""})=>{if(!a)return null;const E={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl",full:"max-w-full mx-4"},b=i.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[i.jsx("div",{className:"fixed inset-0 bg-black/50 transition-opacity",onClick:l}),i.jsxs("div",{className:`
        relative z-[10000] w-full ${E[p]}
        bg-white rounded-lg shadow-xl
        transform transition-all
        max-h-[90vh] flex flex-col
      `,children:[(s||!y)&&i.jsxs("div",{className:`
            flex items-center justify-between
            px-6 py-4 border-b
            ${C}
          `,children:[s&&i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:s}),!y&&i.jsxs("button",{onClick:l,className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:[i.jsx("span",{className:"sr-only",children:"Close"}),i.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),i.jsx("div",{className:`
          flex-1 overflow-y-auto px-6 py-4
          ${A}
        `,children:f}),_&&i.jsx("div",{className:`
            flex justify-end gap-2 px-6 py-4 border-t
            ${P}
          `,children:_})]})]});return vy.createPortal(b,document.body)};var ft,be,Rr,st,Nn,Xn,pn,qt,Pr,Jn,er,Tn,Rn,gn,tr,Ie,jr,la,ua,ca,fa,ha,da,pa,ju,vu,Ry=(vu=class extends by{constructor(l,s){super();Ge(this,Ie);Ge(this,ft);Ge(this,be);Ge(this,Rr);Ge(this,st);Ge(this,Nn);Ge(this,Xn);Ge(this,pn);Ge(this,qt);Ge(this,Pr);Ge(this,Jn);Ge(this,er);Ge(this,Tn);Ge(this,Rn);Ge(this,gn);Ge(this,tr,new Set);this.options=s,Re(this,ft,l),Re(this,qt,null),Re(this,pn,eu()),this.options.experimental_prefetchInRender||q(this,pn).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(q(this,be).addObserver(this),iu(q(this,be),this.options)?$e(this,Ie,jr).call(this):this.updateResult(),$e(this,Ie,fa).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ga(q(this,be),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ga(q(this,be),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,$e(this,Ie,ha).call(this),$e(this,Ie,da).call(this),q(this,be).removeObserver(this)}setOptions(l,s){const f=this.options,p=q(this,be);if(this.options=q(this,ft).defaultQueryOptions(l),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof zt(this.options.enabled,q(this,be))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");$e(this,Ie,pa).call(this),q(this,be).setOptions(this.options),f._defaulted&&!ia(this.options,f)&&q(this,ft).getQueryCache().notify({type:"observerOptionsUpdated",query:q(this,be),observer:this});const y=this.hasListeners();y&&au(q(this,be),p,this.options,f)&&$e(this,Ie,jr).call(this),this.updateResult(s),y&&(q(this,be)!==p||zt(this.options.enabled,q(this,be))!==zt(f.enabled,q(this,be))||Is(this.options.staleTime,q(this,be))!==Is(f.staleTime,q(this,be)))&&$e(this,Ie,la).call(this);const _=$e(this,Ie,ua).call(this);y&&(q(this,be)!==p||zt(this.options.enabled,q(this,be))!==zt(f.enabled,q(this,be))||_!==q(this,gn))&&$e(this,Ie,ca).call(this,_)}getOptimisticResult(l){const s=q(this,ft).getQueryCache().build(q(this,ft),l),f=this.createResult(s,l);return Dy(this,f)&&(Re(this,st,f),Re(this,Xn,this.options),Re(this,Nn,q(this,be).state)),f}getCurrentResult(){return q(this,st)}trackResult(l,s){const f={};return Object.keys(l).forEach(p=>{Object.defineProperty(f,p,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(p),s==null||s(p),l[p])})}),f}trackProp(l){q(this,tr).add(l)}getCurrentQuery(){return q(this,be)}refetch({...l}={}){return this.fetch({...l})}fetchOptimistic(l){const s=q(this,ft).defaultQueryOptions(l),f=q(this,ft).getQueryCache().build(q(this,ft),s);return f.fetch().then(()=>this.createResult(f,s))}fetch(l){return $e(this,Ie,jr).call(this,{...l,cancelRefetch:l.cancelRefetch??!0}).then(()=>(this.updateResult(),q(this,st)))}createResult(l,s){var V;const f=q(this,be),p=this.options,y=q(this,st),_=q(this,Nn),C=q(this,Xn),P=l!==f?l.state:q(this,Rr),{state:E}=l;let b={...E},R=!1,x;if(s._optimisticResults){const k=this.hasListeners(),X=!k&&iu(l,s),ee=k&&au(l,f,s,p);(X||ee)&&(b={...b,...Iy(E.data,l.options)}),s._optimisticResults==="isRestoring"&&(b.fetchStatus="idle")}let{error:S,errorUpdatedAt:F,status:w}=b;if(s.select&&b.data!==void 0)if(y&&b.data===(_==null?void 0:_.data)&&s.select===q(this,Pr))x=q(this,Jn);else try{Re(this,Pr,s.select),x=s.select(b.data),x=nu(y==null?void 0:y.data,x,s),Re(this,Jn,x),Re(this,qt,null)}catch(k){Re(this,qt,k)}else x=b.data;if(s.placeholderData!==void 0&&x===void 0&&w==="pending"){let k;if(y!=null&&y.isPlaceholderData&&s.placeholderData===(C==null?void 0:C.placeholderData))k=y.data;else if(k=typeof s.placeholderData=="function"?s.placeholderData((V=q(this,er))==null?void 0:V.state.data,q(this,er)):s.placeholderData,s.select&&k!==void 0)try{k=s.select(k),Re(this,qt,null)}catch(X){Re(this,qt,X)}k!==void 0&&(w="success",x=nu(y==null?void 0:y.data,k,s),R=!0)}q(this,qt)&&(S=q(this,qt),x=q(this,Jn),F=Date.now(),w="error");const j=b.fetchStatus==="fetching",K=w==="pending",$=w==="error",le=K&&j,fe=x!==void 0,M={status:w,fetchStatus:b.fetchStatus,isPending:K,isSuccess:w==="success",isError:$,isInitialLoading:le,isLoading:le,data:x,dataUpdatedAt:b.dataUpdatedAt,error:S,errorUpdatedAt:F,failureCount:b.fetchFailureCount,failureReason:b.fetchFailureReason,errorUpdateCount:b.errorUpdateCount,isFetched:b.dataUpdateCount>0||b.errorUpdateCount>0,isFetchedAfterMount:b.dataUpdateCount>P.dataUpdateCount||b.errorUpdateCount>P.errorUpdateCount,isFetching:j,isRefetching:j&&!K,isLoadingError:$&&!fe,isPaused:b.fetchStatus==="paused",isPlaceholderData:R,isRefetchError:$&&fe,isStale:xa(l,s),refetch:this.refetch,promise:q(this,pn)};if(this.options.experimental_prefetchInRender){const k=Ae=>{M.status==="error"?Ae.reject(M.error):M.data!==void 0&&Ae.resolve(M.data)},X=()=>{const Ae=Re(this,pn,M.promise=eu());k(Ae)},ee=q(this,pn);switch(ee.status){case"pending":l.queryHash===f.queryHash&&k(ee);break;case"fulfilled":(M.status==="error"||M.data!==ee.value)&&X();break;case"rejected":(M.status!=="error"||M.error!==ee.reason)&&X();break}}return M}updateResult(l){const s=q(this,st),f=this.createResult(q(this,be),this.options);if(Re(this,Nn,q(this,be).state),Re(this,Xn,this.options),q(this,Nn).data!==void 0&&Re(this,er,q(this,be)),ia(f,s))return;Re(this,st,f);const p={},y=()=>{if(!s)return!0;const{notifyOnChangeProps:_}=this.options,C=typeof _=="function"?_():_;if(C==="all"||!C&&!q(this,tr).size)return!0;const A=new Set(C??q(this,tr));return this.options.throwOnError&&A.add("error"),Object.keys(q(this,st)).some(P=>{const E=P;return q(this,st)[E]!==s[E]&&A.has(E)})};(l==null?void 0:l.listeners)!==!1&&y()&&(p.listeners=!0),$e(this,Ie,ju).call(this,{...p,...l})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&$e(this,Ie,fa).call(this)}},ft=new WeakMap,be=new WeakMap,Rr=new WeakMap,st=new WeakMap,Nn=new WeakMap,Xn=new WeakMap,pn=new WeakMap,qt=new WeakMap,Pr=new WeakMap,Jn=new WeakMap,er=new WeakMap,Tn=new WeakMap,Rn=new WeakMap,gn=new WeakMap,tr=new WeakMap,Ie=new WeakSet,jr=function(l){$e(this,Ie,pa).call(this);let s=q(this,be).fetch(this.options,l);return l!=null&&l.throwOnError||(s=s.catch(wy)),s},la=function(){$e(this,Ie,ha).call(this);const l=Is(this.options.staleTime,q(this,be));if(aa||q(this,st).isStale||!tu(l))return;const f=Sy(q(this,st).dataUpdatedAt,l)+1;Re(this,Tn,setTimeout(()=>{q(this,st).isStale||this.updateResult()},f))},ua=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(q(this,be)):this.options.refetchInterval)??!1},ca=function(l){$e(this,Ie,da).call(this),Re(this,gn,l),!(aa||zt(this.options.enabled,q(this,be))===!1||!tu(q(this,gn))||q(this,gn)===0)&&Re(this,Rn,setInterval(()=>{(this.options.refetchIntervalInBackground||jy.isFocused())&&$e(this,Ie,jr).call(this)},q(this,gn)))},fa=function(){$e(this,Ie,la).call(this),$e(this,Ie,ca).call(this,$e(this,Ie,ua).call(this))},ha=function(){q(this,Tn)&&(clearTimeout(q(this,Tn)),Re(this,Tn,void 0))},da=function(){q(this,Rn)&&(clearInterval(q(this,Rn)),Re(this,Rn,void 0))},pa=function(){const l=q(this,ft).getQueryCache().build(q(this,ft),this.options);if(l===q(this,be))return;const s=q(this,be);Re(this,be,l),Re(this,Rr,l.state),this.hasListeners()&&(s==null||s.removeObserver(this),l.addObserver(this))},ju=function(l){bu.batch(()=>{l.listeners&&this.listeners.forEach(s=>{s(q(this,st))}),q(this,ft).getQueryCache().notify({query:q(this,be),type:"observerResultsUpdated"})})},vu);function Py(a,l){return zt(l.enabled,a)!==!1&&a.state.data===void 0&&!(a.state.status==="error"&&l.retryOnMount===!1)}function iu(a,l){return Py(a,l)||a.state.data!==void 0&&ga(a,l,l.refetchOnMount)}function ga(a,l,s){if(zt(l.enabled,a)!==!1){const f=typeof s=="function"?s(a):s;return f==="always"||f!==!1&&xa(a,l)}return!1}function au(a,l,s,f){return(a!==l||zt(f.enabled,a)===!1)&&(!s.suspense||a.state.status!=="error")&&xa(a,s)}function xa(a,l){return zt(l.enabled,a)!==!1&&a.isStaleByTime(Is(l.staleTime,a))}function Dy(a,l){return!ia(a.getCurrentResult(),l)}var Iu=L.createContext(!1),My=()=>L.useContext(Iu);Iu.Provider;function Fy(){let a=!1;return{clearReset:()=>{a=!1},reset:()=>{a=!0},isReset:()=>a}}var Oy=L.createContext(Fy()),Ly=()=>L.useContext(Oy);function $y(a,l){return typeof a=="function"?a(...l):!!a}function ou(){}var By=(a,l)=>{(a.suspense||a.throwOnError||a.experimental_prefetchInRender)&&(l.isReset()||(a.retryOnMount=!1))},Yy=a=>{L.useEffect(()=>{a.clearReset()},[a])},ky=({result:a,errorResetBoundary:l,throwOnError:s,query:f})=>a.isError&&!l.isReset()&&!a.isFetching&&f&&$y(s,[a.error,f]),Wy=a=>{const l=a.staleTime;a.suspense&&(a.staleTime=typeof l=="function"?(...s)=>Math.max(l(...s),1e3):Math.max(l??1e3,1e3),typeof a.gcTime=="number"&&(a.gcTime=Math.max(a.gcTime,1e3)))},Uy=(a,l)=>a.isLoading&&a.isFetching&&!l,qy=(a,l)=>(a==null?void 0:a.suspense)&&l.isPending,lu=(a,l,s)=>l.fetchOptimistic(a).catch(()=>{s.clearReset()});function zy(a,l,s){var b,R,x,S,F;const f=Cy(),p=My(),y=Ly(),_=f.defaultQueryOptions(a);(R=(b=f.getDefaultOptions().queries)==null?void 0:b._experimental_beforeQuery)==null||R.call(b,_),_._optimisticResults=p?"isRestoring":"optimistic",Wy(_),By(_,y),Yy(y);const C=!f.getQueryCache().get(_.queryHash),[A]=L.useState(()=>new l(f,_)),P=A.getOptimisticResult(_),E=!p&&a.subscribed!==!1;if(L.useSyncExternalStore(L.useCallback(w=>{const j=E?A.subscribe(bu.batchCalls(w)):ou;return A.updateResult(),j},[A,E]),()=>A.getCurrentResult(),()=>A.getCurrentResult()),L.useEffect(()=>{A.setOptions(_,{listeners:!1})},[_,A]),qy(_,P))throw lu(_,A,y);if(ky({result:P,errorResetBoundary:y,throwOnError:_.throwOnError,query:f.getQueryCache().get(_.queryHash)}))throw P.error;if((S=(x=f.getDefaultOptions().queries)==null?void 0:x._experimental_afterQuery)==null||S.call(x,_,P),_.experimental_prefetchInRender&&!aa&&Uy(P,p)){const w=C?lu(_,A,y):(F=f.getQueryCache().get(_.queryHash))==null?void 0:F.promise;w==null||w.catch(ou).finally(()=>{A.updateResult()})}return _.notifyOnChangeProps?P:A.trackResult(P)}function Hy(a,l){return zy(a,Ry)}var Cs={exports:{}},Vy=Cs.exports,uu;function Gy(){return uu||(uu=1,function(a,l){(function(s,f){a.exports=f()})(Vy,function(){var s=1e3,f=6e4,p=36e5,y="millisecond",_="second",C="minute",A="hour",P="day",E="week",b="month",R="quarter",x="year",S="date",F="Invalid Date",w=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,j=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,K={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(H){var O=["th","st","nd","rd"],U=H%100;return"["+H+(O[(U-20)%10]||O[U]||O[0])+"]"}},$=function(H,O,U){var Q=String(H);return!Q||Q.length>=O?H:""+Array(O+1-Q.length).join(U)+H},le={s:$,z:function(H){var O=-H.utcOffset(),U=Math.abs(O),Q=Math.floor(U/60),W=U%60;return(O<=0?"+":"-")+$(Q,2,"0")+":"+$(W,2,"0")},m:function H(O,U){if(O.date()<U.date())return-H(U,O);var Q=12*(U.year()-O.year())+(U.month()-O.month()),W=O.clone().add(Q,b),ae=U-W<0,se=O.clone().add(Q+(ae?-1:1),b);return+(-(Q+(U-W)/(ae?W-se:se-W))||0)},a:function(H){return H<0?Math.ceil(H)||0:Math.floor(H)},p:function(H){return{M:b,y:x,w:E,d:P,D:S,h:A,m:C,s:_,ms:y,Q:R}[H]||String(H||"").toLowerCase().replace(/s$/,"")},u:function(H){return H===void 0}},fe="en",Se={};Se[fe]=K;var M="$isDayjsObject",V=function(H){return H instanceof Ae||!(!H||!H[M])},k=function H(O,U,Q){var W;if(!O)return fe;if(typeof O=="string"){var ae=O.toLowerCase();Se[ae]&&(W=ae),U&&(Se[ae]=U,W=ae);var se=O.split("-");if(!W&&se.length>1)return H(se[0])}else{var ge=O.name;Se[ge]=O,W=ge}return!Q&&W&&(fe=W),W||!Q&&fe},X=function(H,O){if(V(H))return H.clone();var U=typeof O=="object"?O:{};return U.date=H,U.args=arguments,new Ae(U)},ee=le;ee.l=k,ee.i=V,ee.w=function(H,O){return X(H,{locale:O.$L,utc:O.$u,x:O.$x,$offset:O.$offset})};var Ae=function(){function H(U){this.$L=k(U.locale,null,!0),this.parse(U),this.$x=this.$x||U.x||{},this[M]=!0}var O=H.prototype;return O.parse=function(U){this.$d=function(Q){var W=Q.date,ae=Q.utc;if(W===null)return new Date(NaN);if(ee.u(W))return new Date;if(W instanceof Date)return new Date(W);if(typeof W=="string"&&!/Z$/i.test(W)){var se=W.match(w);if(se){var ge=se[2]-1||0,B=(se[7]||"0").substring(0,3);return ae?new Date(Date.UTC(se[1],ge,se[3]||1,se[4]||0,se[5]||0,se[6]||0,B)):new Date(se[1],ge,se[3]||1,se[4]||0,se[5]||0,se[6]||0,B)}}return new Date(W)}(U),this.init()},O.init=function(){var U=this.$d;this.$y=U.getFullYear(),this.$M=U.getMonth(),this.$D=U.getDate(),this.$W=U.getDay(),this.$H=U.getHours(),this.$m=U.getMinutes(),this.$s=U.getSeconds(),this.$ms=U.getMilliseconds()},O.$utils=function(){return ee},O.isValid=function(){return this.$d.toString()!==F},O.isSame=function(U,Q){var W=X(U);return this.startOf(Q)<=W&&W<=this.endOf(Q)},O.isAfter=function(U,Q){return X(U)<this.startOf(Q)},O.isBefore=function(U,Q){return this.endOf(Q)<X(U)},O.$g=function(U,Q,W){return ee.u(U)?this[Q]:this.set(W,U)},O.unix=function(){return Math.floor(this.valueOf()/1e3)},O.valueOf=function(){return this.$d.getTime()},O.startOf=function(U,Q){var W=this,ae=!!ee.u(Q)||Q,se=ee.p(U),ge=function(Ke,Be){var pt=ee.w(W.$u?Date.UTC(W.$y,Be,Ke):new Date(W.$y,Be,Ke),W);return ae?pt:pt.endOf(P)},B=function(Ke,Be){return ee.w(W.toDate()[Ke].apply(W.toDate("s"),(ae?[0,0,0,0]:[23,59,59,999]).slice(Be)),W)},Y=this.$W,ie=this.$M,J=this.$D,ye="set"+(this.$u?"UTC":"");switch(se){case x:return ae?ge(1,0):ge(31,11);case b:return ae?ge(1,ie):ge(0,ie+1);case E:var St=this.$locale().weekStart||0,at=(Y<St?Y+7:Y)-St;return ge(ae?J-at:J+(6-at),ie);case P:case S:return B(ye+"Hours",0);case A:return B(ye+"Minutes",1);case C:return B(ye+"Seconds",2);case _:return B(ye+"Milliseconds",3);default:return this.clone()}},O.endOf=function(U){return this.startOf(U,!1)},O.$set=function(U,Q){var W,ae=ee.p(U),se="set"+(this.$u?"UTC":""),ge=(W={},W[P]=se+"Date",W[S]=se+"Date",W[b]=se+"Month",W[x]=se+"FullYear",W[A]=se+"Hours",W[C]=se+"Minutes",W[_]=se+"Seconds",W[y]=se+"Milliseconds",W)[ae],B=ae===P?this.$D+(Q-this.$W):Q;if(ae===b||ae===x){var Y=this.clone().set(S,1);Y.$d[ge](B),Y.init(),this.$d=Y.set(S,Math.min(this.$D,Y.daysInMonth())).$d}else ge&&this.$d[ge](B);return this.init(),this},O.set=function(U,Q){return this.clone().$set(U,Q)},O.get=function(U){return this[ee.p(U)]()},O.add=function(U,Q){var W,ae=this;U=Number(U);var se=ee.p(Q),ge=function(ie){var J=X(ae);return ee.w(J.date(J.date()+Math.round(ie*U)),ae)};if(se===b)return this.set(b,this.$M+U);if(se===x)return this.set(x,this.$y+U);if(se===P)return ge(1);if(se===E)return ge(7);var B=(W={},W[C]=f,W[A]=p,W[_]=s,W)[se]||1,Y=this.$d.getTime()+U*B;return ee.w(Y,this)},O.subtract=function(U,Q){return this.add(-1*U,Q)},O.format=function(U){var Q=this,W=this.$locale();if(!this.isValid())return W.invalidDate||F;var ae=U||"YYYY-MM-DDTHH:mm:ssZ",se=ee.z(this),ge=this.$H,B=this.$m,Y=this.$M,ie=W.weekdays,J=W.months,ye=W.meridiem,St=function(Be,pt,Bt,_n){return Be&&(Be[pt]||Be(Q,ae))||Bt[pt].slice(0,_n)},at=function(Be){return ee.s(ge%12||12,Be,"0")},Ke=ye||function(Be,pt,Bt){var _n=Be<12?"AM":"PM";return Bt?_n.toLowerCase():_n};return ae.replace(j,function(Be,pt){return pt||function(Bt){switch(Bt){case"YY":return String(Q.$y).slice(-2);case"YYYY":return ee.s(Q.$y,4,"0");case"M":return Y+1;case"MM":return ee.s(Y+1,2,"0");case"MMM":return St(W.monthsShort,Y,J,3);case"MMMM":return St(J,Y);case"D":return Q.$D;case"DD":return ee.s(Q.$D,2,"0");case"d":return String(Q.$W);case"dd":return St(W.weekdaysMin,Q.$W,ie,2);case"ddd":return St(W.weekdaysShort,Q.$W,ie,3);case"dddd":return ie[Q.$W];case"H":return String(ge);case"HH":return ee.s(ge,2,"0");case"h":return at(1);case"hh":return at(2);case"a":return Ke(ge,B,!0);case"A":return Ke(ge,B,!1);case"m":return String(B);case"mm":return ee.s(B,2,"0");case"s":return String(Q.$s);case"ss":return ee.s(Q.$s,2,"0");case"SSS":return ee.s(Q.$ms,3,"0");case"Z":return se}return null}(Be)||se.replace(":","")})},O.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},O.diff=function(U,Q,W){var ae,se=this,ge=ee.p(Q),B=X(U),Y=(B.utcOffset()-this.utcOffset())*f,ie=this-B,J=function(){return ee.m(se,B)};switch(ge){case x:ae=J()/12;break;case b:ae=J();break;case R:ae=J()/3;break;case E:ae=(ie-Y)/6048e5;break;case P:ae=(ie-Y)/864e5;break;case A:ae=ie/p;break;case C:ae=ie/f;break;case _:ae=ie/s;break;default:ae=ie}return W?ae:ee.a(ae)},O.daysInMonth=function(){return this.endOf(b).$D},O.$locale=function(){return Se[this.$L]},O.locale=function(U,Q){if(!U)return this.$L;var W=this.clone(),ae=k(U,Q,!0);return ae&&(W.$L=ae),W},O.clone=function(){return ee.w(this.$d,this)},O.toDate=function(){return new Date(this.valueOf())},O.toJSON=function(){return this.isValid()?this.toISOString():null},O.toISOString=function(){return this.$d.toISOString()},O.toString=function(){return this.$d.toUTCString()},H}(),Xe=Ae.prototype;return X.prototype=Xe,[["$ms",y],["$s",_],["$m",C],["$H",A],["$W",P],["$M",b],["$y",x],["$D",S]].forEach(function(H){Xe[H[1]]=function(O){return this.$g(O,H[0],H[1])}}),X.extend=function(H,O){return H.$i||(H(O,Ae,X),H.$i=!0),X},X.locale=k,X.isDayjs=V,X.unix=function(H){return X(1e3*H)},X.en=Se[fe],X.Ls=Se,X.p={},X})}(Cs)),Cs.exports}var Ky=Gy();const ze=wu(Ky),Cu=a=>{const{pagination:l={start:0,limit:25},filters:s={},dateRange:f,probability:p=null}=a,y=[{is_deleted:{$eq:!1}},{recognition_date:{$gte:f.startDate,$lte:f.endDate}}];p&&(p==="confirmed"?y.push({is_confirmed:{$eq:!0}}):y.push({is_confirmed:{$eq:!1},probability:{$eq:p}})),console.log(">> basefilter : ",y);const _={};s.customer&&(_.customer={id:{$eq:s.customer}}),s.name&&(_.name={$contains:s.name}),s.billingType&&y.push({billing_type:{$eq:s.billingType}}),s.sfaClassification&&(_.sfa_classification={id:{$eq:s.sfaClassification}}),s.sfaSalesType&&(_.sfa_sales_type={id:{$eq:s.sfaSalesType}}),(s.salesItem||s.team)&&(!s.salesItem||!s.team?_.sfa_by_items={$contains:s.salesItem?s.salesItem:s.team}:_.sfa_by_items={$and:[{$contains:s.salesItem},{$contains:s.team}]}),Object.keys(_).length>0&&y.push({sfa:_});const C={filters:{$and:y},fields:["billing_type","is_confirmed","probability","amount","profit_amount","profit_config","recognition_date","scheduled_date"],populate:{sfa:{fields:["name","sfa_by_items","has_partner","is_project"],populate:{customer:{fields:["name"]},selling_partner:{fields:["name"]},sfa_classification:{fields:["name"]}}}},pagination:{start:l.current?(l.current-1)*l.pageSize:l.start,limit:l.pageSize||l.limit},sort:["recognition_date:asc"]};return yn.stringify(C,{encodeValuesOnly:!0})},Au=a=>yn.stringify({filters:{id:{$eq:a}},fields:["name","is_project","total_price","sfa_by_items","has_partner","description"],populate:{customer:{fields:["name"]},selling_partner:{fields:["name"]},sfa_classification:{fields:["name"]},sfa_sales_type:{fields:["name"]},sfa_by_payments:{filters:{is_deleted:{$eq:!1}},sort:["id:asc"],fields:["billing_type","is_confirmed","probability","amount","profit_amount","recognition_date","scheduled_date","profit_config","memo"],populate:{sfa_by_payment_histories:{fields:["is_confirmed","probability","amount","profit_amount","recognition_date","scheduled_date","profit_config","memo"],sort:["id:desc"]}}}}},{encodeValuesOnly:!0}),nn=a=>{const l=Number(a);return isNaN(l)?0:l},Er={FILTER_FIELD_MAP:{name:"name",customer:"customer",hasPartner:"has_partner",sellingPartner:"selling_partner",sfaSalesType:"sfa_sales_type",sfaClassification:"sfa_classification",itemAmount:"total_price",isProject:"is_project",description:"description",probability:"probability",billingType:"billing_type"},transformSalesByItems:a=>{console.group("Sales Items Transform"),console.log("Input:",{type:typeof a,value:a});const l=a.map(f=>({item_id:f.itemId||null,item_name:f.itemName||"",team_id:f.teamId||null,team_name:f.teamName||"",item_price:nn(f.amount)})),s=JSON.stringify(l);return console.log("Output:",{type:typeof l,value:l,isArray:Array.isArray(l)}),console.groupEnd(),s},transformSalesByPayments:a=>{console.group("Sales Payments Transform"),console.log("Input:",{type:typeof a,value:a});const l={billing_type:a.billingType,is_confirmed:a.isConfirmed,probability:nn(a.probability),amount:nn(a.amount),profit_config:(()=>{const s={is_profit:a.isProfit,margin_profit_value:nn(a.marginProfitValue)};return JSON.stringify(s)})(),profit_amount:Math.floor(nn(a.profitAmount)),scheduled_date:a.scheduledDate||null,recognition_date:a.recognitionDate,memo:a.memo};return console.log("Output:",{type:typeof l,value:l,isArray:Array.isArray(l)}),console.groupEnd(),l},transformSfaFields:a=>{console.log("Transform SFA fields input:",a);const l={name:a.name,customer:a.customer,has_partner:a.hasPartner,selling_partner:a.hasPartner?a.sellingPartner:null,sfa_sales_type:nn(a.sfaSalesType),sfa_classification:nn(a.sfaClassification),total_price:nn(a.itemAmount),sfa_by_items:Er.transformSalesByItems(a.salesByItems),is_project:a.isProject,description:a.description||""};return console.log("Transform base fields output:",l),l},transformToStrapiFilter:a=>{if(console.group("Strapi Filter Transform"),console.log("Input filters:",a),!a||typeof a!="object")return console.log("No filters to transform"),console.groupEnd(),{};const l={};a.customer&&a.customer!==""&&(l.customer={id:{$eq:a.customer}}),a.name&&a.name!==""&&(l.name={$contains:a.name}),a.sfa_item&&a.sfa_item!==""?l.sfa_item_price={$contains:`"sfa_item_name":"${a.sfa_item}"`}:a.sfa_classification&&a.sfa_classification!==""&&(l.sfa_classification={id:{$eq:a.sfa_classification}});const s=Object.keys(l).length>0?{sfa:l}:{};return console.log("Output Strapi filters:",s),console.groupEnd(),s},transformFilters:a=>{if(console.group("Filters Transform"),console.log("Input filters:",a),!a||typeof a!="object")return console.log("No filters to transform"),console.groupEnd(),{};const l=Object.entries(a).reduce((s,[f,p])=>{if(p==null||p==="")return s;const y=Er.FILTER_FIELD_MAP[f];return y?["sfa_sales_type","sfa_classification","total_price"].includes(y)?s[y]=nn(p):s[y]=p:s[f]=p,s},{});return console.log("Output transformed filters:",l),console.groupEnd(),l}},Xi=a=>{var l;return(l=a==null?void 0:a.data)!=null&&l.data?{data:a.data.data,meta:a.data.meta}:{data:[],meta:{pagination:{total:0}}}},wr=(a,l)=>{var s,f,p;throw console.error(l||"API Error:",a),new Error(((p=(f=(s=a.response)==null?void 0:s.data)==null?void 0:f.error)==null?void 0:p.message)||a.message||l||"An error occurred")},cu={getSfaList:async a=>{try{const l={startDate:ze().startOf("month").format("YYYY-MM-DD"),endDate:ze().endOf("month").format("YYYY-MM-DD")},s={pagination:a.pagination,filters:a.filters,dateRange:a.dateRange||l,probability:a.probability},f=Cu(s),p=await wt.get(`/sfa-by-payments?${f}`);return Xi(p)}catch(l){wr(l,"Failed to fetch SFA list")}},getSfaDetail:async a=>{var l,s;try{const f=Au(a),p=await wt.get(`/sfas?${f}`);if(!((s=(l=p.data)==null?void 0:l.data)!=null&&s[0]))throw new Error("SFA data not found");return p.data.data[0]}catch(f){wr(f,"Failed to fetch SFA detail")}},getMonthlyStats:async(a,l)=>{var s;try{const f=await wt.get("/sfa-monthly-sales-stats/forecast",{params:{startDate:a,endDate:l}});if(!((s=f.data)!=null&&s.data)||!Array.isArray(f.data.data))return{};const p=f.data.data.reduce((y,_)=>(y[_.group_name]={revenue:Number(_.total_amount)||0,profit:Number(_.total_profit_amount)||0},y),{});return p.confirmed||(p.confirmed={revenue:0,profit:0}),p}catch(f){wr(f,"Failed to fetch monthly stats")}},getItems:async a=>{try{const l=yn.stringify({filters:{sfa_classification:{id:{$eq:a}}},sort:["sort:asc"]},{encodeValuesOnly:!0}),s=await wt.get(`/sfa-items?${l}`);return Xi(s)}catch(l){wr(l,"Failed to fetch items")}},getCodebook:async a=>{try{const l=yn.stringify({fields:["code","name","sort"],populate:{codetype:{fields:["type","name"]}},filters:{$and:[{used:{$eq:!0}},{codetype:{type:{$eq:a}}}]},sort:["sort:asc"],pagination:{start:0,limit:50}},{encodeValuesOnly:!0}),s=await wt.get(`/codebooks?${l}`);return Xi(s)}catch(l){wr(l,"Failed to fetch codebook")}}},Eu=L.createContext(null),xn=()=>{const a=L.useContext(Eu);if(!a)throw new Error("useSfa must be used within SfaProvider");return a},Qy=({children:a})=>{const[l,s]=L.useState([]),[f,p]=L.useState(!1),[y,_]=L.useState(null),C={dateRange:{startDate:ze().startOf("month").format("YYYY-MM-DD"),endDate:ze().endOf("month").format("YYYY-MM-DD")}},[A,P]=L.useState({current:1,pageSize:20,total:0}),[E,b]=L.useState({mode:"default",components:{monthlyStatus:!0,sfaTable:!0,searchForm:!1,forecastTable:!1}}),[R,x]=L.useState({visible:!1,controlMode:null,featureMode:null,data:null}),S=()=>{fe({...C,pagination:{current:1,pageSize:A.pageSize}})},F=V=>{console.group("SfaProvider - setPage"),console.log("Current:",A.current,"New:",V),P(k=>({...k,current:Number(V)})),console.groupEnd()},w=V=>{console.group("SfaProvider - setPageSize"),console.log("Current:",A.pageSize,"New:",V),P(k=>({...k,current:1,pageSize:Number(V)})),console.groupEnd()},j=V=>{console.group("SfaProvider - setPageTotalSize"),console.log("Totalsize:",A.total,"New:",V),P(k=>({...k,total:Number(V)})),console.groupEnd()},K=V=>{const k={default:{mode:"default",components:{monthlyStatus:!0,sfaTable:!0,searchForm:!1,forecastTable:!1}},search:{mode:"search",components:{monthlyStatus:!1,sfaTable:!0,searchForm:!0,forecastTable:!1}},forecast:{mode:"forecast",components:{monthlyStatus:!1,sfaTable:!0,searchForm:!1,forecastTable:!0}}};b(k[V]||k.default)},$=V=>{x(k=>({...k,...V}))},le=()=>{x({visible:!1,controlMode:null,featureMode:null,data:null})},fe=L.useCallback(async(V={})=>{var k,X,ee,Ae,Xe;p(!0);try{const{dateRange:H,probability:O,...U}=(V==null?void 0:V.filters)||{},Q={dateRange:H||C.dateRange,probability:O||null,filters:{...U},pagination:{current:((k=V.pagination)==null?void 0:k.current)||A.current,pageSize:((X=V.pagination)==null?void 0:X.pageSize)||A.pageSize}},W=await cu.getSfaList(Q);return s(W.data),A.total!==W.meta.pagination.total&&P(ae=>({...ae,total:W.meta.pagination.total})),_(null),W.data}catch(H){const O=((Xe=(Ae=(ee=H.response)==null?void 0:ee.data)==null?void 0:Ae.error)==null?void 0:Xe.message)||H.message;_(O),s([])}finally{p(!1)}},[A.current,A.pageSize]);Gn.useEffect(()=>{console.log("Initial data loading"),fe()},[fe]);const M={sfaData:l,loading:f,error:y,pagination:A,fetchSfaList:fe,fetchSfaDetail:async V=>{try{const k=await cu.getSfaDetail(V);x({visible:!0,controlMode:"view",featureMode:null,data:k})}catch(k){return _(k.message),null}finally{}},setPage:F,setPageSize:w,setPageTotalSize:j,setError:_,pageLayout:E,setLayout:K,resetFilters:S,drawerState:R,setDrawer:$,setDrawerClose:le,setLoading:p,setSfaData:s};return i.jsx(Eu.Provider,{value:M,children:a})},Nu=()=>{const{setSfaData:a,setLoading:l,setError:s,pagination:f,setPage:p,setPageSize:y,setPageTotalSize:_,setLayout:C,fetchSfaList:A}=xn(),[P,E]=L.useState({dateRange:{startDate:ze().startOf("month").format("YYYY-MM-DD"),endDate:ze().endOf("month").format("YYYY-MM-DD")},name:"",customer:"",sfaSalesType:"",sfaClassification:"",salesItem:"",team:"",billingType:"",isConfirmed:"",probability:""}),b=async(S,F=null)=>{console.group("updateMonthlyFilter"),console.log("YearMonth:",S,"Probability:",F),console.groupEnd();const w=ze(S),K={dateRange:{startDate:w.startOf("month").format("YYYY-MM-DD"),endDate:w.endOf("month").format("YYYY-MM-DD")},probability:F};return A({filters:K,pagination:{current:1,pageSize:f.pageSize}})},R=async S=>(console.group("updateDetailFilter"),console.log("Search Form Data:",S),console.groupEnd(),A({filters:S,pagination:{current:1,pageSize:f.pageSize}})),x=L.useCallback(async()=>{console.group("resetFilters");const S={dateRange:{startDate:ze().startOf("month").format("YYYY-MM-DD"),endDate:ze().endOf("month").format("YYYY-MM-DD")},name:"",customer:"",sfaSalesType:"",sfaClassification:"",salesItem:"",team:"",billingType:"",isConfirmed:"",probability:""};return console.log("Initial Filters:",S),E(S),console.groupEnd(),A({...S,pagination:{current:1,pageSize:f.pageSize}})},[f.pageSize,A]);return{filters:P,updateMonthlyFilter:b,updateDetailFilter:R,resetFilters:x}};var Ji={exports:{}},ea,fu;function Zy(){if(fu)return ea;fu=1;var a="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ea=a,ea}var ta,hu;function Xy(){if(hu)return ta;hu=1;var a=Zy();function l(){}function s(){}return s.resetWarningCache=l,ta=function(){function f(_,C,A,P,E,b){if(b!==a){var R=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw R.name="Invariant Violation",R}}f.isRequired=f;function p(){return f}var y={array:f,bigint:f,bool:f,func:f,number:f,object:f,string:f,symbol:f,any:f,arrayOf:p,element:f,elementType:f,instanceOf:p,node:f,objectOf:p,oneOf:p,oneOfType:p,shape:p,exact:p,checkPropTypes:s,resetWarningCache:l};return y.PropTypes=y,y},ta}var du;function Jy(){return du||(du=1,Ji.exports=Xy()()),Ji.exports}var ex=Jy();const Ut=wu(ex),Zn={getCodebook:async a=>{const l={fields:["code","name","sort"],populate:{codetype:{fields:["type","name"]}},filters:{$and:[{used:{$eq:!0}},{codetype:{type:{$eq:a}}}]},sort:["sort:asc"],pagination:{start:0,limit:50}},s=yn.stringify(l,{encodeValuesOnly:!0});return wt.get(`/codebooks?${s}`)},getSfaItems:async a=>{const l=yn.stringify({filters:{sfa_classification:{id:{$eq:a}}},sort:["sort:asc"]},{encodeValuesOnly:!0});return(await wt.get(`/sfa-items?${l}`)).data},getTeams:async()=>{const a=yn.stringify({filters:{used:{$eq:!0}},sort:["sort:asc"]},{encodeValuesOnly:!0});return(await wt.get(`/teams?${a}`)).data}},tx={MAX_SALES_ITEMS:3,MAX_SALES_PAYMENTS:3},pu={itemId:"",itemName:"",teamId:"",teamName:"",amount:""},nx={billingType:"",isConfirmed:!1,probability:"",amount:"",profitAmount:"",isProfit:!1,marginProfitValue:"",recognitionDate:"",scheduledDate:"",memo:""},Sr={name:"",sfaSalesType:"",sfaClassification:"",customer:"",sellingPartner:"",itemAmount:"",paymentAmount:"",description:"",salesByItems:[],salesByPayments:[]},rx={id:null,documentId:null},sx=a=>{const[l,s]=L.useState(Sr),[f,p]=L.useState({}),[y,_]=L.useState(!1),[C,A]=L.useState({data:[]}),[P,E]=L.useState({data:[]}),[b,R]=L.useState({data:[]}),[x,S]=L.useState(!1),[F,w]=L.useState(!1),[j,K]=L.useState(rx);L.useState([]),L.useEffect(()=>{console.log("Form Data Changed:",{previous:Sr,current:l,changes:Object.keys(l).reduce((B,Y)=>(l[Y]!==Sr[Y]&&(B[Y]={from:Sr[Y],to:l[Y]}),B),{})})},[l]),L.useEffect(()=>{const B=l.salesByItems.reduce((ie,J)=>ie+(parseInt(J.amount)||0),0),Y=l.salesByPayments.reduce((ie,J)=>ie+(parseInt(J.amount)||0),0);s(ie=>({...ie,itemAmount:B.toString(),paymentAmount:Y.toString()}))},[l.salesByItems,l.salesByPayments]);const $=L.useCallback(async B=>{if(!B){A({data:[]});return}S(!0);try{const Y=await Zn.getSfaItems(B);A(Y)}catch(Y){console.error("Failed to fetch items:",Y),A({data:[]})}finally{S(!1)}},[]),le=async()=>{w(!0);try{const[B,Y]=await Promise.all([Zn.getCodebook("re_payment_method"),Zn.getCodebook("sfa_percentage")]);E(B.data),R(Y.data)}catch(B){console.error("Failed to fetch payment data:",B),E({data:[]}),R({data:[]})}finally{w(!1)}},fe=B=>{const{name:Y,value:ie}=B.target;s(J=>({...J,[Y]:ie})),Y==="sfaClassification"&&ie&&($(ie),s(J=>({...J,salesByItems:J.salesByItems.map(ye=>({...ye,itemName:""}))}))),f[Y]&&p(J=>({...J,[Y]:void 0}))},Se=B=>{s(Y=>({...Y,customer:B.id})),f.customer&&p(Y=>({...Y,customer:void 0}))},M=()=>{s(Sr),p({})},V=(B,Y)=>{s(ie=>({...ie,[B]:Y}))},k=B=>{s(Y=>({...Y,...B}))},X=()=>{l.salesByItems.length<3&&s(B=>({...B,salesByItems:[...B.salesByItems,{...pu}]}))},ee=B=>{s(Y=>{const ie=[...Y.salesByItems];return ie.splice(B,1),p(J=>{const ye={...J};return delete ye[`salesItems.${B}.productType`],delete ye[`salesItems.${B}.teamName`],delete ye[`salesItems.${B}.amount`],ye}),{...Y,salesByItems:ie.map(J=>({itemId:J.itemId||"",itemName:J.itemName||"",teamId:J.teamId||"",teamName:J.teamName||"",amount:J.amount||""}))}})},Ae=async()=>{if(!(l.salesByPayments.length>=3))try{!F&&!P.data.length&&await le(),s(B=>({...B,salesByPayments:[...B.salesByPayments,{...nx}]}))}catch(B){console.error("Failed to add sales payment:",B)}},Xe=B=>{s(Y=>({...Y,salesByPayments:Y.salesByPayments.filter((ie,J)=>J!==B)}))},H=(B,Y,ie)=>{s(J=>{const ye=[...J.salesByItems];return typeof Y=="string"?ye[B]={...ye[B],[Y]:ie}:typeof Y=="object"&&(ye[B]={...ye[B],...Y}),{...J,salesByItems:ye}})},O=(B,Y,ie)=>{s(J=>{const ye=[...J.salesByPayments];return ye[B]={...ye[B],[Y]:ie},{...J,salesByPayments:ye}})},U=L.useCallback((B,Y,ie)=>{s(J=>{const ye=[...J.salesByItems];return typeof Y=="string"?ye[B]={...ye[B],[Y]:ie}:ye[B]={...ye[B],...Y},{...J,salesByItems:ye}})},[s]),Q=L.useCallback(()=>{l.salesByItems.length<tx.MAX_SALES_ITEMS&&s(B=>({...B,salesByItems:[...B.salesByItems,{...pu}]}))},[l.salesByItems.length,s]),W=L.useCallback(B=>{s(Y=>({...Y,salesByItems:Y.salesByItems.filter((ie,J)=>J!==B)}))},[s]);return{formData:l,errors:f,updateFormField:fe,setFormData:s,setErrors:p,isSubmitting:y,setIsSubmitting:_,updateItem:U,addItem:Q,removeItem:W,itemsData:C,isItemsLoading:x,paymentData:P,percentageData:b,isPaymentDataLoading:F,handleCustomerSelect:Se,resetForm:M,setFieldValue:V,setFieldValues:k,handleAddSalesItem:X,handleRemoveSalesItem:ee,handleAddPayment:Ae,handleRemovePayment:Xe,handleSalesItemChange:H,handlePaymentChange:O,selectedPaymentIds:j,togglePaymentSelection:async B=>{console.log(">>togglePaymentSelection>> [paymentId] : ",B);const Y=a.data.sfa_by_payments.find(ie=>ie.documentId===B.documentId);console.log(">>togglePaymentSelection>> [payment] : ",Y);try{s(ie=>{var J,ye,St,at,Ke,Be;return{...ie,salesByPayments:[{id:Y.id,documentId:Y.documentId,billingType:Y.billing_type||"",isConfirmed:Y.is_confirmed||!1,probability:((J=Y.probability)==null?void 0:J.toString())||"",amount:((ye=Y.amount)==null?void 0:ye.toString())||"",profitAmount:((St=Y.profit_amount)==null?void 0:St.toString())||"",isProfit:((at=Y.profit_config)==null?void 0:at.is_profit)||!1,marginProfitValue:((Be=(Ke=Y.profit_config)==null?void 0:Ke.margin_profit_value)==null?void 0:Be.toString())||"",recognitionDate:Y.recognition_date||"",scheduledDate:Y.scheduled_date||"",memo:Y.memo||"",sfa:Y.sfa||null}]}})}catch(ie){console.error("Failed to edit sales payment:",ie)}},resetPaymentForm:()=>{try{s(B=>({...B,salesByPayments:[]}))}catch(B){console.error("Reset 중 오류 발생:",B)}},handleEditPayment:async()=>{if(!(l.salesByPayments.length>=3))try{!F&&!P.data.length&&await le()}catch(B){console.error("Failed to load payment:",B)}}}},Pt={BASIC_INFO:"basicInfo",SALES_ITEMS:"salesItems",PAYMENTS:"payments"},ix={[Pt.BASIC_INFO]:"기본 정보",[Pt.SALES_ITEMS]:"사업부 매출",[Pt.PAYMENTS]:"결제 매출"},ax={sfaSalesType:"매출유형",sfaClassification:"매출구분",customer:"고객사",name:"건명"},ox={billingType:"결제구분",probability:"매출확률",amount:"매출액",marginProfitValue:"이익률/이익금",recognitionDate:"매출인식일자"},gu={MAX_SALES_ITEMS:3,MAX_PAYMENTS:3,MIN_MARGIN:0,MAX_MARGIN:100},dn={REQUIRED_FIELD:a=>`${a}을(를) 입력해주세요`,INTEGER_ONLY:"정수만 입력 가능합니다",MARGIN_RANGE:"이익률은 0-100 사이의 값을 입력해주세요",MARGIN_LESS_THAN_AMOUNT:"이익금은 매출액보다 작아야 합니다",MIN_SALES_ITEMS:"최소 하나의 사업부 매출을 등록해주세요",MIN_PAYMENTS:"최소 하나의 결제 매출을 등록해주세요",ITEM_FIELDS:(a,l)=>`${a}번 항목: ${l.join(", ")}을(를) 입력해주세요`},na=a=>{if(!a)return"";if(typeof a=="string")return a;if(typeof a=="object"){if(a.description)return a.description;if(a.message)return a.message;try{return JSON.stringify(a)}catch{return"오류가 발생했습니다."}}return String(a)},Ss=a=>typeof a=="string"?{message:"알림",description:a}:typeof a=="object"?{message:na(a.message)||"알림",description:na(a.description)||""}:{message:"알림",description:na(a)},Ir={success:a=>{const l=Ss(a);alert(`✅ ${l.message}
${l.description}`)},error:a=>{const l=Ss(a);alert(`❌ ${l.message}
${l.description}`)},warning:a=>{const l=Ss(a);alert(`⚠️ ${l.message}
${l.description}`)},info:a=>{const l=Ss(a);alert(`ℹ️ ${l.message}
${l.description}`)}},lx=a=>Object.entries(a).filter(([s,f])=>f.length>0).map(([s,f])=>{const p=ix[s],y=f.map(_=>`• ${_}`).join(`
`);return`[${p}]
${y}`}).join(`

`),_a=a=>{const[l,s]=L.useState({[Pt.BASIC_INFO]:[],[Pt.SALES_ITEMS]:[],[Pt.PAYMENTS]:[]}),f=E=>{const b=[];return Object.entries(ax).forEach(([R,x])=>{a[R]||b.push(dn.REQUIRED_FIELD(x))}),E&&!a.sellingPartner&&b.push(PARTNER_ERROR_MESSAGE),b},p=()=>{const E=[];return a.salesByItems.length===0?(E.push(dn.MIN_SALES_ITEMS),E):(a.salesByItems.forEach((b,R)=>{const x=[];b.itemName||x.push("매출품목"),b.teamName||x.push("사업부"),b.amount||x.push("매출금액"),x.length>0&&E.push(dn.ITEM_FIELDS(R+1,x))}),E)},y=(E,b,R)=>{if(!E.margin)return;const x=Number(E.margin),S=Number(E.amount);E.isProfit&&x>=S?R.push(`${b+1}번 항목: ${dn.MARGIN_LESS_THAN_AMOUNT}`):!E.isProfit&&(x<gu.MIN_MARGIN||x>gu.MAX_MARGIN)&&R.push(`${b+1}번 항목: ${dn.MARGIN_RANGE}`)},_=E=>{Ir.error({message:"매출등록오류",description:lx(E),duration:0,style:{width:500}})},C=(E=!1)=>{const b={[Pt.BASIC_INFO]:f(E),[Pt.SALES_ITEMS]:p(),[Pt.PAYMENTS]:A(a.salesByPayments)};return Object.values(b).some(x=>x.length>0)?(s(b),_(b),!1):(s({[Pt.BASIC_INFO]:[],[Pt.SALES_ITEMS]:[],[Pt.PAYMENTS]:[]}),!0)},A=E=>{const b=[];return E.length===0?(b.push(dn.MIN_PAYMENTS),b):(E.forEach((R,x)=>{const S=[];Object.entries(ox).forEach(([F,w])=>{R[F]||S.push(w)}),S.length>0&&b.push(dn.ITEM_FIELDS(x+1,S)),R.amount&&!Number.isInteger(Number(R.amount))&&b.push(`${x+1}번 항목: ${dn.INTEGER_ONLY}`),y(R,x,b)}),b)};return{validationErrors:l,validateForm:C,validatePayments:A,checkAmounts:()=>{const E=parseInt(a.itemAmount)||0,b=parseInt(a.paymentAmount)||0;return E===b}}},va=()=>{try{const a=sessionStorage==null?void 0:sessionStorage.getItem("user");if(!a)throw new Error("사용자 정보가 없습니다.");const l=JSON.parse(a);if(!(l!=null&&l.jwt))throw new Error("토큰 정보가 없습니다.");return l.jwt}catch(a){throw console.error("토큰 가져오기 실패:",a),a}},ra=(a=null,l={})=>{const f={baseURL:"/api",headers:{Authorization:`Bearer ${va()}`,"Content-Type":"application/json",...l.headers},...l};return a&&(f.data={data:a}),f},Kn=Ay.create({baseURL:"/api"});Kn.interceptors.request.use(a=>{const l=va();return l&&(a.headers.Authorization=`Bearer ${l}`),console.log("API Request:",{url:a==null?void 0:a.url,method:a==null?void 0:a.method,data:a==null?void 0:a.data}),a},a=>(console.error("Request Error:",a),Promise.reject(a)));Kn.interceptors.response.use(a=>(console.log("API Response:",{url:a.config.url,status:a.status,data:a.data}),a),a=>{var l,s,f;return console.error("Response Error:",{url:(l=a.config)==null?void 0:l.url,status:(s=a.response)==null?void 0:s.status,data:(f=a.response)==null?void 0:f.data}),Promise.reject(a)});const js={get:async(a,l={})=>{const s=ra(null,l);return Kn.get(a,s)},post:async(a,l,s={})=>{const f=ra(l,s);return Kn.post(a,f.data,f)},put:async(a,l,s={})=>Kn.put(a,{data:l},{baseURL:"/api",headers:{Authorization:`Bearer ${va()}`,"Content-Type":"application/json",...s.headers},...s}),delete:async(a,l={})=>{const s=ra(null,l);return Kn.delete(a,s)}},mn={async createSfaBase(a){var l,s,f;console.log("[SFA] Creating base with formData:",a);try{const p=Er.transformSfaFields(a);return(await js.post("/sfas",p)).data}catch(p){throw console.error("[SFA] Creation error:",p),new Error(((f=(s=(l=p.response)==null?void 0:l.data)==null?void 0:s.error)==null?void 0:f.message)||"데이터 저장 중 오류가 발생했습니다.")}},async addSfaPayment(a,l){var s,f,p;console.log("[SFA] Creating payments with history:",{sfaId:a,salesPayments:l});try{const y=l.map(async C=>{const P={...Er.transformSalesByPayments(C),sfa:a};return console.log("[SFA] Sending payment data with history:",P),(await js.post("/sfa-by-payment-withhistory",P)).data}),_=await Promise.all(y);return console.log("[SFA] All payments created with history:",_),_}catch(y){throw console.error("[SFA] Payment creation error:",y),new Error(((p=(f=(s=y.response)==null?void 0:s.data)==null?void 0:f.error)==null?void 0:p.message)||"결제 매출 데이터 저장 중 오류가 발생했습니다.")}},async updateSfaPayment(a,l){var s,f,p;console.log("[SFA] Updating payment with history:",{paymentId:a,paymentData:l});try{const y=Er.transformSalesByPayments(l),_=await js.put(`/sfa-by-payment-withhistory/${a}`,y);return console.log("[SFA] Payment updated with history:",_.data),_.data}catch(y){throw console.error("[SFA] Payment update error:",y),new Error(((p=(f=(s=y.response)==null?void 0:s.data)==null?void 0:f.error)==null?void 0:p.message)||"결제 매출 데이터 수정 중 오류가 발생했습니다.")}},async updateSfaBase(a,l){var s,f,p;console.log("[SFA] Updating field with formData:",l);try{return(await js.put(`/sfas/${a}`,l)).data}catch(y){throw console.error("[SFA] Update error:",y),new Error(((p=(f=(s=y.response)==null?void 0:s.data)==null?void 0:f.error)==null?void 0:p.message)||"데이터 저장 중 오류가 발생했습니다.")}}},ux=async a=>{try{console.log("===== Starting SFA Form Submission =====");const l=await mn.createSfaBase(a);if(!l||!l.data)throw new Error("SFA 기본 정보 생성 실패");const s=l.data.id,f=await mn.addSfaPayment(s,a.salesByPayments);return console.log("===== SFA Form Submission Completed ====="),{success:!0,data:{...l.data,payments:f}}}catch(l){throw console.error("SFA Form Submission Error:",l),l}},Nr={getSfaList:async a=>{try{const l={startDate:ze().startOf("month").format("YYYY-MM-DD"),endDate:ze().endOf("month").format("YYYY-MM-DD")},s={pagination:a.pagination,filters:a.filters,dateRange:a.dateRange||l,probability:a.probability},f=Cu(s),p=await wt.get(`/sfa-by-payments?${f}`);return{data:p.data.data,meta:p.data.meta}}catch(l){throw console.error("Failed to fetch SFA list:",l),new Error("Failed to fetch SFA list")}},getSfaDetail:async a=>{try{const l=Au(a);return console.log(`getSfaDetail query : ${l}`),(await wt.get(`/sfas?${l}`)).data}catch(l){throw console.error("Failed to fetch SFA detail:",l),new Error("Failed to fetch SFA detail")}},getSfaMonthStats:async(a,l)=>{try{console.log(">>>Fetching data for:",{startDate:a,endDate:l});const s=await wt.get("/sfa-monthly-sales-stats/forecast",{params:{startDate:a,endDate:l}});if(console.log("API Response:",s.data),!s.data||!s.data.data||!Array.isArray(s.data.data))return console.log("No data returned from API"),{};const f=s.data.data.reduce((p,y)=>(p[y.group_name]={revenue:Number(y.total_amount)||0,profit:Number(y.total_profit_amount)||0},p),{});return f.confirmed||(f.confirmed={revenue:0,profit:0}),console.log(`>> ${a}/${l} >>Processed data:`,f),f}catch(s){throw console.error(`Failed to fetch SFA stats for ${year}-${month}:`,s),new Error(`Failed to fetch monthly sales stats: ${s.message}`)}},fetchItems:async a=>{const l=yn.stringify({filters:{sfa_classification:{id:{$eq:a}}},sort:["sort:asc"]},{encodeValuesOnly:!0});return wt.get(`/sfa-items?${l}`)}},Es=()=>{const{setDrawerClose:a,setDrawer:l,drawerState:s}=xn(),f=sx(s),{formData:p,setIsSubmitting:y,setErrors:_}=f,{validateForm:C,validatePayments:A,checkAmounts:P}=_a(p);return{...f,validateForm:C,checkAmounts:P,processSubmit:async(R,x)=>{const S={...p,hasPartner:R,isProject:x};try{y(!0);const F=await ux(S);if(!F||!F.success)throw new Error((F==null?void 0:F.message)||"저장에 실패했습니다.");Ir.success({message:"저장 성공",description:"성공적으로 저장되었습니다."}),a()}catch(F){console.error("Form submission error:",F);const w=(F==null?void 0:F.message)||"저장 중 오류가 발생했습니다.";_(j=>({...j,submit:w})),Ir.error({message:"저장 실패",description:w})}finally{y(!1)}},processPaymentSubmit:async(R,x,S)=>{try{y(!0);const F=R==="create"?await mn.addSfaPayment(x,p.salesByPayments):await mn.updateSfaPayment(x,p.salesByPayments[0]);Ir.success({message:"저장 성공",description:`성공적으로 ${R==="create"?"등록":"수정"}되었습니다.`});const w=await Nr.getSfaDetail(S);l({controlMode:"view",data:w.data[0]})}catch(F){console.error("Payment submission error:",F);const w=(F==null?void 0:F.message)||"저장 중 오류가 발생했습니다.";_(j=>({...j,submit:w})),Ir.error({message:"저장 실패",description:w})}finally{y(!1)}}}};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Tu=(...a)=>a.filter((l,s,f)=>!!l&&l.trim()!==""&&f.indexOf(l)===s).join(" ").trim();/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var fx={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hx=L.forwardRef(({color:a="currentColor",size:l=24,strokeWidth:s=2,absoluteStrokeWidth:f,className:p="",children:y,iconNode:_,...C},A)=>L.createElement("svg",{ref:A,...fx,width:l,height:l,stroke:a,strokeWidth:f?Number(s)*24/Number(l):s,className:Tu("lucide",p),...C},[..._.map(([P,E])=>L.createElement(P,E)),...Array.isArray(y)?y:[y]]));/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=(a,l)=>{const s=L.forwardRef(({className:f,...p},y)=>L.createElement(hx,{ref:y,iconNode:l,className:Tu(`lucide-${cx(a)}`,f),...p}));return s.displayName=`${a}`,s};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=Ns("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=Ns("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ru=Ns("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=Ns("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Du=({visible:a=!1,title:l="",width:s="900px",onClose:f,menu:p,children:y,enableOverlayClick:_=!1,controlMode:C="view"})=>{if(L.useEffect(()=>{if(a){const P=window.scrollY;document.body.style.position="fixed",document.body.style.top=`-${P}px`,document.body.style.width="100%"}else{const P=document.body.style.top;document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,parseInt(P||"0",10)*-1)}return()=>{document.body.style.position="",document.body.style.top="",document.body.style.width=""}},[a]),!a)return null;const A=P=>({"600px":"w-[600px]","800px":"w-[800px]","400px":"w-[400px]"})[P]||`w-[${P}]`;return i.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:_?f:void 0}),i.jsx("div",{className:"absolute inset-y-0 right-0 flex max-w-full",children:i.jsx("div",{className:`relative ${A(s)} h-full`,children:i.jsxs("div",{className:"flex h-full flex-col overflow-hidden bg-white shadow-xl",children:[i.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 px-4 py-3",children:[i.jsx("h2",{className:"text-lg font-medium text-gray-900",children:l}),i.jsx(De,{variant:"outline",size:"sm",className:"h-12 w-12 p-1 hover:bg-gray-100 hover:text-gray-900 border-gray-200",onClick:f,children:i.jsx(Pu,{className:"h-8 w-8"})})]}),p&&C!=="add"&&i.jsx("div",{className:"border-b border-gray-200 px-4 py-2",children:p}),i.jsx("div",{className:"relative flex-1 overflow-y-auto",children:i.jsx("div",{className:"p-4",children:y})})]})})})]})};Du.propTypes={visible:Ut.bool.isRequired,title:Ut.string.isRequired,width:Ut.oneOfType([Ut.string,Ut.number]),onClose:Ut.func.isRequired,menu:Ut.node,children:Ut.node,enableOverlayClick:Ut.bool,controlMode:Ut.oneOf(["view","edit","add"])};const px=({controlMenus:a,functionMenus:l,className:s=""})=>i.jsxs("div",{className:`inline-flex items-center gap-2 ${s}`,children:[i.jsx("div",{className:"inline-flex rounded-md shadow-sm",children:a.map((f,p)=>i.jsx(De,{variant:f.active?"primary":"outline",size:"sm",className:`
              ${p===0?"rounded-l-md rounded-r-none":""}
              ${p===a.length-1?"rounded-r-md rounded-l-none":""}
              ${p!==0&&p!==a.length-1?"rounded-none":""}
              ${f.active?"z-10":""}
              -ml-px first:ml-0
              min-w-[80px]
              font-medium
            `,onClick:f.onClick,children:f.label},f.key))}),l.length>0&&i.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),i.jsx("div",{className:"inline-flex gap-2",children:l.map(f=>i.jsx(De,{variant:"outline",size:"sm",className:`
              min-w-[120px]
              font-medium
              ${f.active?"bg-blue-100 text-gray-900 border-gray-400":"bg-gray-50 text-gray-600 border-gray-300 hover:bg-gray-100 hover:text-gray-900"}
            `,onClick:f.onClick,children:f.label},f.key))})]});var Cr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var gx=Cr.exports,mu;function mx(){return mu||(mu=1,function(a,l){(function(){var s,f="4.17.21",p=200,y="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",_="Expected a function",C="Invalid `variable` option passed into `_.template`",A="__lodash_hash_undefined__",P=500,E="__lodash_placeholder__",b=1,R=2,x=4,S=1,F=2,w=1,j=2,K=4,$=8,le=16,fe=32,Se=64,M=128,V=256,k=512,X=30,ee="...",Ae=800,Xe=16,H=1,O=2,U=3,Q=1/0,W=9007199254740991,ae=17976931348623157e292,se=NaN,ge=4294967295,B=ge-1,Y=ge>>>1,ie=[["ary",M],["bind",w],["bindKey",j],["curry",$],["curryRight",le],["flip",k],["partial",fe],["partialRight",Se],["rearg",V]],J="[object Arguments]",ye="[object Array]",St="[object AsyncFunction]",at="[object Boolean]",Ke="[object Date]",Be="[object DOMException]",pt="[object Error]",Bt="[object Function]",_n="[object GeneratorFunction]",Dt="[object Map]",nr="[object Number]",Ou="[object Null]",Ht="[object Object]",wa="[object Promise]",Lu="[object Proxy]",rr="[object RegExp]",Mt="[object Set]",sr="[object String]",Dr="[object Symbol]",$u="[object Undefined]",ir="[object WeakMap]",Bu="[object WeakSet]",ar="[object ArrayBuffer]",Dn="[object DataView]",Ts="[object Float32Array]",Rs="[object Float64Array]",Ps="[object Int8Array]",Ds="[object Int16Array]",Ms="[object Int32Array]",Fs="[object Uint8Array]",Os="[object Uint8ClampedArray]",Ls="[object Uint16Array]",$s="[object Uint32Array]",Yu=/\b__p \+= '';/g,ku=/\b(__p \+=) '' \+/g,Wu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Sa=/&(?:amp|lt|gt|quot|#39);/g,ja=/[&<>"']/g,Uu=RegExp(Sa.source),qu=RegExp(ja.source),zu=/<%-([\s\S]+?)%>/g,Hu=/<%([\s\S]+?)%>/g,Ia=/<%=([\s\S]+?)%>/g,Vu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Gu=/^\w*$/,Ku=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Bs=/[\\^$.*+?()[\]{}|]/g,Qu=RegExp(Bs.source),Ys=/^\s+/,Zu=/\s/,Xu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ju=/\{\n\/\* \[wrapped with (.+)\] \*/,ec=/,? & /,tc=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,nc=/[()=,{}\[\]\/\s]/,rc=/\\(\\)?/g,sc=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ca=/\w*$/,ic=/^[-+]0x[0-9a-f]+$/i,ac=/^0b[01]+$/i,oc=/^\[object .+?Constructor\]$/,lc=/^0o[0-7]+$/i,uc=/^(?:0|[1-9]\d*)$/,cc=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mr=/($^)/,fc=/['\n\r\u2028\u2029\\]/g,Fr="\\ud800-\\udfff",hc="\\u0300-\\u036f",dc="\\ufe20-\\ufe2f",pc="\\u20d0-\\u20ff",Aa=hc+dc+pc,Ea="\\u2700-\\u27bf",Na="a-z\\xdf-\\xf6\\xf8-\\xff",gc="\\xac\\xb1\\xd7\\xf7",mc="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",yc="\\u2000-\\u206f",xc=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ta="A-Z\\xc0-\\xd6\\xd8-\\xde",Ra="\\ufe0e\\ufe0f",Pa=gc+mc+yc+xc,ks="['’]",_c="["+Fr+"]",Da="["+Pa+"]",Or="["+Aa+"]",Ma="\\d+",vc="["+Ea+"]",Fa="["+Na+"]",Oa="[^"+Fr+Pa+Ma+Ea+Na+Ta+"]",Ws="\\ud83c[\\udffb-\\udfff]",bc="(?:"+Or+"|"+Ws+")",La="[^"+Fr+"]",Us="(?:\\ud83c[\\udde6-\\uddff]){2}",qs="[\\ud800-\\udbff][\\udc00-\\udfff]",Mn="["+Ta+"]",$a="\\u200d",Ba="(?:"+Fa+"|"+Oa+")",wc="(?:"+Mn+"|"+Oa+")",Ya="(?:"+ks+"(?:d|ll|m|re|s|t|ve))?",ka="(?:"+ks+"(?:D|LL|M|RE|S|T|VE))?",Wa=bc+"?",Ua="["+Ra+"]?",Sc="(?:"+$a+"(?:"+[La,Us,qs].join("|")+")"+Ua+Wa+")*",jc="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ic="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",qa=Ua+Wa+Sc,Cc="(?:"+[vc,Us,qs].join("|")+")"+qa,Ac="(?:"+[La+Or+"?",Or,Us,qs,_c].join("|")+")",Ec=RegExp(ks,"g"),Nc=RegExp(Or,"g"),zs=RegExp(Ws+"(?="+Ws+")|"+Ac+qa,"g"),Tc=RegExp([Mn+"?"+Fa+"+"+Ya+"(?="+[Da,Mn,"$"].join("|")+")",wc+"+"+ka+"(?="+[Da,Mn+Ba,"$"].join("|")+")",Mn+"?"+Ba+"+"+Ya,Mn+"+"+ka,Ic,jc,Ma,Cc].join("|"),"g"),Rc=RegExp("["+$a+Fr+Aa+Ra+"]"),Pc=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Dc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Mc=-1,Te={};Te[Ts]=Te[Rs]=Te[Ps]=Te[Ds]=Te[Ms]=Te[Fs]=Te[Os]=Te[Ls]=Te[$s]=!0,Te[J]=Te[ye]=Te[ar]=Te[at]=Te[Dn]=Te[Ke]=Te[pt]=Te[Bt]=Te[Dt]=Te[nr]=Te[Ht]=Te[rr]=Te[Mt]=Te[sr]=Te[ir]=!1;var Ne={};Ne[J]=Ne[ye]=Ne[ar]=Ne[Dn]=Ne[at]=Ne[Ke]=Ne[Ts]=Ne[Rs]=Ne[Ps]=Ne[Ds]=Ne[Ms]=Ne[Dt]=Ne[nr]=Ne[Ht]=Ne[rr]=Ne[Mt]=Ne[sr]=Ne[Dr]=Ne[Fs]=Ne[Os]=Ne[Ls]=Ne[$s]=!0,Ne[pt]=Ne[Bt]=Ne[ir]=!1;var Fc={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Oc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Lc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},$c={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Bc=parseFloat,Yc=parseInt,za=typeof ws=="object"&&ws&&ws.Object===Object&&ws,kc=typeof self=="object"&&self&&self.Object===Object&&self,He=za||kc||Function("return this")(),Hs=l&&!l.nodeType&&l,vn=Hs&&!0&&a&&!a.nodeType&&a,Ha=vn&&vn.exports===Hs,Vs=Ha&&za.process,jt=function(){try{var g=vn&&vn.require&&vn.require("util").types;return g||Vs&&Vs.binding&&Vs.binding("util")}catch{}}(),Va=jt&&jt.isArrayBuffer,Ga=jt&&jt.isDate,Ka=jt&&jt.isMap,Qa=jt&&jt.isRegExp,Za=jt&&jt.isSet,Xa=jt&&jt.isTypedArray;function gt(g,I,v){switch(v.length){case 0:return g.call(I);case 1:return g.call(I,v[0]);case 2:return g.call(I,v[0],v[1]);case 3:return g.call(I,v[0],v[1],v[2])}return g.apply(I,v)}function Wc(g,I,v,G){for(var ue=-1,we=g==null?0:g.length;++ue<we;){var Ye=g[ue];I(G,Ye,v(Ye),g)}return G}function It(g,I){for(var v=-1,G=g==null?0:g.length;++v<G&&I(g[v],v,g)!==!1;);return g}function Uc(g,I){for(var v=g==null?0:g.length;v--&&I(g[v],v,g)!==!1;);return g}function Ja(g,I){for(var v=-1,G=g==null?0:g.length;++v<G;)if(!I(g[v],v,g))return!1;return!0}function rn(g,I){for(var v=-1,G=g==null?0:g.length,ue=0,we=[];++v<G;){var Ye=g[v];I(Ye,v,g)&&(we[ue++]=Ye)}return we}function Lr(g,I){var v=g==null?0:g.length;return!!v&&Fn(g,I,0)>-1}function Gs(g,I,v){for(var G=-1,ue=g==null?0:g.length;++G<ue;)if(v(I,g[G]))return!0;return!1}function Pe(g,I){for(var v=-1,G=g==null?0:g.length,ue=Array(G);++v<G;)ue[v]=I(g[v],v,g);return ue}function sn(g,I){for(var v=-1,G=I.length,ue=g.length;++v<G;)g[ue+v]=I[v];return g}function Ks(g,I,v,G){var ue=-1,we=g==null?0:g.length;for(G&&we&&(v=g[++ue]);++ue<we;)v=I(v,g[ue],ue,g);return v}function qc(g,I,v,G){var ue=g==null?0:g.length;for(G&&ue&&(v=g[--ue]);ue--;)v=I(v,g[ue],ue,g);return v}function Qs(g,I){for(var v=-1,G=g==null?0:g.length;++v<G;)if(I(g[v],v,g))return!0;return!1}var zc=Zs("length");function Hc(g){return g.split("")}function Vc(g){return g.match(tc)||[]}function eo(g,I,v){var G;return v(g,function(ue,we,Ye){if(I(ue,we,Ye))return G=we,!1}),G}function $r(g,I,v,G){for(var ue=g.length,we=v+(G?1:-1);G?we--:++we<ue;)if(I(g[we],we,g))return we;return-1}function Fn(g,I,v){return I===I?af(g,I,v):$r(g,to,v)}function Gc(g,I,v,G){for(var ue=v-1,we=g.length;++ue<we;)if(G(g[ue],I))return ue;return-1}function to(g){return g!==g}function no(g,I){var v=g==null?0:g.length;return v?Js(g,I)/v:se}function Zs(g){return function(I){return I==null?s:I[g]}}function Xs(g){return function(I){return g==null?s:g[I]}}function ro(g,I,v,G,ue){return ue(g,function(we,Ye,Ee){v=G?(G=!1,we):I(v,we,Ye,Ee)}),v}function Kc(g,I){var v=g.length;for(g.sort(I);v--;)g[v]=g[v].value;return g}function Js(g,I){for(var v,G=-1,ue=g.length;++G<ue;){var we=I(g[G]);we!==s&&(v=v===s?we:v+we)}return v}function ei(g,I){for(var v=-1,G=Array(g);++v<g;)G[v]=I(v);return G}function Qc(g,I){return Pe(I,function(v){return[v,g[v]]})}function so(g){return g&&g.slice(0,lo(g)+1).replace(Ys,"")}function mt(g){return function(I){return g(I)}}function ti(g,I){return Pe(I,function(v){return g[v]})}function or(g,I){return g.has(I)}function io(g,I){for(var v=-1,G=g.length;++v<G&&Fn(I,g[v],0)>-1;);return v}function ao(g,I){for(var v=g.length;v--&&Fn(I,g[v],0)>-1;);return v}function Zc(g,I){for(var v=g.length,G=0;v--;)g[v]===I&&++G;return G}var Xc=Xs(Fc),Jc=Xs(Oc);function ef(g){return"\\"+$c[g]}function tf(g,I){return g==null?s:g[I]}function On(g){return Rc.test(g)}function nf(g){return Pc.test(g)}function rf(g){for(var I,v=[];!(I=g.next()).done;)v.push(I.value);return v}function ni(g){var I=-1,v=Array(g.size);return g.forEach(function(G,ue){v[++I]=[ue,G]}),v}function oo(g,I){return function(v){return g(I(v))}}function an(g,I){for(var v=-1,G=g.length,ue=0,we=[];++v<G;){var Ye=g[v];(Ye===I||Ye===E)&&(g[v]=E,we[ue++]=v)}return we}function Br(g){var I=-1,v=Array(g.size);return g.forEach(function(G){v[++I]=G}),v}function sf(g){var I=-1,v=Array(g.size);return g.forEach(function(G){v[++I]=[G,G]}),v}function af(g,I,v){for(var G=v-1,ue=g.length;++G<ue;)if(g[G]===I)return G;return-1}function of(g,I,v){for(var G=v+1;G--;)if(g[G]===I)return G;return G}function Ln(g){return On(g)?uf(g):zc(g)}function Ft(g){return On(g)?cf(g):Hc(g)}function lo(g){for(var I=g.length;I--&&Zu.test(g.charAt(I)););return I}var lf=Xs(Lc);function uf(g){for(var I=zs.lastIndex=0;zs.test(g);)++I;return I}function cf(g){return g.match(zs)||[]}function ff(g){return g.match(Tc)||[]}var hf=function g(I){I=I==null?He:$n.defaults(He.Object(),I,$n.pick(He,Dc));var v=I.Array,G=I.Date,ue=I.Error,we=I.Function,Ye=I.Math,Ee=I.Object,ri=I.RegExp,df=I.String,Ct=I.TypeError,Yr=v.prototype,pf=we.prototype,Bn=Ee.prototype,kr=I["__core-js_shared__"],Wr=pf.toString,Ce=Bn.hasOwnProperty,gf=0,uo=function(){var e=/[^.]+$/.exec(kr&&kr.keys&&kr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ur=Bn.toString,mf=Wr.call(Ee),yf=He._,xf=ri("^"+Wr.call(Ce).replace(Bs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qr=Ha?I.Buffer:s,on=I.Symbol,zr=I.Uint8Array,co=qr?qr.allocUnsafe:s,Hr=oo(Ee.getPrototypeOf,Ee),fo=Ee.create,ho=Bn.propertyIsEnumerable,Vr=Yr.splice,po=on?on.isConcatSpreadable:s,lr=on?on.iterator:s,bn=on?on.toStringTag:s,Gr=function(){try{var e=Cn(Ee,"defineProperty");return e({},"",{}),e}catch{}}(),_f=I.clearTimeout!==He.clearTimeout&&I.clearTimeout,vf=G&&G.now!==He.Date.now&&G.now,bf=I.setTimeout!==He.setTimeout&&I.setTimeout,Kr=Ye.ceil,Qr=Ye.floor,si=Ee.getOwnPropertySymbols,wf=qr?qr.isBuffer:s,go=I.isFinite,Sf=Yr.join,jf=oo(Ee.keys,Ee),ke=Ye.max,Qe=Ye.min,If=G.now,Cf=I.parseInt,mo=Ye.random,Af=Yr.reverse,ii=Cn(I,"DataView"),ur=Cn(I,"Map"),ai=Cn(I,"Promise"),Yn=Cn(I,"Set"),cr=Cn(I,"WeakMap"),fr=Cn(Ee,"create"),Zr=cr&&new cr,kn={},Ef=An(ii),Nf=An(ur),Tf=An(ai),Rf=An(Yn),Pf=An(cr),Xr=on?on.prototype:s,hr=Xr?Xr.valueOf:s,yo=Xr?Xr.toString:s;function u(e){if(Fe(e)&&!ce(e)&&!(e instanceof _e)){if(e instanceof At)return e;if(Ce.call(e,"__wrapped__"))return xl(e)}return new At(e)}var Wn=function(){function e(){}return function(t){if(!Me(t))return{};if(fo)return fo(t);e.prototype=t;var n=new e;return e.prototype=s,n}}();function Jr(){}function At(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=s}u.templateSettings={escape:zu,evaluate:Hu,interpolate:Ia,variable:"",imports:{_:u}},u.prototype=Jr.prototype,u.prototype.constructor=u,At.prototype=Wn(Jr.prototype),At.prototype.constructor=At;function _e(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ge,this.__views__=[]}function Df(){var e=new _e(this.__wrapped__);return e.__actions__=ot(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ot(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ot(this.__views__),e}function Mf(){if(this.__filtered__){var e=new _e(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Ff(){var e=this.__wrapped__.value(),t=this.__dir__,n=ce(e),r=t<0,o=n?e.length:0,c=Vh(0,o,this.__views__),h=c.start,d=c.end,m=d-h,N=r?d:h-1,T=this.__iteratees__,D=T.length,z=0,Z=Qe(m,this.__takeCount__);if(!n||!r&&o==m&&Z==m)return ko(e,this.__actions__);var ne=[];e:for(;m--&&z<Z;){N+=t;for(var de=-1,re=e[N];++de<D;){var xe=T[de],ve=xe.iteratee,_t=xe.type,tt=ve(re);if(_t==O)re=tt;else if(!tt){if(_t==H)continue e;break e}}ne[z++]=re}return ne}_e.prototype=Wn(Jr.prototype),_e.prototype.constructor=_e;function wn(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Of(){this.__data__=fr?fr(null):{},this.size=0}function Lf(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function $f(e){var t=this.__data__;if(fr){var n=t[e];return n===A?s:n}return Ce.call(t,e)?t[e]:s}function Bf(e){var t=this.__data__;return fr?t[e]!==s:Ce.call(t,e)}function Yf(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=fr&&t===s?A:t,this}wn.prototype.clear=Of,wn.prototype.delete=Lf,wn.prototype.get=$f,wn.prototype.has=Bf,wn.prototype.set=Yf;function Vt(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function kf(){this.__data__=[],this.size=0}function Wf(e){var t=this.__data__,n=es(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Vr.call(t,n,1),--this.size,!0}function Uf(e){var t=this.__data__,n=es(t,e);return n<0?s:t[n][1]}function qf(e){return es(this.__data__,e)>-1}function zf(e,t){var n=this.__data__,r=es(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}Vt.prototype.clear=kf,Vt.prototype.delete=Wf,Vt.prototype.get=Uf,Vt.prototype.has=qf,Vt.prototype.set=zf;function Gt(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Hf(){this.size=0,this.__data__={hash:new wn,map:new(ur||Vt),string:new wn}}function Vf(e){var t=hs(this,e).delete(e);return this.size-=t?1:0,t}function Gf(e){return hs(this,e).get(e)}function Kf(e){return hs(this,e).has(e)}function Qf(e,t){var n=hs(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}Gt.prototype.clear=Hf,Gt.prototype.delete=Vf,Gt.prototype.get=Gf,Gt.prototype.has=Kf,Gt.prototype.set=Qf;function Sn(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new Gt;++t<n;)this.add(e[t])}function Zf(e){return this.__data__.set(e,A),this}function Xf(e){return this.__data__.has(e)}Sn.prototype.add=Sn.prototype.push=Zf,Sn.prototype.has=Xf;function Ot(e){var t=this.__data__=new Vt(e);this.size=t.size}function Jf(){this.__data__=new Vt,this.size=0}function eh(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function th(e){return this.__data__.get(e)}function nh(e){return this.__data__.has(e)}function rh(e,t){var n=this.__data__;if(n instanceof Vt){var r=n.__data__;if(!ur||r.length<p-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Gt(r)}return n.set(e,t),this.size=n.size,this}Ot.prototype.clear=Jf,Ot.prototype.delete=eh,Ot.prototype.get=th,Ot.prototype.has=nh,Ot.prototype.set=rh;function xo(e,t){var n=ce(e),r=!n&&En(e),o=!n&&!r&&hn(e),c=!n&&!r&&!o&&Hn(e),h=n||r||o||c,d=h?ei(e.length,df):[],m=d.length;for(var N in e)(t||Ce.call(e,N))&&!(h&&(N=="length"||o&&(N=="offset"||N=="parent")||c&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||Xt(N,m)))&&d.push(N);return d}function _o(e){var t=e.length;return t?e[yi(0,t-1)]:s}function sh(e,t){return ds(ot(e),jn(t,0,e.length))}function ih(e){return ds(ot(e))}function oi(e,t,n){(n!==s&&!Lt(e[t],n)||n===s&&!(t in e))&&Kt(e,t,n)}function dr(e,t,n){var r=e[t];(!(Ce.call(e,t)&&Lt(r,n))||n===s&&!(t in e))&&Kt(e,t,n)}function es(e,t){for(var n=e.length;n--;)if(Lt(e[n][0],t))return n;return-1}function ah(e,t,n,r){return ln(e,function(o,c,h){t(r,o,n(o),h)}),r}function vo(e,t){return e&&kt(t,We(t),e)}function oh(e,t){return e&&kt(t,ut(t),e)}function Kt(e,t,n){t=="__proto__"&&Gr?Gr(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function li(e,t){for(var n=-1,r=t.length,o=v(r),c=e==null;++n<r;)o[n]=c?s:Wi(e,t[n]);return o}function jn(e,t,n){return e===e&&(n!==s&&(e=e<=n?e:n),t!==s&&(e=e>=t?e:t)),e}function Et(e,t,n,r,o,c){var h,d=t&b,m=t&R,N=t&x;if(n&&(h=o?n(e,r,o,c):n(e)),h!==s)return h;if(!Me(e))return e;var T=ce(e);if(T){if(h=Kh(e),!d)return ot(e,h)}else{var D=Ze(e),z=D==Bt||D==_n;if(hn(e))return qo(e,d);if(D==Ht||D==J||z&&!o){if(h=m||z?{}:ul(e),!d)return m?$h(e,oh(h,e)):Lh(e,vo(h,e))}else{if(!Ne[D])return o?e:{};h=Qh(e,D,d)}}c||(c=new Ot);var Z=c.get(e);if(Z)return Z;c.set(e,h),$l(e)?e.forEach(function(re){h.add(Et(re,t,n,re,e,c))}):Ol(e)&&e.forEach(function(re,xe){h.set(xe,Et(re,t,n,xe,e,c))});var ne=N?m?Ei:Ai:m?ut:We,de=T?s:ne(e);return It(de||e,function(re,xe){de&&(xe=re,re=e[xe]),dr(h,xe,Et(re,t,n,xe,e,c))}),h}function lh(e){var t=We(e);return function(n){return bo(n,e,t)}}function bo(e,t,n){var r=n.length;if(e==null)return!r;for(e=Ee(e);r--;){var o=n[r],c=t[o],h=e[o];if(h===s&&!(o in e)||!c(h))return!1}return!0}function wo(e,t,n){if(typeof e!="function")throw new Ct(_);return vr(function(){e.apply(s,n)},t)}function pr(e,t,n,r){var o=-1,c=Lr,h=!0,d=e.length,m=[],N=t.length;if(!d)return m;n&&(t=Pe(t,mt(n))),r?(c=Gs,h=!1):t.length>=p&&(c=or,h=!1,t=new Sn(t));e:for(;++o<d;){var T=e[o],D=n==null?T:n(T);if(T=r||T!==0?T:0,h&&D===D){for(var z=N;z--;)if(t[z]===D)continue e;m.push(T)}else c(t,D,r)||m.push(T)}return m}var ln=Ko(Yt),So=Ko(ci,!0);function uh(e,t){var n=!0;return ln(e,function(r,o,c){return n=!!t(r,o,c),n}),n}function ts(e,t,n){for(var r=-1,o=e.length;++r<o;){var c=e[r],h=t(c);if(h!=null&&(d===s?h===h&&!xt(h):n(h,d)))var d=h,m=c}return m}function ch(e,t,n,r){var o=e.length;for(n=he(n),n<0&&(n=-n>o?0:o+n),r=r===s||r>o?o:he(r),r<0&&(r+=o),r=n>r?0:Yl(r);n<r;)e[n++]=t;return e}function jo(e,t){var n=[];return ln(e,function(r,o,c){t(r,o,c)&&n.push(r)}),n}function Ve(e,t,n,r,o){var c=-1,h=e.length;for(n||(n=Xh),o||(o=[]);++c<h;){var d=e[c];t>0&&n(d)?t>1?Ve(d,t-1,n,r,o):sn(o,d):r||(o[o.length]=d)}return o}var ui=Qo(),Io=Qo(!0);function Yt(e,t){return e&&ui(e,t,We)}function ci(e,t){return e&&Io(e,t,We)}function ns(e,t){return rn(t,function(n){return Jt(e[n])})}function In(e,t){t=cn(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[Wt(t[n++])];return n&&n==r?e:s}function Co(e,t,n){var r=t(e);return ce(e)?r:sn(r,n(e))}function Je(e){return e==null?e===s?$u:Ou:bn&&bn in Ee(e)?Hh(e):id(e)}function fi(e,t){return e>t}function fh(e,t){return e!=null&&Ce.call(e,t)}function hh(e,t){return e!=null&&t in Ee(e)}function dh(e,t,n){return e>=Qe(t,n)&&e<ke(t,n)}function hi(e,t,n){for(var r=n?Gs:Lr,o=e[0].length,c=e.length,h=c,d=v(c),m=1/0,N=[];h--;){var T=e[h];h&&t&&(T=Pe(T,mt(t))),m=Qe(T.length,m),d[h]=!n&&(t||o>=120&&T.length>=120)?new Sn(h&&T):s}T=e[0];var D=-1,z=d[0];e:for(;++D<o&&N.length<m;){var Z=T[D],ne=t?t(Z):Z;if(Z=n||Z!==0?Z:0,!(z?or(z,ne):r(N,ne,n))){for(h=c;--h;){var de=d[h];if(!(de?or(de,ne):r(e[h],ne,n)))continue e}z&&z.push(ne),N.push(Z)}}return N}function ph(e,t,n,r){return Yt(e,function(o,c,h){t(r,n(o),c,h)}),r}function gr(e,t,n){t=cn(t,e),e=dl(e,t);var r=e==null?e:e[Wt(Tt(t))];return r==null?s:gt(r,e,n)}function Ao(e){return Fe(e)&&Je(e)==J}function gh(e){return Fe(e)&&Je(e)==ar}function mh(e){return Fe(e)&&Je(e)==Ke}function mr(e,t,n,r,o){return e===t?!0:e==null||t==null||!Fe(e)&&!Fe(t)?e!==e&&t!==t:yh(e,t,n,r,mr,o)}function yh(e,t,n,r,o,c){var h=ce(e),d=ce(t),m=h?ye:Ze(e),N=d?ye:Ze(t);m=m==J?Ht:m,N=N==J?Ht:N;var T=m==Ht,D=N==Ht,z=m==N;if(z&&hn(e)){if(!hn(t))return!1;h=!0,T=!1}if(z&&!T)return c||(c=new Ot),h||Hn(e)?al(e,t,n,r,o,c):qh(e,t,m,n,r,o,c);if(!(n&S)){var Z=T&&Ce.call(e,"__wrapped__"),ne=D&&Ce.call(t,"__wrapped__");if(Z||ne){var de=Z?e.value():e,re=ne?t.value():t;return c||(c=new Ot),o(de,re,n,r,c)}}return z?(c||(c=new Ot),zh(e,t,n,r,o,c)):!1}function xh(e){return Fe(e)&&Ze(e)==Dt}function di(e,t,n,r){var o=n.length,c=o,h=!r;if(e==null)return!c;for(e=Ee(e);o--;){var d=n[o];if(h&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++o<c;){d=n[o];var m=d[0],N=e[m],T=d[1];if(h&&d[2]){if(N===s&&!(m in e))return!1}else{var D=new Ot;if(r)var z=r(N,T,m,e,t,D);if(!(z===s?mr(T,N,S|F,r,D):z))return!1}}return!0}function Eo(e){if(!Me(e)||ed(e))return!1;var t=Jt(e)?xf:oc;return t.test(An(e))}function _h(e){return Fe(e)&&Je(e)==rr}function vh(e){return Fe(e)&&Ze(e)==Mt}function bh(e){return Fe(e)&&_s(e.length)&&!!Te[Je(e)]}function No(e){return typeof e=="function"?e:e==null?ct:typeof e=="object"?ce(e)?Po(e[0],e[1]):Ro(e):Zl(e)}function pi(e){if(!_r(e))return jf(e);var t=[];for(var n in Ee(e))Ce.call(e,n)&&n!="constructor"&&t.push(n);return t}function wh(e){if(!Me(e))return sd(e);var t=_r(e),n=[];for(var r in e)r=="constructor"&&(t||!Ce.call(e,r))||n.push(r);return n}function gi(e,t){return e<t}function To(e,t){var n=-1,r=lt(e)?v(e.length):[];return ln(e,function(o,c,h){r[++n]=t(o,c,h)}),r}function Ro(e){var t=Ti(e);return t.length==1&&t[0][2]?fl(t[0][0],t[0][1]):function(n){return n===e||di(n,e,t)}}function Po(e,t){return Pi(e)&&cl(t)?fl(Wt(e),t):function(n){var r=Wi(n,e);return r===s&&r===t?Ui(n,e):mr(t,r,S|F)}}function rs(e,t,n,r,o){e!==t&&ui(t,function(c,h){if(o||(o=new Ot),Me(c))Sh(e,t,h,n,rs,r,o);else{var d=r?r(Mi(e,h),c,h+"",e,t,o):s;d===s&&(d=c),oi(e,h,d)}},ut)}function Sh(e,t,n,r,o,c,h){var d=Mi(e,n),m=Mi(t,n),N=h.get(m);if(N){oi(e,n,N);return}var T=c?c(d,m,n+"",e,t,h):s,D=T===s;if(D){var z=ce(m),Z=!z&&hn(m),ne=!z&&!Z&&Hn(m);T=m,z||Z||ne?ce(d)?T=d:Oe(d)?T=ot(d):Z?(D=!1,T=qo(m,!0)):ne?(D=!1,T=zo(m,!0)):T=[]:br(m)||En(m)?(T=d,En(d)?T=kl(d):(!Me(d)||Jt(d))&&(T=ul(m))):D=!1}D&&(h.set(m,T),o(T,m,r,c,h),h.delete(m)),oi(e,n,T)}function Do(e,t){var n=e.length;if(n)return t+=t<0?n:0,Xt(t,n)?e[t]:s}function Mo(e,t,n){t.length?t=Pe(t,function(c){return ce(c)?function(h){return In(h,c.length===1?c[0]:c)}:c}):t=[ct];var r=-1;t=Pe(t,mt(te()));var o=To(e,function(c,h,d){var m=Pe(t,function(N){return N(c)});return{criteria:m,index:++r,value:c}});return Kc(o,function(c,h){return Oh(c,h,n)})}function jh(e,t){return Fo(e,t,function(n,r){return Ui(e,r)})}function Fo(e,t,n){for(var r=-1,o=t.length,c={};++r<o;){var h=t[r],d=In(e,h);n(d,h)&&yr(c,cn(h,e),d)}return c}function Ih(e){return function(t){return In(t,e)}}function mi(e,t,n,r){var o=r?Gc:Fn,c=-1,h=t.length,d=e;for(e===t&&(t=ot(t)),n&&(d=Pe(e,mt(n)));++c<h;)for(var m=0,N=t[c],T=n?n(N):N;(m=o(d,T,m,r))>-1;)d!==e&&Vr.call(d,m,1),Vr.call(e,m,1);return e}function Oo(e,t){for(var n=e?t.length:0,r=n-1;n--;){var o=t[n];if(n==r||o!==c){var c=o;Xt(o)?Vr.call(e,o,1):vi(e,o)}}return e}function yi(e,t){return e+Qr(mo()*(t-e+1))}function Ch(e,t,n,r){for(var o=-1,c=ke(Kr((t-e)/(n||1)),0),h=v(c);c--;)h[r?c:++o]=e,e+=n;return h}function xi(e,t){var n="";if(!e||t<1||t>W)return n;do t%2&&(n+=e),t=Qr(t/2),t&&(e+=e);while(t);return n}function pe(e,t){return Fi(hl(e,t,ct),e+"")}function Ah(e){return _o(Vn(e))}function Eh(e,t){var n=Vn(e);return ds(n,jn(t,0,n.length))}function yr(e,t,n,r){if(!Me(e))return e;t=cn(t,e);for(var o=-1,c=t.length,h=c-1,d=e;d!=null&&++o<c;){var m=Wt(t[o]),N=n;if(m==="__proto__"||m==="constructor"||m==="prototype")return e;if(o!=h){var T=d[m];N=r?r(T,m,d):s,N===s&&(N=Me(T)?T:Xt(t[o+1])?[]:{})}dr(d,m,N),d=d[m]}return e}var Lo=Zr?function(e,t){return Zr.set(e,t),e}:ct,Nh=Gr?function(e,t){return Gr(e,"toString",{configurable:!0,enumerable:!1,value:zi(t),writable:!0})}:ct;function Th(e){return ds(Vn(e))}function Nt(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),n=n>o?o:n,n<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var c=v(o);++r<o;)c[r]=e[r+t];return c}function Rh(e,t){var n;return ln(e,function(r,o,c){return n=t(r,o,c),!n}),!!n}function ss(e,t,n){var r=0,o=e==null?r:e.length;if(typeof t=="number"&&t===t&&o<=Y){for(;r<o;){var c=r+o>>>1,h=e[c];h!==null&&!xt(h)&&(n?h<=t:h<t)?r=c+1:o=c}return o}return _i(e,t,ct,n)}function _i(e,t,n,r){var o=0,c=e==null?0:e.length;if(c===0)return 0;t=n(t);for(var h=t!==t,d=t===null,m=xt(t),N=t===s;o<c;){var T=Qr((o+c)/2),D=n(e[T]),z=D!==s,Z=D===null,ne=D===D,de=xt(D);if(h)var re=r||ne;else N?re=ne&&(r||z):d?re=ne&&z&&(r||!Z):m?re=ne&&z&&!Z&&(r||!de):Z||de?re=!1:re=r?D<=t:D<t;re?o=T+1:c=T}return Qe(c,B)}function $o(e,t){for(var n=-1,r=e.length,o=0,c=[];++n<r;){var h=e[n],d=t?t(h):h;if(!n||!Lt(d,m)){var m=d;c[o++]=h===0?0:h}}return c}function Bo(e){return typeof e=="number"?e:xt(e)?se:+e}function yt(e){if(typeof e=="string")return e;if(ce(e))return Pe(e,yt)+"";if(xt(e))return yo?yo.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function un(e,t,n){var r=-1,o=Lr,c=e.length,h=!0,d=[],m=d;if(n)h=!1,o=Gs;else if(c>=p){var N=t?null:Wh(e);if(N)return Br(N);h=!1,o=or,m=new Sn}else m=t?[]:d;e:for(;++r<c;){var T=e[r],D=t?t(T):T;if(T=n||T!==0?T:0,h&&D===D){for(var z=m.length;z--;)if(m[z]===D)continue e;t&&m.push(D),d.push(T)}else o(m,D,n)||(m!==d&&m.push(D),d.push(T))}return d}function vi(e,t){return t=cn(t,e),e=dl(e,t),e==null||delete e[Wt(Tt(t))]}function Yo(e,t,n,r){return yr(e,t,n(In(e,t)),r)}function is(e,t,n,r){for(var o=e.length,c=r?o:-1;(r?c--:++c<o)&&t(e[c],c,e););return n?Nt(e,r?0:c,r?c+1:o):Nt(e,r?c+1:0,r?o:c)}function ko(e,t){var n=e;return n instanceof _e&&(n=n.value()),Ks(t,function(r,o){return o.func.apply(o.thisArg,sn([r],o.args))},n)}function bi(e,t,n){var r=e.length;if(r<2)return r?un(e[0]):[];for(var o=-1,c=v(r);++o<r;)for(var h=e[o],d=-1;++d<r;)d!=o&&(c[o]=pr(c[o]||h,e[d],t,n));return un(Ve(c,1),t,n)}function Wo(e,t,n){for(var r=-1,o=e.length,c=t.length,h={};++r<o;){var d=r<c?t[r]:s;n(h,e[r],d)}return h}function wi(e){return Oe(e)?e:[]}function Si(e){return typeof e=="function"?e:ct}function cn(e,t){return ce(e)?e:Pi(e,t)?[e]:yl(je(e))}var Ph=pe;function fn(e,t,n){var r=e.length;return n=n===s?r:n,!t&&n>=r?e:Nt(e,t,n)}var Uo=_f||function(e){return He.clearTimeout(e)};function qo(e,t){if(t)return e.slice();var n=e.length,r=co?co(n):new e.constructor(n);return e.copy(r),r}function ji(e){var t=new e.constructor(e.byteLength);return new zr(t).set(new zr(e)),t}function Dh(e,t){var n=t?ji(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Mh(e){var t=new e.constructor(e.source,Ca.exec(e));return t.lastIndex=e.lastIndex,t}function Fh(e){return hr?Ee(hr.call(e)):{}}function zo(e,t){var n=t?ji(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ho(e,t){if(e!==t){var n=e!==s,r=e===null,o=e===e,c=xt(e),h=t!==s,d=t===null,m=t===t,N=xt(t);if(!d&&!N&&!c&&e>t||c&&h&&m&&!d&&!N||r&&h&&m||!n&&m||!o)return 1;if(!r&&!c&&!N&&e<t||N&&n&&o&&!r&&!c||d&&n&&o||!h&&o||!m)return-1}return 0}function Oh(e,t,n){for(var r=-1,o=e.criteria,c=t.criteria,h=o.length,d=n.length;++r<h;){var m=Ho(o[r],c[r]);if(m){if(r>=d)return m;var N=n[r];return m*(N=="desc"?-1:1)}}return e.index-t.index}function Vo(e,t,n,r){for(var o=-1,c=e.length,h=n.length,d=-1,m=t.length,N=ke(c-h,0),T=v(m+N),D=!r;++d<m;)T[d]=t[d];for(;++o<h;)(D||o<c)&&(T[n[o]]=e[o]);for(;N--;)T[d++]=e[o++];return T}function Go(e,t,n,r){for(var o=-1,c=e.length,h=-1,d=n.length,m=-1,N=t.length,T=ke(c-d,0),D=v(T+N),z=!r;++o<T;)D[o]=e[o];for(var Z=o;++m<N;)D[Z+m]=t[m];for(;++h<d;)(z||o<c)&&(D[Z+n[h]]=e[o++]);return D}function ot(e,t){var n=-1,r=e.length;for(t||(t=v(r));++n<r;)t[n]=e[n];return t}function kt(e,t,n,r){var o=!n;n||(n={});for(var c=-1,h=t.length;++c<h;){var d=t[c],m=r?r(n[d],e[d],d,n,e):s;m===s&&(m=e[d]),o?Kt(n,d,m):dr(n,d,m)}return n}function Lh(e,t){return kt(e,Ri(e),t)}function $h(e,t){return kt(e,ol(e),t)}function as(e,t){return function(n,r){var o=ce(n)?Wc:ah,c=t?t():{};return o(n,e,te(r,2),c)}}function Un(e){return pe(function(t,n){var r=-1,o=n.length,c=o>1?n[o-1]:s,h=o>2?n[2]:s;for(c=e.length>3&&typeof c=="function"?(o--,c):s,h&&et(n[0],n[1],h)&&(c=o<3?s:c,o=1),t=Ee(t);++r<o;){var d=n[r];d&&e(t,d,r,c)}return t})}function Ko(e,t){return function(n,r){if(n==null)return n;if(!lt(n))return e(n,r);for(var o=n.length,c=t?o:-1,h=Ee(n);(t?c--:++c<o)&&r(h[c],c,h)!==!1;);return n}}function Qo(e){return function(t,n,r){for(var o=-1,c=Ee(t),h=r(t),d=h.length;d--;){var m=h[e?d:++o];if(n(c[m],m,c)===!1)break}return t}}function Bh(e,t,n){var r=t&w,o=xr(e);function c(){var h=this&&this!==He&&this instanceof c?o:e;return h.apply(r?n:this,arguments)}return c}function Zo(e){return function(t){t=je(t);var n=On(t)?Ft(t):s,r=n?n[0]:t.charAt(0),o=n?fn(n,1).join(""):t.slice(1);return r[e]()+o}}function qn(e){return function(t){return Ks(Kl(Gl(t).replace(Ec,"")),e,"")}}function xr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Wn(e.prototype),r=e.apply(n,t);return Me(r)?r:n}}function Yh(e,t,n){var r=xr(e);function o(){for(var c=arguments.length,h=v(c),d=c,m=zn(o);d--;)h[d]=arguments[d];var N=c<3&&h[0]!==m&&h[c-1]!==m?[]:an(h,m);if(c-=N.length,c<n)return nl(e,t,os,o.placeholder,s,h,N,s,s,n-c);var T=this&&this!==He&&this instanceof o?r:e;return gt(T,this,h)}return o}function Xo(e){return function(t,n,r){var o=Ee(t);if(!lt(t)){var c=te(n,3);t=We(t),n=function(d){return c(o[d],d,o)}}var h=e(t,n,r);return h>-1?o[c?t[h]:h]:s}}function Jo(e){return Zt(function(t){var n=t.length,r=n,o=At.prototype.thru;for(e&&t.reverse();r--;){var c=t[r];if(typeof c!="function")throw new Ct(_);if(o&&!h&&fs(c)=="wrapper")var h=new At([],!0)}for(r=h?r:n;++r<n;){c=t[r];var d=fs(c),m=d=="wrapper"?Ni(c):s;m&&Di(m[0])&&m[1]==(M|$|fe|V)&&!m[4].length&&m[9]==1?h=h[fs(m[0])].apply(h,m[3]):h=c.length==1&&Di(c)?h[d]():h.thru(c)}return function(){var N=arguments,T=N[0];if(h&&N.length==1&&ce(T))return h.plant(T).value();for(var D=0,z=n?t[D].apply(this,N):T;++D<n;)z=t[D].call(this,z);return z}})}function os(e,t,n,r,o,c,h,d,m,N){var T=t&M,D=t&w,z=t&j,Z=t&($|le),ne=t&k,de=z?s:xr(e);function re(){for(var xe=arguments.length,ve=v(xe),_t=xe;_t--;)ve[_t]=arguments[_t];if(Z)var tt=zn(re),vt=Zc(ve,tt);if(r&&(ve=Vo(ve,r,o,Z)),c&&(ve=Go(ve,c,h,Z)),xe-=vt,Z&&xe<N){var Le=an(ve,tt);return nl(e,t,os,re.placeholder,n,ve,Le,d,m,N-xe)}var $t=D?n:this,tn=z?$t[e]:e;return xe=ve.length,d?ve=ad(ve,d):ne&&xe>1&&ve.reverse(),T&&m<xe&&(ve.length=m),this&&this!==He&&this instanceof re&&(tn=de||xr(tn)),tn.apply($t,ve)}return re}function el(e,t){return function(n,r){return ph(n,e,t(r),{})}}function ls(e,t){return function(n,r){var o;if(n===s&&r===s)return t;if(n!==s&&(o=n),r!==s){if(o===s)return r;typeof n=="string"||typeof r=="string"?(n=yt(n),r=yt(r)):(n=Bo(n),r=Bo(r)),o=e(n,r)}return o}}function Ii(e){return Zt(function(t){return t=Pe(t,mt(te())),pe(function(n){var r=this;return e(t,function(o){return gt(o,r,n)})})})}function us(e,t){t=t===s?" ":yt(t);var n=t.length;if(n<2)return n?xi(t,e):t;var r=xi(t,Kr(e/Ln(t)));return On(t)?fn(Ft(r),0,e).join(""):r.slice(0,e)}function kh(e,t,n,r){var o=t&w,c=xr(e);function h(){for(var d=-1,m=arguments.length,N=-1,T=r.length,D=v(T+m),z=this&&this!==He&&this instanceof h?c:e;++N<T;)D[N]=r[N];for(;m--;)D[N++]=arguments[++d];return gt(z,o?n:this,D)}return h}function tl(e){return function(t,n,r){return r&&typeof r!="number"&&et(t,n,r)&&(n=r=s),t=en(t),n===s?(n=t,t=0):n=en(n),r=r===s?t<n?1:-1:en(r),Ch(t,n,r,e)}}function cs(e){return function(t,n){return typeof t=="string"&&typeof n=="string"||(t=Rt(t),n=Rt(n)),e(t,n)}}function nl(e,t,n,r,o,c,h,d,m,N){var T=t&$,D=T?h:s,z=T?s:h,Z=T?c:s,ne=T?s:c;t|=T?fe:Se,t&=~(T?Se:fe),t&K||(t&=-4);var de=[e,t,o,Z,D,ne,z,d,m,N],re=n.apply(s,de);return Di(e)&&pl(re,de),re.placeholder=r,gl(re,e,t)}function Ci(e){var t=Ye[e];return function(n,r){if(n=Rt(n),r=r==null?0:Qe(he(r),292),r&&go(n)){var o=(je(n)+"e").split("e"),c=t(o[0]+"e"+(+o[1]+r));return o=(je(c)+"e").split("e"),+(o[0]+"e"+(+o[1]-r))}return t(n)}}var Wh=Yn&&1/Br(new Yn([,-0]))[1]==Q?function(e){return new Yn(e)}:Gi;function rl(e){return function(t){var n=Ze(t);return n==Dt?ni(t):n==Mt?sf(t):Qc(t,e(t))}}function Qt(e,t,n,r,o,c,h,d){var m=t&j;if(!m&&typeof e!="function")throw new Ct(_);var N=r?r.length:0;if(N||(t&=-97,r=o=s),h=h===s?h:ke(he(h),0),d=d===s?d:he(d),N-=o?o.length:0,t&Se){var T=r,D=o;r=o=s}var z=m?s:Ni(e),Z=[e,t,n,r,o,T,D,c,h,d];if(z&&rd(Z,z),e=Z[0],t=Z[1],n=Z[2],r=Z[3],o=Z[4],d=Z[9]=Z[9]===s?m?0:e.length:ke(Z[9]-N,0),!d&&t&($|le)&&(t&=-25),!t||t==w)var ne=Bh(e,t,n);else t==$||t==le?ne=Yh(e,t,d):(t==fe||t==(w|fe))&&!o.length?ne=kh(e,t,n,r):ne=os.apply(s,Z);var de=z?Lo:pl;return gl(de(ne,Z),e,t)}function sl(e,t,n,r){return e===s||Lt(e,Bn[n])&&!Ce.call(r,n)?t:e}function il(e,t,n,r,o,c){return Me(e)&&Me(t)&&(c.set(t,e),rs(e,t,s,il,c),c.delete(t)),e}function Uh(e){return br(e)?s:e}function al(e,t,n,r,o,c){var h=n&S,d=e.length,m=t.length;if(d!=m&&!(h&&m>d))return!1;var N=c.get(e),T=c.get(t);if(N&&T)return N==t&&T==e;var D=-1,z=!0,Z=n&F?new Sn:s;for(c.set(e,t),c.set(t,e);++D<d;){var ne=e[D],de=t[D];if(r)var re=h?r(de,ne,D,t,e,c):r(ne,de,D,e,t,c);if(re!==s){if(re)continue;z=!1;break}if(Z){if(!Qs(t,function(xe,ve){if(!or(Z,ve)&&(ne===xe||o(ne,xe,n,r,c)))return Z.push(ve)})){z=!1;break}}else if(!(ne===de||o(ne,de,n,r,c))){z=!1;break}}return c.delete(e),c.delete(t),z}function qh(e,t,n,r,o,c,h){switch(n){case Dn:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ar:return!(e.byteLength!=t.byteLength||!c(new zr(e),new zr(t)));case at:case Ke:case nr:return Lt(+e,+t);case pt:return e.name==t.name&&e.message==t.message;case rr:case sr:return e==t+"";case Dt:var d=ni;case Mt:var m=r&S;if(d||(d=Br),e.size!=t.size&&!m)return!1;var N=h.get(e);if(N)return N==t;r|=F,h.set(e,t);var T=al(d(e),d(t),r,o,c,h);return h.delete(e),T;case Dr:if(hr)return hr.call(e)==hr.call(t)}return!1}function zh(e,t,n,r,o,c){var h=n&S,d=Ai(e),m=d.length,N=Ai(t),T=N.length;if(m!=T&&!h)return!1;for(var D=m;D--;){var z=d[D];if(!(h?z in t:Ce.call(t,z)))return!1}var Z=c.get(e),ne=c.get(t);if(Z&&ne)return Z==t&&ne==e;var de=!0;c.set(e,t),c.set(t,e);for(var re=h;++D<m;){z=d[D];var xe=e[z],ve=t[z];if(r)var _t=h?r(ve,xe,z,t,e,c):r(xe,ve,z,e,t,c);if(!(_t===s?xe===ve||o(xe,ve,n,r,c):_t)){de=!1;break}re||(re=z=="constructor")}if(de&&!re){var tt=e.constructor,vt=t.constructor;tt!=vt&&"constructor"in e&&"constructor"in t&&!(typeof tt=="function"&&tt instanceof tt&&typeof vt=="function"&&vt instanceof vt)&&(de=!1)}return c.delete(e),c.delete(t),de}function Zt(e){return Fi(hl(e,s,bl),e+"")}function Ai(e){return Co(e,We,Ri)}function Ei(e){return Co(e,ut,ol)}var Ni=Zr?function(e){return Zr.get(e)}:Gi;function fs(e){for(var t=e.name+"",n=kn[t],r=Ce.call(kn,t)?n.length:0;r--;){var o=n[r],c=o.func;if(c==null||c==e)return o.name}return t}function zn(e){var t=Ce.call(u,"placeholder")?u:e;return t.placeholder}function te(){var e=u.iteratee||Hi;return e=e===Hi?No:e,arguments.length?e(arguments[0],arguments[1]):e}function hs(e,t){var n=e.__data__;return Jh(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Ti(e){for(var t=We(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,cl(o)]}return t}function Cn(e,t){var n=tf(e,t);return Eo(n)?n:s}function Hh(e){var t=Ce.call(e,bn),n=e[bn];try{e[bn]=s;var r=!0}catch{}var o=Ur.call(e);return r&&(t?e[bn]=n:delete e[bn]),o}var Ri=si?function(e){return e==null?[]:(e=Ee(e),rn(si(e),function(t){return ho.call(e,t)}))}:Ki,ol=si?function(e){for(var t=[];e;)sn(t,Ri(e)),e=Hr(e);return t}:Ki,Ze=Je;(ii&&Ze(new ii(new ArrayBuffer(1)))!=Dn||ur&&Ze(new ur)!=Dt||ai&&Ze(ai.resolve())!=wa||Yn&&Ze(new Yn)!=Mt||cr&&Ze(new cr)!=ir)&&(Ze=function(e){var t=Je(e),n=t==Ht?e.constructor:s,r=n?An(n):"";if(r)switch(r){case Ef:return Dn;case Nf:return Dt;case Tf:return wa;case Rf:return Mt;case Pf:return ir}return t});function Vh(e,t,n){for(var r=-1,o=n.length;++r<o;){var c=n[r],h=c.size;switch(c.type){case"drop":e+=h;break;case"dropRight":t-=h;break;case"take":t=Qe(t,e+h);break;case"takeRight":e=ke(e,t-h);break}}return{start:e,end:t}}function Gh(e){var t=e.match(Ju);return t?t[1].split(ec):[]}function ll(e,t,n){t=cn(t,e);for(var r=-1,o=t.length,c=!1;++r<o;){var h=Wt(t[r]);if(!(c=e!=null&&n(e,h)))break;e=e[h]}return c||++r!=o?c:(o=e==null?0:e.length,!!o&&_s(o)&&Xt(h,o)&&(ce(e)||En(e)))}function Kh(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&Ce.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function ul(e){return typeof e.constructor=="function"&&!_r(e)?Wn(Hr(e)):{}}function Qh(e,t,n){var r=e.constructor;switch(t){case ar:return ji(e);case at:case Ke:return new r(+e);case Dn:return Dh(e,n);case Ts:case Rs:case Ps:case Ds:case Ms:case Fs:case Os:case Ls:case $s:return zo(e,n);case Dt:return new r;case nr:case sr:return new r(e);case rr:return Mh(e);case Mt:return new r;case Dr:return Fh(e)}}function Zh(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(Xu,`{
/* [wrapped with `+t+`] */
`)}function Xh(e){return ce(e)||En(e)||!!(po&&e&&e[po])}function Xt(e,t){var n=typeof e;return t=t??W,!!t&&(n=="number"||n!="symbol"&&uc.test(e))&&e>-1&&e%1==0&&e<t}function et(e,t,n){if(!Me(n))return!1;var r=typeof t;return(r=="number"?lt(n)&&Xt(t,n.length):r=="string"&&t in n)?Lt(n[t],e):!1}function Pi(e,t){if(ce(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||xt(e)?!0:Gu.test(e)||!Vu.test(e)||t!=null&&e in Ee(t)}function Jh(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Di(e){var t=fs(e),n=u[t];if(typeof n!="function"||!(t in _e.prototype))return!1;if(e===n)return!0;var r=Ni(n);return!!r&&e===r[0]}function ed(e){return!!uo&&uo in e}var td=kr?Jt:Qi;function _r(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Bn;return e===n}function cl(e){return e===e&&!Me(e)}function fl(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==s||e in Ee(n))}}function nd(e){var t=ys(e,function(r){return n.size===P&&n.clear(),r}),n=t.cache;return t}function rd(e,t){var n=e[1],r=t[1],o=n|r,c=o<(w|j|M),h=r==M&&n==$||r==M&&n==V&&e[7].length<=t[8]||r==(M|V)&&t[7].length<=t[8]&&n==$;if(!(c||h))return e;r&w&&(e[2]=t[2],o|=n&w?0:K);var d=t[3];if(d){var m=e[3];e[3]=m?Vo(m,d,t[4]):d,e[4]=m?an(e[3],E):t[4]}return d=t[5],d&&(m=e[5],e[5]=m?Go(m,d,t[6]):d,e[6]=m?an(e[5],E):t[6]),d=t[7],d&&(e[7]=d),r&M&&(e[8]=e[8]==null?t[8]:Qe(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=o,e}function sd(e){var t=[];if(e!=null)for(var n in Ee(e))t.push(n);return t}function id(e){return Ur.call(e)}function hl(e,t,n){return t=ke(t===s?e.length-1:t,0),function(){for(var r=arguments,o=-1,c=ke(r.length-t,0),h=v(c);++o<c;)h[o]=r[t+o];o=-1;for(var d=v(t+1);++o<t;)d[o]=r[o];return d[t]=n(h),gt(e,this,d)}}function dl(e,t){return t.length<2?e:In(e,Nt(t,0,-1))}function ad(e,t){for(var n=e.length,r=Qe(t.length,n),o=ot(e);r--;){var c=t[r];e[r]=Xt(c,n)?o[c]:s}return e}function Mi(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var pl=ml(Lo),vr=bf||function(e,t){return He.setTimeout(e,t)},Fi=ml(Nh);function gl(e,t,n){var r=t+"";return Fi(e,Zh(r,od(Gh(r),n)))}function ml(e){var t=0,n=0;return function(){var r=If(),o=Xe-(r-n);if(n=r,o>0){if(++t>=Ae)return arguments[0]}else t=0;return e.apply(s,arguments)}}function ds(e,t){var n=-1,r=e.length,o=r-1;for(t=t===s?r:t;++n<t;){var c=yi(n,o),h=e[c];e[c]=e[n],e[n]=h}return e.length=t,e}var yl=nd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ku,function(n,r,o,c){t.push(o?c.replace(rc,"$1"):r||n)}),t});function Wt(e){if(typeof e=="string"||xt(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function An(e){if(e!=null){try{return Wr.call(e)}catch{}try{return e+""}catch{}}return""}function od(e,t){return It(ie,function(n){var r="_."+n[0];t&n[1]&&!Lr(e,r)&&e.push(r)}),e.sort()}function xl(e){if(e instanceof _e)return e.clone();var t=new At(e.__wrapped__,e.__chain__);return t.__actions__=ot(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function ld(e,t,n){(n?et(e,t,n):t===s)?t=1:t=ke(he(t),0);var r=e==null?0:e.length;if(!r||t<1)return[];for(var o=0,c=0,h=v(Kr(r/t));o<r;)h[c++]=Nt(e,o,o+=t);return h}function ud(e){for(var t=-1,n=e==null?0:e.length,r=0,o=[];++t<n;){var c=e[t];c&&(o[r++]=c)}return o}function cd(){var e=arguments.length;if(!e)return[];for(var t=v(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return sn(ce(n)?ot(n):[n],Ve(t,1))}var fd=pe(function(e,t){return Oe(e)?pr(e,Ve(t,1,Oe,!0)):[]}),hd=pe(function(e,t){var n=Tt(t);return Oe(n)&&(n=s),Oe(e)?pr(e,Ve(t,1,Oe,!0),te(n,2)):[]}),dd=pe(function(e,t){var n=Tt(t);return Oe(n)&&(n=s),Oe(e)?pr(e,Ve(t,1,Oe,!0),s,n):[]});function pd(e,t,n){var r=e==null?0:e.length;return r?(t=n||t===s?1:he(t),Nt(e,t<0?0:t,r)):[]}function gd(e,t,n){var r=e==null?0:e.length;return r?(t=n||t===s?1:he(t),t=r-t,Nt(e,0,t<0?0:t)):[]}function md(e,t){return e&&e.length?is(e,te(t,3),!0,!0):[]}function yd(e,t){return e&&e.length?is(e,te(t,3),!0):[]}function xd(e,t,n,r){var o=e==null?0:e.length;return o?(n&&typeof n!="number"&&et(e,t,n)&&(n=0,r=o),ch(e,t,n,r)):[]}function _l(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var o=n==null?0:he(n);return o<0&&(o=ke(r+o,0)),$r(e,te(t,3),o)}function vl(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var o=r-1;return n!==s&&(o=he(n),o=n<0?ke(r+o,0):Qe(o,r-1)),$r(e,te(t,3),o,!0)}function bl(e){var t=e==null?0:e.length;return t?Ve(e,1):[]}function _d(e){var t=e==null?0:e.length;return t?Ve(e,Q):[]}function vd(e,t){var n=e==null?0:e.length;return n?(t=t===s?1:he(t),Ve(e,t)):[]}function bd(e){for(var t=-1,n=e==null?0:e.length,r={};++t<n;){var o=e[t];r[o[0]]=o[1]}return r}function wl(e){return e&&e.length?e[0]:s}function wd(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var o=n==null?0:he(n);return o<0&&(o=ke(r+o,0)),Fn(e,t,o)}function Sd(e){var t=e==null?0:e.length;return t?Nt(e,0,-1):[]}var jd=pe(function(e){var t=Pe(e,wi);return t.length&&t[0]===e[0]?hi(t):[]}),Id=pe(function(e){var t=Tt(e),n=Pe(e,wi);return t===Tt(n)?t=s:n.pop(),n.length&&n[0]===e[0]?hi(n,te(t,2)):[]}),Cd=pe(function(e){var t=Tt(e),n=Pe(e,wi);return t=typeof t=="function"?t:s,t&&n.pop(),n.length&&n[0]===e[0]?hi(n,s,t):[]});function Ad(e,t){return e==null?"":Sf.call(e,t)}function Tt(e){var t=e==null?0:e.length;return t?e[t-1]:s}function Ed(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var o=r;return n!==s&&(o=he(n),o=o<0?ke(r+o,0):Qe(o,r-1)),t===t?of(e,t,o):$r(e,to,o,!0)}function Nd(e,t){return e&&e.length?Do(e,he(t)):s}var Td=pe(Sl);function Sl(e,t){return e&&e.length&&t&&t.length?mi(e,t):e}function Rd(e,t,n){return e&&e.length&&t&&t.length?mi(e,t,te(n,2)):e}function Pd(e,t,n){return e&&e.length&&t&&t.length?mi(e,t,s,n):e}var Dd=Zt(function(e,t){var n=e==null?0:e.length,r=li(e,t);return Oo(e,Pe(t,function(o){return Xt(o,n)?+o:o}).sort(Ho)),r});function Md(e,t){var n=[];if(!(e&&e.length))return n;var r=-1,o=[],c=e.length;for(t=te(t,3);++r<c;){var h=e[r];t(h,r,e)&&(n.push(h),o.push(r))}return Oo(e,o),n}function Oi(e){return e==null?e:Af.call(e)}function Fd(e,t,n){var r=e==null?0:e.length;return r?(n&&typeof n!="number"&&et(e,t,n)?(t=0,n=r):(t=t==null?0:he(t),n=n===s?r:he(n)),Nt(e,t,n)):[]}function Od(e,t){return ss(e,t)}function Ld(e,t,n){return _i(e,t,te(n,2))}function $d(e,t){var n=e==null?0:e.length;if(n){var r=ss(e,t);if(r<n&&Lt(e[r],t))return r}return-1}function Bd(e,t){return ss(e,t,!0)}function Yd(e,t,n){return _i(e,t,te(n,2),!0)}function kd(e,t){var n=e==null?0:e.length;if(n){var r=ss(e,t,!0)-1;if(Lt(e[r],t))return r}return-1}function Wd(e){return e&&e.length?$o(e):[]}function Ud(e,t){return e&&e.length?$o(e,te(t,2)):[]}function qd(e){var t=e==null?0:e.length;return t?Nt(e,1,t):[]}function zd(e,t,n){return e&&e.length?(t=n||t===s?1:he(t),Nt(e,0,t<0?0:t)):[]}function Hd(e,t,n){var r=e==null?0:e.length;return r?(t=n||t===s?1:he(t),t=r-t,Nt(e,t<0?0:t,r)):[]}function Vd(e,t){return e&&e.length?is(e,te(t,3),!1,!0):[]}function Gd(e,t){return e&&e.length?is(e,te(t,3)):[]}var Kd=pe(function(e){return un(Ve(e,1,Oe,!0))}),Qd=pe(function(e){var t=Tt(e);return Oe(t)&&(t=s),un(Ve(e,1,Oe,!0),te(t,2))}),Zd=pe(function(e){var t=Tt(e);return t=typeof t=="function"?t:s,un(Ve(e,1,Oe,!0),s,t)});function Xd(e){return e&&e.length?un(e):[]}function Jd(e,t){return e&&e.length?un(e,te(t,2)):[]}function ep(e,t){return t=typeof t=="function"?t:s,e&&e.length?un(e,s,t):[]}function Li(e){if(!(e&&e.length))return[];var t=0;return e=rn(e,function(n){if(Oe(n))return t=ke(n.length,t),!0}),ei(t,function(n){return Pe(e,Zs(n))})}function jl(e,t){if(!(e&&e.length))return[];var n=Li(e);return t==null?n:Pe(n,function(r){return gt(t,s,r)})}var tp=pe(function(e,t){return Oe(e)?pr(e,t):[]}),np=pe(function(e){return bi(rn(e,Oe))}),rp=pe(function(e){var t=Tt(e);return Oe(t)&&(t=s),bi(rn(e,Oe),te(t,2))}),sp=pe(function(e){var t=Tt(e);return t=typeof t=="function"?t:s,bi(rn(e,Oe),s,t)}),ip=pe(Li);function ap(e,t){return Wo(e||[],t||[],dr)}function op(e,t){return Wo(e||[],t||[],yr)}var lp=pe(function(e){var t=e.length,n=t>1?e[t-1]:s;return n=typeof n=="function"?(e.pop(),n):s,jl(e,n)});function Il(e){var t=u(e);return t.__chain__=!0,t}function up(e,t){return t(e),e}function ps(e,t){return t(e)}var cp=Zt(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(c){return li(c,e)};return t>1||this.__actions__.length||!(r instanceof _e)||!Xt(n)?this.thru(o):(r=r.slice(n,+n+(t?1:0)),r.__actions__.push({func:ps,args:[o],thisArg:s}),new At(r,this.__chain__).thru(function(c){return t&&!c.length&&c.push(s),c}))});function fp(){return Il(this)}function hp(){return new At(this.value(),this.__chain__)}function dp(){this.__values__===s&&(this.__values__=Bl(this.value()));var e=this.__index__>=this.__values__.length,t=e?s:this.__values__[this.__index__++];return{done:e,value:t}}function pp(){return this}function gp(e){for(var t,n=this;n instanceof Jr;){var r=xl(n);r.__index__=0,r.__values__=s,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t}function mp(){var e=this.__wrapped__;if(e instanceof _e){var t=e;return this.__actions__.length&&(t=new _e(this)),t=t.reverse(),t.__actions__.push({func:ps,args:[Oi],thisArg:s}),new At(t,this.__chain__)}return this.thru(Oi)}function yp(){return ko(this.__wrapped__,this.__actions__)}var xp=as(function(e,t,n){Ce.call(e,n)?++e[n]:Kt(e,n,1)});function _p(e,t,n){var r=ce(e)?Ja:uh;return n&&et(e,t,n)&&(t=s),r(e,te(t,3))}function vp(e,t){var n=ce(e)?rn:jo;return n(e,te(t,3))}var bp=Xo(_l),wp=Xo(vl);function Sp(e,t){return Ve(gs(e,t),1)}function jp(e,t){return Ve(gs(e,t),Q)}function Ip(e,t,n){return n=n===s?1:he(n),Ve(gs(e,t),n)}function Cl(e,t){var n=ce(e)?It:ln;return n(e,te(t,3))}function Al(e,t){var n=ce(e)?Uc:So;return n(e,te(t,3))}var Cp=as(function(e,t,n){Ce.call(e,n)?e[n].push(t):Kt(e,n,[t])});function Ap(e,t,n,r){e=lt(e)?e:Vn(e),n=n&&!r?he(n):0;var o=e.length;return n<0&&(n=ke(o+n,0)),vs(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&Fn(e,t,n)>-1}var Ep=pe(function(e,t,n){var r=-1,o=typeof t=="function",c=lt(e)?v(e.length):[];return ln(e,function(h){c[++r]=o?gt(t,h,n):gr(h,t,n)}),c}),Np=as(function(e,t,n){Kt(e,n,t)});function gs(e,t){var n=ce(e)?Pe:To;return n(e,te(t,3))}function Tp(e,t,n,r){return e==null?[]:(ce(t)||(t=t==null?[]:[t]),n=r?s:n,ce(n)||(n=n==null?[]:[n]),Mo(e,t,n))}var Rp=as(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});function Pp(e,t,n){var r=ce(e)?Ks:ro,o=arguments.length<3;return r(e,te(t,4),n,o,ln)}function Dp(e,t,n){var r=ce(e)?qc:ro,o=arguments.length<3;return r(e,te(t,4),n,o,So)}function Mp(e,t){var n=ce(e)?rn:jo;return n(e,xs(te(t,3)))}function Fp(e){var t=ce(e)?_o:Ah;return t(e)}function Op(e,t,n){(n?et(e,t,n):t===s)?t=1:t=he(t);var r=ce(e)?sh:Eh;return r(e,t)}function Lp(e){var t=ce(e)?ih:Th;return t(e)}function $p(e){if(e==null)return 0;if(lt(e))return vs(e)?Ln(e):e.length;var t=Ze(e);return t==Dt||t==Mt?e.size:pi(e).length}function Bp(e,t,n){var r=ce(e)?Qs:Rh;return n&&et(e,t,n)&&(t=s),r(e,te(t,3))}var Yp=pe(function(e,t){if(e==null)return[];var n=t.length;return n>1&&et(e,t[0],t[1])?t=[]:n>2&&et(t[0],t[1],t[2])&&(t=[t[0]]),Mo(e,Ve(t,1),[])}),ms=vf||function(){return He.Date.now()};function kp(e,t){if(typeof t!="function")throw new Ct(_);return e=he(e),function(){if(--e<1)return t.apply(this,arguments)}}function El(e,t,n){return t=n?s:t,t=e&&t==null?e.length:t,Qt(e,M,s,s,s,s,t)}function Nl(e,t){var n;if(typeof t!="function")throw new Ct(_);return e=he(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=s),n}}var $i=pe(function(e,t,n){var r=w;if(n.length){var o=an(n,zn($i));r|=fe}return Qt(e,r,t,n,o)}),Tl=pe(function(e,t,n){var r=w|j;if(n.length){var o=an(n,zn(Tl));r|=fe}return Qt(t,r,e,n,o)});function Rl(e,t,n){t=n?s:t;var r=Qt(e,$,s,s,s,s,s,t);return r.placeholder=Rl.placeholder,r}function Pl(e,t,n){t=n?s:t;var r=Qt(e,le,s,s,s,s,s,t);return r.placeholder=Pl.placeholder,r}function Dl(e,t,n){var r,o,c,h,d,m,N=0,T=!1,D=!1,z=!0;if(typeof e!="function")throw new Ct(_);t=Rt(t)||0,Me(n)&&(T=!!n.leading,D="maxWait"in n,c=D?ke(Rt(n.maxWait)||0,t):c,z="trailing"in n?!!n.trailing:z);function Z(Le){var $t=r,tn=o;return r=o=s,N=Le,h=e.apply(tn,$t),h}function ne(Le){return N=Le,d=vr(xe,t),T?Z(Le):h}function de(Le){var $t=Le-m,tn=Le-N,Xl=t-$t;return D?Qe(Xl,c-tn):Xl}function re(Le){var $t=Le-m,tn=Le-N;return m===s||$t>=t||$t<0||D&&tn>=c}function xe(){var Le=ms();if(re(Le))return ve(Le);d=vr(xe,de(Le))}function ve(Le){return d=s,z&&r?Z(Le):(r=o=s,h)}function _t(){d!==s&&Uo(d),N=0,r=m=o=d=s}function tt(){return d===s?h:ve(ms())}function vt(){var Le=ms(),$t=re(Le);if(r=arguments,o=this,m=Le,$t){if(d===s)return ne(m);if(D)return Uo(d),d=vr(xe,t),Z(m)}return d===s&&(d=vr(xe,t)),h}return vt.cancel=_t,vt.flush=tt,vt}var Wp=pe(function(e,t){return wo(e,1,t)}),Up=pe(function(e,t,n){return wo(e,Rt(t)||0,n)});function qp(e){return Qt(e,k)}function ys(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new Ct(_);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],c=n.cache;if(c.has(o))return c.get(o);var h=e.apply(this,r);return n.cache=c.set(o,h)||c,h};return n.cache=new(ys.Cache||Gt),n}ys.Cache=Gt;function xs(e){if(typeof e!="function")throw new Ct(_);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function zp(e){return Nl(2,e)}var Hp=Ph(function(e,t){t=t.length==1&&ce(t[0])?Pe(t[0],mt(te())):Pe(Ve(t,1),mt(te()));var n=t.length;return pe(function(r){for(var o=-1,c=Qe(r.length,n);++o<c;)r[o]=t[o].call(this,r[o]);return gt(e,this,r)})}),Bi=pe(function(e,t){var n=an(t,zn(Bi));return Qt(e,fe,s,t,n)}),Ml=pe(function(e,t){var n=an(t,zn(Ml));return Qt(e,Se,s,t,n)}),Vp=Zt(function(e,t){return Qt(e,V,s,s,s,t)});function Gp(e,t){if(typeof e!="function")throw new Ct(_);return t=t===s?t:he(t),pe(e,t)}function Kp(e,t){if(typeof e!="function")throw new Ct(_);return t=t==null?0:ke(he(t),0),pe(function(n){var r=n[t],o=fn(n,0,t);return r&&sn(o,r),gt(e,this,o)})}function Qp(e,t,n){var r=!0,o=!0;if(typeof e!="function")throw new Ct(_);return Me(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Dl(e,t,{leading:r,maxWait:t,trailing:o})}function Zp(e){return El(e,1)}function Xp(e,t){return Bi(Si(t),e)}function Jp(){if(!arguments.length)return[];var e=arguments[0];return ce(e)?e:[e]}function eg(e){return Et(e,x)}function tg(e,t){return t=typeof t=="function"?t:s,Et(e,x,t)}function ng(e){return Et(e,b|x)}function rg(e,t){return t=typeof t=="function"?t:s,Et(e,b|x,t)}function sg(e,t){return t==null||bo(e,t,We(t))}function Lt(e,t){return e===t||e!==e&&t!==t}var ig=cs(fi),ag=cs(function(e,t){return e>=t}),En=Ao(function(){return arguments}())?Ao:function(e){return Fe(e)&&Ce.call(e,"callee")&&!ho.call(e,"callee")},ce=v.isArray,og=Va?mt(Va):gh;function lt(e){return e!=null&&_s(e.length)&&!Jt(e)}function Oe(e){return Fe(e)&&lt(e)}function lg(e){return e===!0||e===!1||Fe(e)&&Je(e)==at}var hn=wf||Qi,ug=Ga?mt(Ga):mh;function cg(e){return Fe(e)&&e.nodeType===1&&!br(e)}function fg(e){if(e==null)return!0;if(lt(e)&&(ce(e)||typeof e=="string"||typeof e.splice=="function"||hn(e)||Hn(e)||En(e)))return!e.length;var t=Ze(e);if(t==Dt||t==Mt)return!e.size;if(_r(e))return!pi(e).length;for(var n in e)if(Ce.call(e,n))return!1;return!0}function hg(e,t){return mr(e,t)}function dg(e,t,n){n=typeof n=="function"?n:s;var r=n?n(e,t):s;return r===s?mr(e,t,s,n):!!r}function Yi(e){if(!Fe(e))return!1;var t=Je(e);return t==pt||t==Be||typeof e.message=="string"&&typeof e.name=="string"&&!br(e)}function pg(e){return typeof e=="number"&&go(e)}function Jt(e){if(!Me(e))return!1;var t=Je(e);return t==Bt||t==_n||t==St||t==Lu}function Fl(e){return typeof e=="number"&&e==he(e)}function _s(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=W}function Me(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function Fe(e){return e!=null&&typeof e=="object"}var Ol=Ka?mt(Ka):xh;function gg(e,t){return e===t||di(e,t,Ti(t))}function mg(e,t,n){return n=typeof n=="function"?n:s,di(e,t,Ti(t),n)}function yg(e){return Ll(e)&&e!=+e}function xg(e){if(td(e))throw new ue(y);return Eo(e)}function _g(e){return e===null}function vg(e){return e==null}function Ll(e){return typeof e=="number"||Fe(e)&&Je(e)==nr}function br(e){if(!Fe(e)||Je(e)!=Ht)return!1;var t=Hr(e);if(t===null)return!0;var n=Ce.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Wr.call(n)==mf}var ki=Qa?mt(Qa):_h;function bg(e){return Fl(e)&&e>=-9007199254740991&&e<=W}var $l=Za?mt(Za):vh;function vs(e){return typeof e=="string"||!ce(e)&&Fe(e)&&Je(e)==sr}function xt(e){return typeof e=="symbol"||Fe(e)&&Je(e)==Dr}var Hn=Xa?mt(Xa):bh;function wg(e){return e===s}function Sg(e){return Fe(e)&&Ze(e)==ir}function jg(e){return Fe(e)&&Je(e)==Bu}var Ig=cs(gi),Cg=cs(function(e,t){return e<=t});function Bl(e){if(!e)return[];if(lt(e))return vs(e)?Ft(e):ot(e);if(lr&&e[lr])return rf(e[lr]());var t=Ze(e),n=t==Dt?ni:t==Mt?Br:Vn;return n(e)}function en(e){if(!e)return e===0?e:0;if(e=Rt(e),e===Q||e===-1/0){var t=e<0?-1:1;return t*ae}return e===e?e:0}function he(e){var t=en(e),n=t%1;return t===t?n?t-n:t:0}function Yl(e){return e?jn(he(e),0,ge):0}function Rt(e){if(typeof e=="number")return e;if(xt(e))return se;if(Me(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Me(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=so(e);var n=ac.test(e);return n||lc.test(e)?Yc(e.slice(2),n?2:8):ic.test(e)?se:+e}function kl(e){return kt(e,ut(e))}function Ag(e){return e?jn(he(e),-9007199254740991,W):e===0?e:0}function je(e){return e==null?"":yt(e)}var Eg=Un(function(e,t){if(_r(t)||lt(t)){kt(t,We(t),e);return}for(var n in t)Ce.call(t,n)&&dr(e,n,t[n])}),Wl=Un(function(e,t){kt(t,ut(t),e)}),bs=Un(function(e,t,n,r){kt(t,ut(t),e,r)}),Ng=Un(function(e,t,n,r){kt(t,We(t),e,r)}),Tg=Zt(li);function Rg(e,t){var n=Wn(e);return t==null?n:vo(n,t)}var Pg=pe(function(e,t){e=Ee(e);var n=-1,r=t.length,o=r>2?t[2]:s;for(o&&et(t[0],t[1],o)&&(r=1);++n<r;)for(var c=t[n],h=ut(c),d=-1,m=h.length;++d<m;){var N=h[d],T=e[N];(T===s||Lt(T,Bn[N])&&!Ce.call(e,N))&&(e[N]=c[N])}return e}),Dg=pe(function(e){return e.push(s,il),gt(Ul,s,e)});function Mg(e,t){return eo(e,te(t,3),Yt)}function Fg(e,t){return eo(e,te(t,3),ci)}function Og(e,t){return e==null?e:ui(e,te(t,3),ut)}function Lg(e,t){return e==null?e:Io(e,te(t,3),ut)}function $g(e,t){return e&&Yt(e,te(t,3))}function Bg(e,t){return e&&ci(e,te(t,3))}function Yg(e){return e==null?[]:ns(e,We(e))}function kg(e){return e==null?[]:ns(e,ut(e))}function Wi(e,t,n){var r=e==null?s:In(e,t);return r===s?n:r}function Wg(e,t){return e!=null&&ll(e,t,fh)}function Ui(e,t){return e!=null&&ll(e,t,hh)}var Ug=el(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=Ur.call(t)),e[t]=n},zi(ct)),qg=el(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=Ur.call(t)),Ce.call(e,t)?e[t].push(n):e[t]=[n]},te),zg=pe(gr);function We(e){return lt(e)?xo(e):pi(e)}function ut(e){return lt(e)?xo(e,!0):wh(e)}function Hg(e,t){var n={};return t=te(t,3),Yt(e,function(r,o,c){Kt(n,t(r,o,c),r)}),n}function Vg(e,t){var n={};return t=te(t,3),Yt(e,function(r,o,c){Kt(n,o,t(r,o,c))}),n}var Gg=Un(function(e,t,n){rs(e,t,n)}),Ul=Un(function(e,t,n,r){rs(e,t,n,r)}),Kg=Zt(function(e,t){var n={};if(e==null)return n;var r=!1;t=Pe(t,function(c){return c=cn(c,e),r||(r=c.length>1),c}),kt(e,Ei(e),n),r&&(n=Et(n,b|R|x,Uh));for(var o=t.length;o--;)vi(n,t[o]);return n});function Qg(e,t){return ql(e,xs(te(t)))}var Zg=Zt(function(e,t){return e==null?{}:jh(e,t)});function ql(e,t){if(e==null)return{};var n=Pe(Ei(e),function(r){return[r]});return t=te(t),Fo(e,n,function(r,o){return t(r,o[0])})}function Xg(e,t,n){t=cn(t,e);var r=-1,o=t.length;for(o||(o=1,e=s);++r<o;){var c=e==null?s:e[Wt(t[r])];c===s&&(r=o,c=n),e=Jt(c)?c.call(e):c}return e}function Jg(e,t,n){return e==null?e:yr(e,t,n)}function em(e,t,n,r){return r=typeof r=="function"?r:s,e==null?e:yr(e,t,n,r)}var zl=rl(We),Hl=rl(ut);function tm(e,t,n){var r=ce(e),o=r||hn(e)||Hn(e);if(t=te(t,4),n==null){var c=e&&e.constructor;o?n=r?new c:[]:Me(e)?n=Jt(c)?Wn(Hr(e)):{}:n={}}return(o?It:Yt)(e,function(h,d,m){return t(n,h,d,m)}),n}function nm(e,t){return e==null?!0:vi(e,t)}function rm(e,t,n){return e==null?e:Yo(e,t,Si(n))}function sm(e,t,n,r){return r=typeof r=="function"?r:s,e==null?e:Yo(e,t,Si(n),r)}function Vn(e){return e==null?[]:ti(e,We(e))}function im(e){return e==null?[]:ti(e,ut(e))}function am(e,t,n){return n===s&&(n=t,t=s),n!==s&&(n=Rt(n),n=n===n?n:0),t!==s&&(t=Rt(t),t=t===t?t:0),jn(Rt(e),t,n)}function om(e,t,n){return t=en(t),n===s?(n=t,t=0):n=en(n),e=Rt(e),dh(e,t,n)}function lm(e,t,n){if(n&&typeof n!="boolean"&&et(e,t,n)&&(t=n=s),n===s&&(typeof t=="boolean"?(n=t,t=s):typeof e=="boolean"&&(n=e,e=s)),e===s&&t===s?(e=0,t=1):(e=en(e),t===s?(t=e,e=0):t=en(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=mo();return Qe(e+o*(t-e+Bc("1e-"+((o+"").length-1))),t)}return yi(e,t)}var um=qn(function(e,t,n){return t=t.toLowerCase(),e+(n?Vl(t):t)});function Vl(e){return qi(je(e).toLowerCase())}function Gl(e){return e=je(e),e&&e.replace(cc,Xc).replace(Nc,"")}function cm(e,t,n){e=je(e),t=yt(t);var r=e.length;n=n===s?r:jn(he(n),0,r);var o=n;return n-=t.length,n>=0&&e.slice(n,o)==t}function fm(e){return e=je(e),e&&qu.test(e)?e.replace(ja,Jc):e}function hm(e){return e=je(e),e&&Qu.test(e)?e.replace(Bs,"\\$&"):e}var dm=qn(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),pm=qn(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),gm=Zo("toLowerCase");function mm(e,t,n){e=je(e),t=he(t);var r=t?Ln(e):0;if(!t||r>=t)return e;var o=(t-r)/2;return us(Qr(o),n)+e+us(Kr(o),n)}function ym(e,t,n){e=je(e),t=he(t);var r=t?Ln(e):0;return t&&r<t?e+us(t-r,n):e}function xm(e,t,n){e=je(e),t=he(t);var r=t?Ln(e):0;return t&&r<t?us(t-r,n)+e:e}function _m(e,t,n){return n||t==null?t=0:t&&(t=+t),Cf(je(e).replace(Ys,""),t||0)}function vm(e,t,n){return(n?et(e,t,n):t===s)?t=1:t=he(t),xi(je(e),t)}function bm(){var e=arguments,t=je(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var wm=qn(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});function Sm(e,t,n){return n&&typeof n!="number"&&et(e,t,n)&&(t=n=s),n=n===s?ge:n>>>0,n?(e=je(e),e&&(typeof t=="string"||t!=null&&!ki(t))&&(t=yt(t),!t&&On(e))?fn(Ft(e),0,n):e.split(t,n)):[]}var jm=qn(function(e,t,n){return e+(n?" ":"")+qi(t)});function Im(e,t,n){return e=je(e),n=n==null?0:jn(he(n),0,e.length),t=yt(t),e.slice(n,n+t.length)==t}function Cm(e,t,n){var r=u.templateSettings;n&&et(e,t,n)&&(t=s),e=je(e),t=bs({},t,r,sl);var o=bs({},t.imports,r.imports,sl),c=We(o),h=ti(o,c),d,m,N=0,T=t.interpolate||Mr,D="__p += '",z=ri((t.escape||Mr).source+"|"+T.source+"|"+(T===Ia?sc:Mr).source+"|"+(t.evaluate||Mr).source+"|$","g"),Z="//# sourceURL="+(Ce.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Mc+"]")+`
`;e.replace(z,function(re,xe,ve,_t,tt,vt){return ve||(ve=_t),D+=e.slice(N,vt).replace(fc,ef),xe&&(d=!0,D+=`' +
__e(`+xe+`) +
'`),tt&&(m=!0,D+=`';
`+tt+`;
__p += '`),ve&&(D+=`' +
((__t = (`+ve+`)) == null ? '' : __t) +
'`),N=vt+re.length,re}),D+=`';
`;var ne=Ce.call(t,"variable")&&t.variable;if(!ne)D=`with (obj) {
`+D+`
}
`;else if(nc.test(ne))throw new ue(C);D=(m?D.replace(Yu,""):D).replace(ku,"$1").replace(Wu,"$1;"),D="function("+(ne||"obj")+`) {
`+(ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(d?", __e = _.escape":"")+(m?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+D+`return __p
}`;var de=Ql(function(){return we(c,Z+"return "+D).apply(s,h)});if(de.source=D,Yi(de))throw de;return de}function Am(e){return je(e).toLowerCase()}function Em(e){return je(e).toUpperCase()}function Nm(e,t,n){if(e=je(e),e&&(n||t===s))return so(e);if(!e||!(t=yt(t)))return e;var r=Ft(e),o=Ft(t),c=io(r,o),h=ao(r,o)+1;return fn(r,c,h).join("")}function Tm(e,t,n){if(e=je(e),e&&(n||t===s))return e.slice(0,lo(e)+1);if(!e||!(t=yt(t)))return e;var r=Ft(e),o=ao(r,Ft(t))+1;return fn(r,0,o).join("")}function Rm(e,t,n){if(e=je(e),e&&(n||t===s))return e.replace(Ys,"");if(!e||!(t=yt(t)))return e;var r=Ft(e),o=io(r,Ft(t));return fn(r,o).join("")}function Pm(e,t){var n=X,r=ee;if(Me(t)){var o="separator"in t?t.separator:o;n="length"in t?he(t.length):n,r="omission"in t?yt(t.omission):r}e=je(e);var c=e.length;if(On(e)){var h=Ft(e);c=h.length}if(n>=c)return e;var d=n-Ln(r);if(d<1)return r;var m=h?fn(h,0,d).join(""):e.slice(0,d);if(o===s)return m+r;if(h&&(d+=m.length-d),ki(o)){if(e.slice(d).search(o)){var N,T=m;for(o.global||(o=ri(o.source,je(Ca.exec(o))+"g")),o.lastIndex=0;N=o.exec(T);)var D=N.index;m=m.slice(0,D===s?d:D)}}else if(e.indexOf(yt(o),d)!=d){var z=m.lastIndexOf(o);z>-1&&(m=m.slice(0,z))}return m+r}function Dm(e){return e=je(e),e&&Uu.test(e)?e.replace(Sa,lf):e}var Mm=qn(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),qi=Zo("toUpperCase");function Kl(e,t,n){return e=je(e),t=n?s:t,t===s?nf(e)?ff(e):Vc(e):e.match(t)||[]}var Ql=pe(function(e,t){try{return gt(e,s,t)}catch(n){return Yi(n)?n:new ue(n)}}),Fm=Zt(function(e,t){return It(t,function(n){n=Wt(n),Kt(e,n,$i(e[n],e))}),e});function Om(e){var t=e==null?0:e.length,n=te();return e=t?Pe(e,function(r){if(typeof r[1]!="function")throw new Ct(_);return[n(r[0]),r[1]]}):[],pe(function(r){for(var o=-1;++o<t;){var c=e[o];if(gt(c[0],this,r))return gt(c[1],this,r)}})}function Lm(e){return lh(Et(e,b))}function zi(e){return function(){return e}}function $m(e,t){return e==null||e!==e?t:e}var Bm=Jo(),Ym=Jo(!0);function ct(e){return e}function Hi(e){return No(typeof e=="function"?e:Et(e,b))}function km(e){return Ro(Et(e,b))}function Wm(e,t){return Po(e,Et(t,b))}var Um=pe(function(e,t){return function(n){return gr(n,e,t)}}),qm=pe(function(e,t){return function(n){return gr(e,n,t)}});function Vi(e,t,n){var r=We(t),o=ns(t,r);n==null&&!(Me(t)&&(o.length||!r.length))&&(n=t,t=e,e=this,o=ns(t,We(t)));var c=!(Me(n)&&"chain"in n)||!!n.chain,h=Jt(e);return It(o,function(d){var m=t[d];e[d]=m,h&&(e.prototype[d]=function(){var N=this.__chain__;if(c||N){var T=e(this.__wrapped__),D=T.__actions__=ot(this.__actions__);return D.push({func:m,args:arguments,thisArg:e}),T.__chain__=N,T}return m.apply(e,sn([this.value()],arguments))})}),e}function zm(){return He._===this&&(He._=yf),this}function Gi(){}function Hm(e){return e=he(e),pe(function(t){return Do(t,e)})}var Vm=Ii(Pe),Gm=Ii(Ja),Km=Ii(Qs);function Zl(e){return Pi(e)?Zs(Wt(e)):Ih(e)}function Qm(e){return function(t){return e==null?s:In(e,t)}}var Zm=tl(),Xm=tl(!0);function Ki(){return[]}function Qi(){return!1}function Jm(){return{}}function ey(){return""}function ty(){return!0}function ny(e,t){if(e=he(e),e<1||e>W)return[];var n=ge,r=Qe(e,ge);t=te(t),e-=ge;for(var o=ei(r,t);++n<e;)t(n);return o}function ry(e){return ce(e)?Pe(e,Wt):xt(e)?[e]:ot(yl(je(e)))}function sy(e){var t=++gf;return je(e)+t}var iy=ls(function(e,t){return e+t},0),ay=Ci("ceil"),oy=ls(function(e,t){return e/t},1),ly=Ci("floor");function uy(e){return e&&e.length?ts(e,ct,fi):s}function cy(e,t){return e&&e.length?ts(e,te(t,2),fi):s}function fy(e){return no(e,ct)}function hy(e,t){return no(e,te(t,2))}function dy(e){return e&&e.length?ts(e,ct,gi):s}function py(e,t){return e&&e.length?ts(e,te(t,2),gi):s}var gy=ls(function(e,t){return e*t},1),my=Ci("round"),yy=ls(function(e,t){return e-t},0);function xy(e){return e&&e.length?Js(e,ct):0}function _y(e,t){return e&&e.length?Js(e,te(t,2)):0}return u.after=kp,u.ary=El,u.assign=Eg,u.assignIn=Wl,u.assignInWith=bs,u.assignWith=Ng,u.at=Tg,u.before=Nl,u.bind=$i,u.bindAll=Fm,u.bindKey=Tl,u.castArray=Jp,u.chain=Il,u.chunk=ld,u.compact=ud,u.concat=cd,u.cond=Om,u.conforms=Lm,u.constant=zi,u.countBy=xp,u.create=Rg,u.curry=Rl,u.curryRight=Pl,u.debounce=Dl,u.defaults=Pg,u.defaultsDeep=Dg,u.defer=Wp,u.delay=Up,u.difference=fd,u.differenceBy=hd,u.differenceWith=dd,u.drop=pd,u.dropRight=gd,u.dropRightWhile=md,u.dropWhile=yd,u.fill=xd,u.filter=vp,u.flatMap=Sp,u.flatMapDeep=jp,u.flatMapDepth=Ip,u.flatten=bl,u.flattenDeep=_d,u.flattenDepth=vd,u.flip=qp,u.flow=Bm,u.flowRight=Ym,u.fromPairs=bd,u.functions=Yg,u.functionsIn=kg,u.groupBy=Cp,u.initial=Sd,u.intersection=jd,u.intersectionBy=Id,u.intersectionWith=Cd,u.invert=Ug,u.invertBy=qg,u.invokeMap=Ep,u.iteratee=Hi,u.keyBy=Np,u.keys=We,u.keysIn=ut,u.map=gs,u.mapKeys=Hg,u.mapValues=Vg,u.matches=km,u.matchesProperty=Wm,u.memoize=ys,u.merge=Gg,u.mergeWith=Ul,u.method=Um,u.methodOf=qm,u.mixin=Vi,u.negate=xs,u.nthArg=Hm,u.omit=Kg,u.omitBy=Qg,u.once=zp,u.orderBy=Tp,u.over=Vm,u.overArgs=Hp,u.overEvery=Gm,u.overSome=Km,u.partial=Bi,u.partialRight=Ml,u.partition=Rp,u.pick=Zg,u.pickBy=ql,u.property=Zl,u.propertyOf=Qm,u.pull=Td,u.pullAll=Sl,u.pullAllBy=Rd,u.pullAllWith=Pd,u.pullAt=Dd,u.range=Zm,u.rangeRight=Xm,u.rearg=Vp,u.reject=Mp,u.remove=Md,u.rest=Gp,u.reverse=Oi,u.sampleSize=Op,u.set=Jg,u.setWith=em,u.shuffle=Lp,u.slice=Fd,u.sortBy=Yp,u.sortedUniq=Wd,u.sortedUniqBy=Ud,u.split=Sm,u.spread=Kp,u.tail=qd,u.take=zd,u.takeRight=Hd,u.takeRightWhile=Vd,u.takeWhile=Gd,u.tap=up,u.throttle=Qp,u.thru=ps,u.toArray=Bl,u.toPairs=zl,u.toPairsIn=Hl,u.toPath=ry,u.toPlainObject=kl,u.transform=tm,u.unary=Zp,u.union=Kd,u.unionBy=Qd,u.unionWith=Zd,u.uniq=Xd,u.uniqBy=Jd,u.uniqWith=ep,u.unset=nm,u.unzip=Li,u.unzipWith=jl,u.update=rm,u.updateWith=sm,u.values=Vn,u.valuesIn=im,u.without=tp,u.words=Kl,u.wrap=Xp,u.xor=np,u.xorBy=rp,u.xorWith=sp,u.zip=ip,u.zipObject=ap,u.zipObjectDeep=op,u.zipWith=lp,u.entries=zl,u.entriesIn=Hl,u.extend=Wl,u.extendWith=bs,Vi(u,u),u.add=iy,u.attempt=Ql,u.camelCase=um,u.capitalize=Vl,u.ceil=ay,u.clamp=am,u.clone=eg,u.cloneDeep=ng,u.cloneDeepWith=rg,u.cloneWith=tg,u.conformsTo=sg,u.deburr=Gl,u.defaultTo=$m,u.divide=oy,u.endsWith=cm,u.eq=Lt,u.escape=fm,u.escapeRegExp=hm,u.every=_p,u.find=bp,u.findIndex=_l,u.findKey=Mg,u.findLast=wp,u.findLastIndex=vl,u.findLastKey=Fg,u.floor=ly,u.forEach=Cl,u.forEachRight=Al,u.forIn=Og,u.forInRight=Lg,u.forOwn=$g,u.forOwnRight=Bg,u.get=Wi,u.gt=ig,u.gte=ag,u.has=Wg,u.hasIn=Ui,u.head=wl,u.identity=ct,u.includes=Ap,u.indexOf=wd,u.inRange=om,u.invoke=zg,u.isArguments=En,u.isArray=ce,u.isArrayBuffer=og,u.isArrayLike=lt,u.isArrayLikeObject=Oe,u.isBoolean=lg,u.isBuffer=hn,u.isDate=ug,u.isElement=cg,u.isEmpty=fg,u.isEqual=hg,u.isEqualWith=dg,u.isError=Yi,u.isFinite=pg,u.isFunction=Jt,u.isInteger=Fl,u.isLength=_s,u.isMap=Ol,u.isMatch=gg,u.isMatchWith=mg,u.isNaN=yg,u.isNative=xg,u.isNil=vg,u.isNull=_g,u.isNumber=Ll,u.isObject=Me,u.isObjectLike=Fe,u.isPlainObject=br,u.isRegExp=ki,u.isSafeInteger=bg,u.isSet=$l,u.isString=vs,u.isSymbol=xt,u.isTypedArray=Hn,u.isUndefined=wg,u.isWeakMap=Sg,u.isWeakSet=jg,u.join=Ad,u.kebabCase=dm,u.last=Tt,u.lastIndexOf=Ed,u.lowerCase=pm,u.lowerFirst=gm,u.lt=Ig,u.lte=Cg,u.max=uy,u.maxBy=cy,u.mean=fy,u.meanBy=hy,u.min=dy,u.minBy=py,u.stubArray=Ki,u.stubFalse=Qi,u.stubObject=Jm,u.stubString=ey,u.stubTrue=ty,u.multiply=gy,u.nth=Nd,u.noConflict=zm,u.noop=Gi,u.now=ms,u.pad=mm,u.padEnd=ym,u.padStart=xm,u.parseInt=_m,u.random=lm,u.reduce=Pp,u.reduceRight=Dp,u.repeat=vm,u.replace=bm,u.result=Xg,u.round=my,u.runInContext=g,u.sample=Fp,u.size=$p,u.snakeCase=wm,u.some=Bp,u.sortedIndex=Od,u.sortedIndexBy=Ld,u.sortedIndexOf=$d,u.sortedLastIndex=Bd,u.sortedLastIndexBy=Yd,u.sortedLastIndexOf=kd,u.startCase=jm,u.startsWith=Im,u.subtract=yy,u.sum=xy,u.sumBy=_y,u.template=Cm,u.times=ny,u.toFinite=en,u.toInteger=he,u.toLength=Yl,u.toLower=Am,u.toNumber=Rt,u.toSafeInteger=Ag,u.toString=je,u.toUpper=Em,u.trim=Nm,u.trimEnd=Tm,u.trimStart=Rm,u.truncate=Pm,u.unescape=Dm,u.uniqueId=sy,u.upperCase=Mm,u.upperFirst=qi,u.each=Cl,u.eachRight=Al,u.first=wl,Vi(u,function(){var e={};return Yt(u,function(t,n){Ce.call(u.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),u.VERSION=f,It(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){u[e].placeholder=u}),It(["drop","take"],function(e,t){_e.prototype[e]=function(n){n=n===s?1:ke(he(n),0);var r=this.__filtered__&&!t?new _e(this):this.clone();return r.__filtered__?r.__takeCount__=Qe(n,r.__takeCount__):r.__views__.push({size:Qe(n,ge),type:e+(r.__dir__<0?"Right":"")}),r},_e.prototype[e+"Right"]=function(n){return this.reverse()[e](n).reverse()}}),It(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==H||n==U;_e.prototype[e]=function(o){var c=this.clone();return c.__iteratees__.push({iteratee:te(o,3),type:n}),c.__filtered__=c.__filtered__||r,c}}),It(["head","last"],function(e,t){var n="take"+(t?"Right":"");_e.prototype[e]=function(){return this[n](1).value()[0]}}),It(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");_e.prototype[e]=function(){return this.__filtered__?new _e(this):this[n](1)}}),_e.prototype.compact=function(){return this.filter(ct)},_e.prototype.find=function(e){return this.filter(e).head()},_e.prototype.findLast=function(e){return this.reverse().find(e)},_e.prototype.invokeMap=pe(function(e,t){return typeof e=="function"?new _e(this):this.map(function(n){return gr(n,e,t)})}),_e.prototype.reject=function(e){return this.filter(xs(te(e)))},_e.prototype.slice=function(e,t){e=he(e);var n=this;return n.__filtered__&&(e>0||t<0)?new _e(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==s&&(t=he(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},_e.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},_e.prototype.toArray=function(){return this.take(ge)},Yt(_e.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=u[r?"take"+(t=="last"?"Right":""):t],c=r||/^find/.test(t);o&&(u.prototype[t]=function(){var h=this.__wrapped__,d=r?[1]:arguments,m=h instanceof _e,N=d[0],T=m||ce(h),D=function(xe){var ve=o.apply(u,sn([xe],d));return r&&z?ve[0]:ve};T&&n&&typeof N=="function"&&N.length!=1&&(m=T=!1);var z=this.__chain__,Z=!!this.__actions__.length,ne=c&&!z,de=m&&!Z;if(!c&&T){h=de?h:new _e(this);var re=e.apply(h,d);return re.__actions__.push({func:ps,args:[D],thisArg:s}),new At(re,z)}return ne&&de?e.apply(this,d):(re=this.thru(D),ne?r?re.value()[0]:re.value():re)})}),It(["pop","push","shift","sort","splice","unshift"],function(e){var t=Yr[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);u.prototype[e]=function(){var o=arguments;if(r&&!this.__chain__){var c=this.value();return t.apply(ce(c)?c:[],o)}return this[n](function(h){return t.apply(ce(h)?h:[],o)})}}),Yt(_e.prototype,function(e,t){var n=u[t];if(n){var r=n.name+"";Ce.call(kn,r)||(kn[r]=[]),kn[r].push({name:t,func:n})}}),kn[os(s,j).name]=[{name:"wrapper",func:s}],_e.prototype.clone=Df,_e.prototype.reverse=Mf,_e.prototype.value=Ff,u.prototype.at=cp,u.prototype.chain=fp,u.prototype.commit=hp,u.prototype.next=dp,u.prototype.plant=gp,u.prototype.reverse=mp,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=yp,u.prototype.first=u.prototype.head,lr&&(u.prototype[lr]=pp),u},$n=hf();vn?((vn.exports=$n)._=$n,Hs._=$n):He._=$n}).call(gx)}(Cr,Cr.exports)),Cr.exports}var yx=mx();const xx=(a="")=>{const[l,s]=L.useState(a),[f,p]=L.useState(!1),y=async E=>{if(!E)return{data:[]};console.log("Fetching customers with term:",E);try{const b=await wt.get("/customers",{params:{populate:"*",filters:{name:{$containsi:E}},pagination:{pageSize:20},sort:["name:asc"]}});return console.log("API Response:",b.data),b.data}catch(b){throw console.error("API Error:",b),b}},{data:_,isLoading:C,error:A}=Hy({queryKey:["customers",l],queryFn:()=>y(l),enabled:l.length>=1,staleTime:1e3*60*5,cacheTime:1e3*60*30}),P=L.useCallback(yx.debounce(E=>{console.log("Debounced search term:",E),s(E)},300),[]);return{searchTerm:l,setSearchTerm:P,isComposing:f,setIsComposing:p,results:(_==null?void 0:_.data)||[],isLoading:C,error:A}},Tr=({onSelect:a,placeholder:l="고객사를 입력하세요",initialValue:s="",disabled:f=!1,required:p=!1,error:y=null,className:_="",size:C="default",...A})=>{const{setSearchTerm:P,isComposing:E,setIsComposing:b,results:R,isLoading:x,error:S}=xx(s),[F,w]=L.useState(!1),[j,K]=L.useState(s),$=L.useRef(null);L.useEffect(()=>{const M=V=>{$.current&&!$.current.contains(V.target)&&w(!1)};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]);const le=M=>{const V=M.target.value;K(V),V?(P(V),w(!0)):w(!1)},fe=M=>{K(M.name),a(M),w(!1)},Se={small:"h-9 text-sm",default:"h-10 text-base",large:"h-11 text-lg"};return i.jsxs("div",{ref:$,className:`relative w-full ${_}`,children:[i.jsx(it,{...A,type:"text",value:j,onChange:le,onCompositionStart:()=>b(!0),onCompositionEnd:M=>{b(!1),P(M.target.value)},onFocus:()=>j&&w(!0),placeholder:l,disabled:f,required:p,error:y,className:`w-full ${Se[C]||Se.default} 
          ${F?"rounded-b-none border-b-0":""}`}),y&&i.jsx(oa,{type:"error",children:y}),F&&i.jsxs("div",{className:"absolute z-50 w-full bg-white border border-gray-200 border-t-0 rounded-b-md shadow-lg",children:[x&&i.jsx("div",{className:"p-3 text-sm text-gray-600 bg-gray-50",children:"검색중..."}),!x&&S&&i.jsx("div",{className:"p-3 text-sm text-red-700 bg-red-50",children:"검색 중 오류가 발생했습니다. 다시 시도해 주세요."}),!x&&!S&&R.length>0&&i.jsx("ul",{className:"max-h-60 overflow-y-auto",children:R.map(M=>i.jsxs("li",{onClick:()=>fe(M),className:"px-3 py-2 hover:bg-gray-50 cursor-pointer",children:[i.jsx("div",{className:"text-sm text-gray-700",children:M.name}),M.code&&i.jsxs("div",{className:"text-xs text-gray-500",children:["코드: ",M.code]})]},M.id))}),!x&&!S&&R.length===0&&j&&i.jsx("div",{className:"p-3 text-center text-sm text-gray-500",children:"검색 결과가 없습니다."})]})]})},_x=a=>{const l=a.replace(/[^\d]/g,"");return l===""||!isNaN(l)?l:""},Qn=a=>a?Number(a).toLocaleString():"",Mu=()=>{const[a,l]=L.useState([]),[s,f]=L.useState(!1),[p,y]=L.useState(null),_=async()=>{f(!0),y(null);try{const C=await Zn.getTeams();l(C)}catch(C){console.error("Failed to fetch teams:",C),y(C),l([])}finally{f(!1)}};return L.useEffect(()=>{_()},[]),{data:a,isLoading:s,error:p,refetch:_}},vx=({items:a=[],onChange:l,onRemove:s,isSubmitting:f,errors:p={},itemsData:y,isItemsLoading:_})=>{const{data:C,isLoading:A}=Mu();if(console.log(">>> itemsData ",y),console.log(">>> teamsData ",C),!(a!=null&&a.length))return null;const P=(E,b)=>p[`salesItems.${E}.${b}`];return i.jsx("div",{className:"space-y-4 px-5",children:a.map((E,b)=>{var R,x;return i.jsx("div",{className:"space-y-2",children:i.jsxs("div",{className:"grid grid-cols-[3fr,3fr,2fr,40px] gap-3 items-start",children:[i.jsxs(dt,{value:E.itemId||"",onChange:S=>{var j;const F=S.target.value,w=(j=y==null?void 0:y.data)==null?void 0:j.find(K=>K.id===parseInt(F));console.log(`***** : ${w}`),w&&l(b,{itemId:w.id,itemName:w.name})},disabled:f,className:P(b,"itemName")?"border-red-300":"",children:[i.jsx("option",{value:"",children:"매출품목 선택"}),(R=y==null?void 0:y.data)==null?void 0:R.map(S=>i.jsx("option",{value:S.id,children:S.name},S.id))]}),i.jsxs(dt,{value:E.teamId||"",onChange:S=>{var j;const F=S.target.value,w=(j=C==null?void 0:C.data)==null?void 0:j.find(K=>K.id===parseInt(F));console.log(`***** : ${w}`),w&&l(b,{teamId:w.id,teamName:w.name})},disabled:f,className:P(b,"teamName")?"border-red-300":"",children:[i.jsx("option",{value:"",children:"사업부 선택"}),(x=C==null?void 0:C.data)==null?void 0:x.map(S=>i.jsx("option",{value:S.id,children:S.name},S.id))]}),i.jsx(it,{type:"text",value:Qn(E.amount),onChange:S=>{const F=_x(S.target.value);l(b,"amount",F)},placeholder:"금액",disabled:f,className:`text-right ${P(b,"amount")?"border-red-300":""}`}),i.jsx("button",{type:"button",onClick:()=>s(b),disabled:f,className:`flex items-center justify-center p-2 rounded hover:bg-gray-100 transition-colors
                ${f?"opacity-50 cursor-not-allowed":"opacity-100"}`,children:i.jsx(Ru,{size:20,className:"text-gray-500"})})]})},b)})})},Fu=a=>{const[l,s]=L.useState({}),[f,p]=L.useState(!1),[y,_]=L.useState(null),C=async()=>{p(!0),_(null);try{const P=(await Promise.all(a.map(E=>Zn.getCodebook(E)))).reduce((E,b,R)=>(E[a[R]]=b.data,E),{});s(P)}catch(A){console.error("Failed to fetch codebook data:",A),_(A);const P=a.reduce((E,b)=>(E[b]=[],E),{});s(P)}finally{p(!1)}};return L.useEffect(()=>{C()},[JSON.stringify(a)]),{data:l,isLoading:f,error:y,refetch:C}},ba=({payments:a=[],onChange:l,onRemove:s,isSubmitting:f})=>{const[p,y]=L.useState({}),_=L.useRef(!1);L.useState({}),L.useRef([]);const{data:C,isLoading:A,error:P}=Fu(["re_payment_method","sfa_percentage"]);L.useEffect(()=>{_.current||a.forEach((x,S)=>{const F=Number(x.amount)||0,w=Number(x.marginProfitValue)||0,j=x.isProfit?w:F*w/100;j!==Number(x.profitAmount)&&l(S,"profitAmount",j.toString())})},[a,l]);const E=(x,S)=>{const F=S.replace(/[^\d,]/g,"");y(j=>({...j,[x]:F}));const w=F.replace(/,/g,"");w!==a[x].amount&&(_.current=!0,l(x,"amount",w),setTimeout(()=>{_.current=!1},0))},b=(x,S,F)=>{if(["amount","marginProfitValue","isProfit"].includes(S)){const w=a[x],j=Number(S==="amount"?F:w.amount)||0,K=Number(S==="marginProfitValue"?F:w.marginProfitValue)||0,$=S==="isProfit"?F:w.isProfit;_.current=!0,l(x,S,F);const le=$?K:j*K/100;l(x,"profitAmount",le.toString()),setTimeout(()=>{_.current=!1},0)}else l(x,S,F)},R=(x,S)=>{_.current=!0,l(x,"isConfirmed",S),S&&l(x,"probability","100"),setTimeout(()=>{_.current=!1},0)};return a!=null&&a.length?i.jsx("div",{className:"flex flex-col gap-6 px-5",children:a.map((x,S)=>{var F,w,j,K;return i.jsxs("div",{className:"flex flex-col gap-3 p-4 bg-gray-50 rounded-md",children:[i.jsxs("div",{className:"grid grid-cols-[1.5fr,0.8fr,1fr,1fr,auto,0.5fr,1fr] gap-3 items-center",children:[i.jsxs(dt,{value:x.billingType,onChange:$=>l(S,"billingType",$.target.value),disabled:f||A,required:!0,children:[i.jsx("option",{value:"",children:"결제구분 선택"}),(w=(F=C==null?void 0:C.re_payment_method)==null?void 0:F.data)==null?void 0:w.map($=>i.jsx("option",{value:$.code,children:$.name},$.id))]}),i.jsxs("label",{className:"flex items-center gap-1",children:[i.jsx(ma,{checked:x.isConfirmed,onChange:$=>R(S,$.target.checked),disabled:f,className:"w-4 h-4"}),i.jsx("span",{children:"확정여부"})]}),i.jsxs(dt,{value:x.probability,onChange:$=>l(S,"probability",$.target.value),disabled:f||A||x.isConfirmed,children:[i.jsx("option",{value:"",children:"매출확률 선택"}),(K=(j=C==null?void 0:C.sfa_percentage)==null?void 0:j.data)==null?void 0:K.map($=>i.jsx("option",{value:$.code,children:$.name},$.id))]}),i.jsx(it,{type:"text",value:p[S]||Qn(x.amount||""),onChange:$=>E(S,$.target.value),placeholder:"매출액",disabled:f,className:"text-right"}),i.jsx("div",{className:"flex items-center justify-center",children:i.jsx(ya,{checked:x.isProfit,onChange:()=>b(S,"isProfit",!x.isProfit),disabled:f})}),i.jsx("div",{className:"text-center",children:x.isProfit?"이익":"마진"}),i.jsx(it,{type:"number",value:x.marginProfitValue,onChange:$=>b(S,"marginProfitValue",$.target.value),disabled:f})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-xs text-gray-500 mb-1",children:"매출인식일자"}),i.jsx(it,{type:"date",value:x.recognitionDate,onChange:$=>l(S,"recognitionDate",$.target.value),disabled:f})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-xs text-gray-500 mb-1",children:"결제일자"}),i.jsx(it,{type:"date",value:x.scheduledDate,onChange:$=>l(S,"scheduledDate",$.target.value),disabled:f})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-xs text-gray-500 mb-1",children:"메모"}),i.jsx(it,{type:"text",value:x.memo,onChange:$=>l(S,"memo",$.target.value),disabled:f})]}),i.jsxs("div",{className:"grid grid-cols-[1fr,auto] gap-2 items-end",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-xs text-gray-500 mb-1",children:"매출이익"}),i.jsx(it,{type:"text",value:Math.round(x.profitAmount),readOnly:!0,disabled:!0,className:"bg-gray-100 text-right"})]}),i.jsx("button",{type:"button",onClick:()=>s(S),className:"h-9 flex items-center justify-center",children:i.jsx(Ru,{size:20,className:"text-gray-500 cursor-pointer"})})]})]})]},x.id)})}):null},bx=({sfaSalesTypeData:a,sfaClassificationData:l})=>{var Xe,H;const{formData:s,errors:f,isSubmitting:p,updateFormField:y,handleAddSalesItem:_,handleRemoveSalesItem:C,handleSalesItemChange:A,handleAddPayment:P,handleRemovePayment:E,handlePaymentChange:b,handleCustomerSelect:R,isItemsLoading:x,itemsData:S,paymentData:F,percentageData:w,isPaymentDataLoading:j,validateForm:K,checkAmounts:$,processSubmit:le}=Es(),[fe,Se]=L.useState(!1),[M,V]=L.useState(!1),[k,X]=L.useState(!1),ee=async O=>{O.preventDefault(),K(fe)&&($()?await le(fe,M):X(!0))},Ae=()=>i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-base",children:"사업부매출금액과 결제매출금액이 일치하지 않습니다."}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("p",{children:["• 사업부매출금액: ",Qn(s.itemAmount),"원"]}),i.jsxs("p",{children:["• 결제매출금액: ",Qn(s.paymentAmount),"원"]})]}),i.jsx("p",{className:"text-gray-600",children:"금액이 다르더라도 진행하시겠습니까?"})]});return i.jsxs(i.Fragment,{children:[i.jsxs(As,{onSubmit:ee,className:"space-y-6",method:"POST",action:"#",children:[i.jsxs(bt,{direction:"horizontal",className:"gap-6",children:[i.jsxs(Ue,{className:"flex-1",children:[i.jsx(qe,{required:!0,children:"매출유형"}),i.jsxs(dt,{name:"sfaSalesType",value:s.sfaSalesType,onChange:y,disabled:p,error:f.sfaSalesType,children:[i.jsx("option",{value:"",children:"선택하세요"}),(Xe=a==null?void 0:a.data)==null?void 0:Xe.map(O=>i.jsx("option",{value:O.id,children:O.name},O.id))]})]}),i.jsxs(Ue,{className:"flex-1",children:[i.jsx(qe,{required:!0,children:"매출구분"}),i.jsxs(dt,{name:"sfaClassification",value:s.sfaClassification,onChange:y,disabled:p,error:f.sfaClassification,children:[i.jsx("option",{value:"",children:"선택하세요"}),(H=l==null?void 0:l.data)==null?void 0:H.map(O=>i.jsx("option",{value:O.id,children:O.name},O.id))]})]})]}),i.jsxs(bt,{direction:"horizontal",className:"gap-6",children:[i.jsxs(Ue,{className:"flex-1",children:[i.jsx(qe,{required:!0,children:"고객사"}),i.jsx(Tr,{onSelect:R,value:s.customer,error:f.customer,disabled:p,size:"small"})]}),i.jsxs(Ue,{className:"flex-1",children:[i.jsx(qe,{children:"매출파트너"}),i.jsxs(bt,{direction:"horizontal",children:[i.jsx(ma,{id:"hasPartner",checked:fe,onChange:O=>Se(O.target.checked),disabled:p}),fe&&i.jsx(Tr,{name:"sellingPartner",onSelect:O=>y({target:{name:"sellingPartner",value:O.id}}),value:s.SellingPrtner,disabled:p,size:"small"})]})]})]}),i.jsxs(bt,{direction:"horizontal",className:"gap-6",children:[i.jsxs(Ue,{className:"flex-1",children:[i.jsx(qe,{required:!0,children:"건명"}),i.jsx(it,{type:"text",name:"name",value:s.name,onChange:y,placeholder:"건명을 입력하세요",disabled:p})]}),i.jsxs(Ue,{className:"flex-1",children:[i.jsx(qe,{children:"프로젝트"}),i.jsx(ya,{checked:M,onChange:()=>V(!M),disabled:p})]})]}),i.jsxs(bt,{direction:"horizontal",className:"gap-6",children:[i.jsxs(Ue,{className:"flex-1",children:[i.jsx(qe,{children:"사업부 매출"}),i.jsxs(Ar,{children:[i.jsx(De,{type:"button",variant:"primary",onClick:_,disabled:p||s.salesByItems.length>=3,className:`w-full ${s.salesByItems.length>=3?"bg-gray-200 hover:bg-gray-200 text-gray-500 border-gray-200":""}`,children:"사업부매출등록"}),i.jsx(it,{type:"text",name:"itemAmount",value:Qn(s.itemAmount),disabled:!0,className:"text-right"})]}),f.itemAmount&&i.jsx(oa,{type:"error",children:f.itemAmount})]}),i.jsxs(Ue,{className:"flex-1",children:[i.jsx(qe,{children:"결제 매출"}),i.jsxs(Ar,{children:[i.jsx(De,{type:"button",variant:"primary",onClick:P,disabled:p||s.salesByPayments.length>=3,className:`w-full ${s.salesByPayments.length>=3?"bg-gray-200 hover:bg-gray-200 text-gray-500 border-gray-200":""}`,children:"결제매출등록"}),i.jsx(it,{type:"text",name:"paymentAmount",value:Qn(s.paymentAmount),disabled:!0,className:"text-right"})]}),f.paymentAmount&&i.jsx(oa,{type:"error",children:f.paymentAmount})]})]}),i.jsx("div",{className:"w-full h-px bg-gray-200 my-6"}),i.jsx(vx,{items:s.salesByItems,onChange:A,onRemove:C,isSubmitting:p,errors:f,itemsData:S,isItemsLoading:x}),i.jsx("div",{className:"w-full h-px bg-gray-200 my-6"}),i.jsx(ba,{payments:s.salesByPayments,onChange:b,onRemove:E,isSubmitting:p,paymentData:F,percentageData:w,isPaymentDataLoading:j}),i.jsx(bt,{children:i.jsxs(Ue,{fullWidth:!0,children:[i.jsx(qe,{children:"비고"}),i.jsx(Ey,{name:"description",value:s.description,onChange:y,placeholder:"비고 사항을 입력하세요",disabled:p})]})}),i.jsx(bt,{children:i.jsx(De,{type:"submit",variant:"primary",disabled:p,className:"w-full",onClick:O=>{O.preventDefault(),ee(O)},children:p?"처리중...":"저장"})})]}),i.jsx(Ty,{isOpen:k,onClose:()=>X(!1),title:"금액 불일치 확인",size:"md",footer:i.jsxs(i.Fragment,{children:[i.jsx(De,{variant:"outline",onClick:()=>X(!1),children:"아니오"}),i.jsx(De,{variant:"primary",onClick:async()=>{X(!1),await le(fe,M)},children:"예"})]}),children:i.jsx(Ae,{})})]})},wx=({data:a})=>{var s,f,p,y,_;if(!a)return null;const l=((s=a.sfa_item_price)==null?void 0:s.map(C=>`${C.sfa_item_name}${C.team_name?` (${C.team_name})`:""}`).join(", "))||"-";return i.jsxs(Su,{children:[i.jsxs(ht,{equalItems:!0,children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"건명"}),i.jsx(oe,{children:a.name||"-"})]}),i.jsxs(ht,{equalItems:!0,children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"고객사/매출처"}),i.jsxs(oe,{children:[(f=a.customer)==null?void 0:f.name,a.selling_partner&&`/${a.selling_partner.name}`]}),i.jsx(oe,{label:!0,width:"w-[140px]",children:"매출유형"}),i.jsx(oe,{children:((p=a.sfa_sales_type)==null?void 0:p.name)||"-"})]}),i.jsxs(ht,{equalItems:!0,children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"매출구분"}),i.jsx(oe,{children:((y=a.sfa_classification)==null?void 0:y.name)||"-"}),i.jsx(oe,{label:!0,width:"w-[140px]",children:"프로젝트여부"}),i.jsx(oe,{children:a.is_project?"YES":"NO"})]}),i.jsxs(ht,{equalItems:!0,children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"결제 매출/이익"}),i.jsx(oe,{children:typeof a.total_price=="number"?a.total_price.toLocaleString():"-"}),i.jsx(oe,{label:!0,width:"w-[140px]",children:"사업부 매출"}),i.jsx(oe,{children:typeof a.sales_profit=="number"?a.sales_profit.toLocaleString():"-"})]}),i.jsxs(ht,{equalItems:!0,children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"매출확정여부"}),i.jsx(oe,{children:a.confirmed?"YES":"NO"}),i.jsx(oe,{label:!0,width:"w-[140px]",children:"지원프로그램"}),i.jsx(oe,{grow:!0,children:((_=a.proposal)==null?void 0:_.name)||"-"})]}),i.jsxs(ht,{children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"매출품목"}),i.jsx(oe,{children:l})]}),i.jsxs(ht,{children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"비고"}),i.jsx(oe,{className:"flex-1",children:a.description||"-"})]})]})},Sx=(a,l)=>{var s;return l!=null&&l.hasOwnProperty(a)?["customer","sfa_sales_type","sfa_classification","selling_partner"].includes(a)?((s=l[a])==null?void 0:s.id)??null:l[a]:null},jx=a=>{const{setDrawer:l}=xn(),[s,f]=L.useState({editField:null,currentValue:null,newValue:null}),[p,y]=L.useState({isEnabled:(a==null?void 0:a.has_partner)||!1,pendingState:(a==null?void 0:a.has_partner)||!1}),_=R=>{const x=Sx(R,a);f({editField:R,currentValue:x,newValue:x})};L.useEffect(()=>{console.log("editState Changed:",{value:s.newValue})},[s]);const C=()=>{f({editField:null,currentValue:null,newValue:null})},A=async(R,x)=>{const{currentValue:S,newValue:F}=s,{isEnabled:w,pendingState:j}=p;!w&&j&&F?await mn.updateSfaBase(R,{...x,has_partner:!0}):w&&j&&S!==F?await mn.updateSfaBase(R,x):w&&!j?await mn.updateSfaBase(R,{has_partner:!1,selling_partner:null}):console.warn("Invalid partner update case:",{partnerState:p,editState:s,formData:x})},P=L.useCallback(async()=>{const{editField:R,currentValue:x,newValue:S}=s;if(!R)return;if(S===null||S===""){console.log(">>> newValue...null or 값 없음");return}const F=a.documentId,w={[R]:S};try{if(console.log("[SFA Edit]",{field:R,before:x,after:S}),R==="selling_partner"){await A(F,w),f({editField:null,currentValue:null,newValue:null});const j=await Nr.getSfaDetail(a.id);l({controlMode:"view",data:j.data[0]})}else{if(x!==S)await mn.updateSfaBase(F,w);else{console.log(">>> 기존 - 현재 값 동일");return}f({editField:null,currentValue:null,newValue:null});const j=await Nr.getSfaDetail(a.id);l({controlMode:"view",data:j.data[0]})}}catch(j){throw console.error("[SFA Edit] Save Error:",j),j}},[s,p]);return{editState:s,partnerState:p,startEditing:_,saveEditing:P,cancelEditing:C,handleValueChange:R=>{var S,F;console.log(`>>> handleValueChange >>> : ${R.target.value}`);const x=((S=R.target)==null?void 0:S.type)==="select-one"?R.target.value===""?null:Number(R.target.value):(((F=R.target)==null?void 0:F.type)==="customer-search",R.target.value);x===null||typeof x=="string"&&x.replace(/^\s+/,""),f(w=>({...w,newValue:x}))},handlePartnerStateChange:R=>{const x=R.target.checked;y(S=>({...S,pendingState:x})),console.log(`>>> handlepartnerStateChange >>> : ${x}`)}}},Ix=({data:a,featureMode:l,sfaSalesTypeData:s,sfaClassificationData:f})=>{var F,w,j,K,$,le,fe,Se;const{editState:p,partnerState:y,startEditing:_,saveEditing:C,cancelEditing:A,handleValueChange:P,handlePartnerStateChange:E}=jx(a),{editField:b}=p;console.log(`**** EditableSfaDetail's Data : ${a.documentId}`);const R={name:{type:"text",label:"건명",value:a==null?void 0:a.name,getValue:M=>(M==null?void 0:M.name)||"",editable:!0},sfa_sales_type:{type:"select",label:"매출유형",value:(F=a==null?void 0:a.sfa_sales_type)==null?void 0:F.id,getValue:M=>{var V;return((V=M==null?void 0:M.sfa_sales_type)==null?void 0:V.id)||""},getDisplayValue:M=>{var V;return((V=M==null?void 0:M.sfa_sales_type)==null?void 0:V.name)||"-"},editable:!0},sfa_classification:{type:"select",label:"매출구분",value:(w=a==null?void 0:a.sfa_classification)==null?void 0:w.id,getValue:M=>{var V;return((V=M==null?void 0:M.sfa_classification)==null?void 0:V.id)||""},getDisplayValue:M=>{var V;return((V=M==null?void 0:M.sfa_classification)==null?void 0:V.name)||"-"},editable:!0},customer:{type:"customer",label:"고객사",value:(j=a==null?void 0:a.customer)==null?void 0:j.id,getValue:M=>{var V;return((V=M==null?void 0:M.customer)==null?void 0:V.id)||""},getDisplayValue:M=>{var V;return((V=M==null?void 0:M.customer)==null?void 0:V.name)||"-"},editable:!0},is_project:{type:"switch",label:"프로젝트여부",value:a==null?void 0:a.is_project,getValue:M=>(M==null?void 0:M.is_project)||!1,getDisplayValue:M=>M!=null&&M.is_project?"YES":"NO",editable:!0},description:{type:"text",label:"비고",value:a==null?void 0:a.description,getValue:M=>(M==null?void 0:M.description)||"",editable:!0}},x=()=>i.jsxs("div",{className:"flex shrink-0 items-center gap-0.5",children:[i.jsx("button",{type:"button",onClick:()=>C(),className:"flex items-center justify-center h-7 w-7 rounded-sm hover:bg-green-100",children:i.jsx(dx,{className:"h-4 w-4 text-green-600",strokeWidth:2.5})}),i.jsx("button",{type:"button",onClick:A,className:"flex items-center justify-center h-7 w-7 rounded-sm hover:bg-red-100",children:i.jsx(Pu,{className:"h-4 w-4 text-red-600",strokeWidth:2.5})})]}),S=(M,V)=>{var ee,Ae,Xe;const k=b===M;if(M==="selling_partner")return i.jsx("div",{className:"group relative flex items-center justify-between w-full h-8",children:k?i.jsxs("div",{className:"flex items-center w-full gap-1",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-grow",children:[i.jsx(ma,{id:"has_partner",checked:y.pendingState,onChange:H=>E(H)}),i.jsx(Tr,{value:p.newValue,onSelect:H=>{P({target:{value:H.id,type:"customer-search",name:H.name}})},disabled:!y.pendingState,size:"small"})]}),x()]}):i.jsxs("div",{className:"flex items-center w-full h-8",children:[i.jsx("span",{className:"flex-grow truncate",children:y.isEnabled?((ee=a==null?void 0:a.selling_partner)==null?void 0:ee.name)||"-":"NO"}),i.jsx("button",{type:"button",onClick:()=>_(M),className:`invisible group-hover:visible flex items-center justify-center \r
                         h-7 w-7 rounded-sm hover:bg-blue-100`,children:i.jsx(sa,{className:"h-4 w-4 text-blue-600",strokeWidth:2.5})})]})});if(M==="is_project")return i.jsx("div",{className:"group relative flex items-center justify-between w-full h-8",children:k?i.jsxs("div",{className:"flex items-center w-full gap-1",children:[i.jsx("div",{className:"flex-grow",children:i.jsx(ya,{checked:p.newValue,onChange:()=>P({target:{value:!p.newValue,type:"switch"}})})}),x()]}):i.jsxs("div",{className:"flex items-center w-full h-8",children:[i.jsx("span",{className:"flex-grow truncate",children:a!=null&&a.is_project?"YES":"NO"}),i.jsx("button",{type:"button",onClick:()=>_(M),className:`invisible group-hover:visible flex items-center justify-center \r
                           h-7 w-7 rounded-sm hover:bg-blue-100`,children:i.jsx(sa,{className:"h-4 w-4 text-blue-600",strokeWidth:2.5})})]})});const X=R[M];return X!=null&&X.editable?i.jsx("div",{className:"group relative flex items-center justify-between w-full h-8",children:k?i.jsxs("div",{className:"flex items-center w-full gap-1",children:[i.jsx("div",{className:"flex-grow",children:X.type==="select"&&X.label==="매출유형"?i.jsxs(dt,{value:p.newValue,onChange:P,className:"w-full h-8 text-sm",children:[i.jsx("option",{value:"",children:"선택하세요"}),(Ae=s==null?void 0:s.data)==null?void 0:Ae.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]}):X.type==="select"&&X.label==="매출구분"?i.jsxs(dt,{value:p.newValue,onChange:P,className:"w-full h-8 text-sm",children:[i.jsx("option",{value:"",children:"선택하세요"}),(Xe=f==null?void 0:f.data)==null?void 0:Xe.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]}):X.type==="customer"?i.jsx(Tr,{value:p.newValue,onSelect:H=>{P({target:{value:H.id,type:"customer-search",name:H.name}})},size:"small"}):i.jsx(it,{type:"text",value:p.newValue,onChange:P,className:"w-full h-8 text-sm"})}),x()]}):i.jsxs("div",{className:"flex items-center w-full h-8",children:[i.jsx("span",{className:"flex-grow truncate",children:V}),i.jsx("button",{type:"button",onClick:()=>_(M,R),className:`invisible group-hover:visible flex items-center justify-center \r
                          h-7 w-7 rounded-sm hover:bg-blue-100`,children:i.jsx(sa,{className:"h-4 w-4 text-blue-600",strokeWidth:2.5})})]})}):V};return i.jsxs(Su,{className:"text-sm",children:[i.jsxs(ht,{equalItems:!0,children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"건명"}),i.jsx(oe,{className:"px-0.5",children:l!=="editBase"?a.name||"-":S("name",a.name||"-")}),i.jsx(oe,{label:!0,width:"w-[140px]",children:"매출유형"}),i.jsx(oe,{className:"px-0.5",children:l!=="editBase"?((K=a.sfa_sales_type)==null?void 0:K.name)||"-":S("sfa_sales_type",R.sfa_sales_type.getDisplayValue(a))})]}),i.jsxs(ht,{equalItems:!0,children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"고객사"}),i.jsx(oe,{className:"px-0.5",children:l!=="editBase"?($=a.customer)==null?void 0:$.name:S("customer",R.customer.getDisplayValue(a))}),i.jsx(oe,{label:!0,width:"w-[140px]",children:"매출파트너"}),i.jsx(oe,{className:"px-0.5",children:l!=="editBase"?((le=a.selling_partner)==null?void 0:le.name)||"-":S("selling_partner",null)})]}),i.jsxs(ht,{equalItems:!0,children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"프로젝트여부"}),i.jsx(oe,{className:"px-0.5",children:l!=="editBase"?a.is_project?"YES":"NO":S("is_project",null)}),i.jsx(oe,{label:!0,width:"w-[140px]",children:"매출구분"}),i.jsx(oe,{children:((fe=a.sfa_classification)==null?void 0:fe.name)||"-"})]}),i.jsxs(ht,{equalItems:!0,children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"결제 매출/이익"}),i.jsx(oe,{children:typeof a.total_price=="number"?a.total_price.toLocaleString():"-"}),i.jsx(oe,{label:!0,width:"w-[140px]",children:"사업부 매출"}),i.jsx(oe,{})]}),i.jsxs(ht,{equalItems:!0,children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"매출확정여부"}),i.jsx(oe,{children:a.confirmed?"YES":"NO"}),i.jsx(oe,{label:!0,width:"w-[140px]",children:"지원프로그램"}),i.jsx(oe,{grow:!0,children:((Se=a.proposal)==null?void 0:Se.name)||"-"})]}),i.jsxs(ht,{children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"매출품목"}),i.jsx(oe,{children:"-"})]}),i.jsxs(ht,{children:[i.jsx(oe,{label:!0,width:"w-[140px]",children:"비고"}),i.jsx(oe,{className:"flex-1 px-0.5",children:l!=="editBase"?a.description||"-":S("description",a.description||"-")})]})]})},Cx=({data:a,controlMode:l,featureMode:s})=>{const f=Es(),{formData:p,handleAddPayment:y,handlePaymentChange:_,handleRemovePayment:C,isSubmitting:A,errors:P,processPaymentSubmit:E,selectedPaymentIds:b,resetPaymentForm:R}=f,{validatePayments:x}=_a(p),S=async j=>{j.preventDefault();const K=a.id;console.log("***** form : ",p.salesByPayments),console.log("***** sfaId : ",K);const $=x(p.salesByPayments);console.log(`***** paymentErrors : ${$}`),!($.length>0)&&await E("create",K,K)},F=async()=>{R()},w=()=>l==="edit"&&s==="addPayment"?i.jsx(De,{type:"button",variant:"primary",onClick:y,disabled:A||p.salesByPayments.length>=3,className:`
            w-full mb-6 px-4 h-8 text-base font-medium
            ${p.salesByPayments.length>=3?"bg-gray-50 text-gray-400 border-gray-200 cursor-not-allowed":"bg-cyan-500 border-blue-300 text-gray-600 hover:bg-blue-100 hover:border-blue-400 hover:text-white"}
          `,children:"+ 결제매출추가"}):l==="edit"&&s==="editPayment"?i.jsx("div",{children:i.jsxs("h3",{className:"text-lg font-medium mb-3",children:["수정 결제매출 ID : ",b.id]})}):null;return i.jsxs(i.Fragment,{children:[w(),i.jsxs(As,{onSubmit:S,className:"space-y-6",method:"POST",action:"#",children:[i.jsx(ba,{payments:p.salesByPayments,onChange:_,onRemove:C,isSubmitting:A}),i.jsx(bt,{children:p.salesByPayments.length!==0&&i.jsxs(bt,{direction:"horizontal",spacing:"md",className:"pt-4 border-t border-gray-200",children:[i.jsx(De,{type:"button",variant:"primary",disabled:A,className:"w-[120px] h-8 text-base font-medium bg-indigo-500 hover:bg-fuchsia-500",onClick:F,children:"취소"}),i.jsx(De,{type:"submit",variant:"primary",disabled:A,className:"w-[120px] h-8 text-base font-medium bg-indigo-500 hover:bg-fuchsia-500",onClick:j=>{j.preventDefault(),S(j)},children:A?"처리중...":s==="addPayment"?"저장":"수정"})]})})]})]})},Ax=({data:a,onView:l,controlMode:s="view",featureMode:f,handlePaymentSelection:p})=>{const y=()=>s==="view"?i.jsx(me.Th,{children:"Action"}):i.jsx(me.Th,{children:"Action"}),_=(C,A)=>s==="view"?i.jsx(me.Td,{align:"center",children:i.jsx(De,{size:"sm",variant:"outline",onClick:()=>l==null?void 0:l({documentId:C,id:A}),children:"view"})}):f==="editPayment"?i.jsx(me.Td,{align:"center",children:i.jsx(De,{size:"sm",variant:"outline",onClick:()=>p==null?void 0:p({documentId:C,id:A}),children:"edit"})}):"";return!Array.isArray(a)||a.length===0?i.jsxs("div",{children:[i.jsx(me.Title,{children:"매출 내역"}),i.jsxs(me,{children:[i.jsx(me.Head,{children:i.jsxs(me.Row,{children:[i.jsx(me.Th,{children:"ID"}),i.jsx(me.Th,{children:"구분"}),i.jsx(me.Th,{children:"확정여부"}),i.jsx(me.Th,{children:"확률"}),i.jsx(me.Th,{children:"매출액"}),i.jsx(me.Th,{children:"매출이익"}),i.jsx(me.Th,{children:"매출인식일"}),y()]})}),i.jsx(me.Body,{children:i.jsx(me.Row,{children:i.jsx(me.Td,{colSpan:7,className:"text-center",children:"등록된 매출 내역이 없습니다."})})})]})]}):i.jsxs("div",{children:[i.jsx(me.Title,{children:"매출 내역"}),i.jsxs(me,{children:[i.jsx(me.Head,{children:i.jsxs(me.Row,{children:[i.jsx(me.Th,{children:"ID"}),i.jsx(me.Th,{children:"매출구분"}),i.jsx(me.Th,{children:"확정여부"}),i.jsx(me.Th,{children:"확률"}),i.jsx(me.Th,{children:"매출액"}),i.jsx(me.Th,{children:"매출이익"}),i.jsx(me.Th,{children:"매출인식일"}),y()]})}),i.jsx(me.Body,{children:a.map((C,A)=>i.jsxs(me.Row,{children:[i.jsx(me.Td,{align:"center",children:C.id||"-"}),i.jsx(me.Td,{align:"center",children:C.billing_type||"-"}),i.jsx(me.Td,{align:"center",children:C.is_confirmed?"YES":"NO"}),i.jsx(me.Td,{align:"center",children:C.probability||"-"}),i.jsx(me.Td,{align:"right",children:typeof C.amount=="number"?C.amount.toLocaleString():"-"}),i.jsx(me.Td,{align:"right",children:typeof C.profit_amount=="number"?C.profit_amount.toLocaleString():"-"}),i.jsx(me.Td,{align:"center",children:C.recognition_date||"-"}),_(C.documentId,C.id)]},C.id||A))})]})]})},yu=({data:a,controlMode:l,featureMode:s})=>{const[f,p]=L.useState({documentId:null,id:null}),{formData:y,isSubmitting:_,handlePaymentChange:C,processPaymentSubmit:A,togglePaymentSelection:P,resetPaymentForm:E}=Es(),{validatePayments:b}=_a(y),R=async j=>{j.preventDefault();const K=a.id,$=b(y.salesByPayments);console.log(`***** paymentErrors : ${$}`),!($.length>0)&&await A("update",f.id,K)},x=()=>{p({documentId:null,id:null}),E()},S=j=>{console.log(">> handlepayment selection : ",j),p(j),P(j)},F=j=>{console.log("View payment:",j)};console.log(">>sfapaymentsection formdata : ",y),console.log(`controlmode ${l}, feturemode ${s}`);const w=()=>l==="edit"&&s==="editPayment"?i.jsxs(i.Fragment,{children:[i.jsxs("h3",{className:"text-lg font-medium mb-3",children:["수정 결제매출 ID : ",(f==null?void 0:f.id)||""]}),i.jsxs(As,{onSubmit:R,className:"space-y-6",method:"PUT",action:"#",children:[i.jsx(ba,{payments:y.salesByPayments,onChange:C,isSubmitting:_}),i.jsx(bt,{children:y.salesByPayments.length!==0&&i.jsxs(bt,{direction:"horizontal",spacing:"md",className:"pt-4 border-t border-gray-200",children:[i.jsx(De,{type:"button",variant:"primary",disabled:_,className:"w-[120px] h-8 text-base font-medium bg-indigo-500 hover:bg-fuchsia-500",onClick:x,children:"취소"}),i.jsx(De,{type:"submit",variant:"primary",disabled:_,className:"w-[120px] h-8 text-base font-medium bg-indigo-500 hover:bg-fuchsia-500",onClick:j=>{j.preventDefault(),R(j)},children:_?"처리중...":s==="addPayment"?"저장":"수정"})]})})]})]}):null;return i.jsxs(i.Fragment,{children:[w(),i.jsx("div",{className:"space-y-6",children:i.jsx(Ax,{data:a.sfa_by_payments||[],controlMode:l,featureMode:s,onView:F,handlePaymentSelection:S})})]})},Ex=()=>{const a=ru(su("sfa_sales_type")),l=ru(su("sfa_classification")),{togglePaymentSelection:s,resetPaymentForm:f}=Es(),{drawerState:p,setDrawer:y,setDrawerClose:_}=xn(),{visible:C,controlMode:A,featureMode:P,data:E}=p,b=[{key:"view",label:"View",active:A==="view",onClick:()=>{y({controlMode:"view"})}},{key:"edit",label:"Edit",active:A==="edit",onClick:()=>{y({controlMode:"edit"})}}],R=A==="edit"?[{key:"editBase",label:"기본정보수정",active:P==="editBase",onClick:()=>{y({featureMode:"editBase"}),f()}},{key:"addPayment",label:"결제매출등록",active:P==="addPayment",onClick:()=>{y({featureMode:"addPayment"}),f()}},{key:"editPayment",label:"결제매출수정",active:P==="editPayment",onClick:()=>{y({featureMode:"editPayment"}),f()}}]:[],x=()=>A&&{add:"매출등록",view:"SFA 상세정보",edit:"SFA 수정"}[A]||"",S=()=>i.jsx(bx,{sfaSalesTypeData:a,sfaClassificationData:l}),F=({data:j})=>i.jsxs(i.Fragment,{children:[i.jsx(wx,{data:j}),i.jsx(yu,{data:j,controlMode:A,featureMode:P,togglePaymentSelection:s})]}),w=({data:j})=>i.jsxs(i.Fragment,{children:[i.jsx("h1",{children:"기본정보수정"}),i.jsx(Ix,{data:j,featureMode:P,sfaSalesTypeData:a,sfaClassificationData:l}),P==="addPayment"&&i.jsx(Cx,{data:j,controlMode:A,featureMode:P}),i.jsx(yu,{data:j,controlMode:A,featureMode:P,togglePaymentSelection:s})]});return i.jsxs(Du,{visible:C,title:x(),onClose:_,menu:i.jsx(px,{controlMenus:b,functionMenus:R}),width:"900px",enableOverlayClick:!1,controlMode:A,children:[A==="add"&&i.jsx(S,{}),A==="view"&&i.jsx(F,{data:E}),A==="edit"&&i.jsx(w,{data:E})]})},Pn=({type:a="empty",message:l,className:s=""})=>{const f={empty:"text-gray-500 bg-white",loading:"text-gray-500 bg-white",error:"text-red-600 bg-red-50"};return i.jsx("div",{className:`p-12 text-center ${f[a]} ${s}`,children:l||Nx(a)})},Nx=a=>({empty:"데이터가 없습니다.",loading:"데이터를 불러오는 중...",error:"오류가 발생했습니다."})[a],nt=({children:a,onClick:l,colSpan:s,rowSpan:f})=>i.jsx("th",{onClick:l,colSpan:s,rowSpan:f,className:`
      bg-gray-100 p-3 text-center border border-gray-200 
      font-semibold text-sm cursor-pointer
      hover:bg-gray-200 transition-colors
    `,children:a}),rt=({children:a,onClick:l,isProbability:s})=>i.jsx("td",{onClick:l,className:`
      p-3 border border-gray-200 text-sm cursor-pointer
      ${s?"bg-gray-50 text-center font-medium":"text-right"}
      hover:bg-gray-100 transition-colors
    `,children:a}),Tx=()=>{const[a,l]=L.useState({}),[s,f]=L.useState(!0),[p,y]=L.useState(null),[_,C]=L.useState({yearMonth:null,probability:null}),{updateMonthlyFilter:A}=Nu(),E=(()=>{const w=ze(),j=[];for(let K=-1;K<=2;K++){const $=w.add(K,"month");j.push({month:$.format("MM"),year:$.year()})}return j})(),b=["confirmed","100","90","70","50"],R=w=>{if(!w)return{};const j={};return b.forEach(K=>{const $=w[K];$&&(j[K]={revenue:parseInt($.revenue||0),profit:parseInt($.profit||0)})}),j},x=(w,j)=>{const K=`${w.year}-${w.month}`;_.yearMonth===K&&_.probability===j||(C({yearMonth:K,probability:j}),A(K,j))},S=w=>{const j=`${w.year}-${w.month}`;_.yearMonth===j&&_.probability===null||(C({yearMonth:j,probability:null}),A(j,null))};if(L.useEffect(()=>{(async()=>{f(!0),y(null);try{const j={};for(const{year:K,month:$}of E)try{const le=ze().year(K).month($-1),fe=le.startOf("month").format("YYYY-MM-DD"),Se=le.endOf("month").format("YYYY-MM-DD"),M=await Nr.getSfaMonthStats(fe,Se);if(M){const V=R(M);Object.keys(V).length>0&&(j[$]=V)}}catch(le){console.error(`Error fetching data for ${K}-${$}:`,le),j[$]={}}l(j)}catch{y("통계 데이터를 불러오는데 실패했습니다.")}finally{f(!1)}})()},[]),s)return i.jsx(Pn,{type:"loading"});if(p)return i.jsx(Pn,{type:"error",message:p});const F=w=>i.jsxs("tr",{children:[i.jsx(rt,{isProbability:!0,onClick:()=>x(E[0],w),children:w}),E.map((j,K)=>{const $=a[j.month],le=($==null?void 0:$[w])||{revenue:0,profit:0};return K===0?w==="confirmed"?i.jsxs(Gn.Fragment,{children:[i.jsx(rt,{onClick:()=>x(j,w),children:le.revenue.toLocaleString()}),i.jsx(rt,{onClick:()=>x(j,w),children:le.profit.toLocaleString()})]},`${j.month}-prev`):i.jsxs(Gn.Fragment,{children:[i.jsx(rt,{onClick:()=>x(j,w),children:"-"}),i.jsx(rt,{onClick:()=>x(j,w),children:"-"})]},`${j.month}-prev`):K===1?w==="confirmed"?i.jsxs(Gn.Fragment,{children:[i.jsx(rt,{onClick:()=>x(j,w),children:"-"}),i.jsx(rt,{onClick:()=>x(j,w),children:"-"}),i.jsx(rt,{onClick:()=>x(j,w),children:le.revenue.toLocaleString()}),i.jsx(rt,{onClick:()=>x(j,w),children:le.profit.toLocaleString()})]},`${j.month}-current`):i.jsxs(Gn.Fragment,{children:[i.jsx(rt,{onClick:()=>x(j,w),children:le.revenue.toLocaleString()}),i.jsx(rt,{onClick:()=>x(j,w),children:le.profit.toLocaleString()}),i.jsx(rt,{onClick:()=>x(j,w),children:"-"}),i.jsx(rt,{onClick:()=>x(j,w),children:"-"})]},`${j.month}-current`):i.jsxs(Gn.Fragment,{children:[i.jsx(rt,{onClick:()=>x(j,w),children:le.revenue.toLocaleString()}),i.jsx(rt,{onClick:()=>x(j,w),children:le.profit.toLocaleString()})]},`${j.month}-future`)})]},w);return i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"w-full border-collapse text-sm my-5",children:[i.jsxs("thead",{children:[i.jsxs("tr",{children:[i.jsx(nt,{rowSpan:"2",children:"확률"}),i.jsxs(nt,{colSpan:"2",onClick:()=>S(E[0]),children:["전월(",E[0].year,".",E[0].month,")"]}),i.jsxs(nt,{colSpan:"4",onClick:()=>S(E[1]),children:["당월(",E[1].year,".",E[1].month,")"]}),i.jsxs(nt,{colSpan:"2",onClick:()=>S(E[2]),children:["익월(",E[2].year,".",E[2].month,")"]}),i.jsxs(nt,{colSpan:"2",onClick:()=>S(E[3]),children:["익익월(",E[3].year,".",E[3].month,")"]})]}),i.jsxs("tr",{children:[i.jsx(nt,{children:"실제매출액"}),i.jsx(nt,{children:"실제매출이익"}),i.jsx(nt,{children:"예상매출액"}),i.jsx(nt,{children:"예상매출이익"}),i.jsx(nt,{children:"실제매출액"}),i.jsx(nt,{children:"실제매출이익"}),i.jsx(nt,{children:"예상매출액"}),i.jsx(nt,{children:"예상매출이익"}),i.jsx(nt,{children:"예상매출액"}),i.jsx(nt,{children:"예상매출이익"})]})]}),i.jsx("tbody",{children:b.map(F)})]})})},xu=({children:a})=>i.jsx("th",{className:`\r
    bg-gray-100 \r
    p-3 \r
    text-center \r
    border \r
    border-gray-200 \r
    font-semibold \r
    text-sm \r
    whitespace-nowrap\r
  `,children:a}),_u=({children:a,isProbability:l=!1})=>i.jsx("td",{className:`
    p-3 
    border 
    border-gray-200 
    text-sm
    ${l?"bg-gray-50 text-center font-medium":"text-right"}
  `,children:a}),Rx=()=>{const[a,l]=L.useState({}),[s,f]=L.useState(!0),[p,y]=L.useState(null),C=(()=>{const R=ze(),x=[];for(let S=0;S<12;S++){const F=R.add(S,"month");x.push({month:String(F.month()+1).padStart(2,"0"),year:F.year(),startDate:F.startOf("month").format("YYYY-MM-DD"),endDate:F.endOf("month").format("YYYY-MM-DD")})}return x})(),A=["confirmed","100","90","70","50"],P=R=>{if(!R)return{};const x={};return A.forEach(S=>{const F=R[S];F&&(x[S]={revenue:parseInt(F.revenue||0)})}),x};if(L.useEffect(()=>{(async()=>{f(!0),y(null);try{const x=C.map(({month:w,startDate:j,endDate:K})=>Nr.getSfaMonthStats(j,K).then($=>{const le=P($);return{month:w,data:le}}).catch($=>(console.error(`Error fetching data for ${j} to ${K}:`,$),{month:w,data:{}}))),F=(await Promise.all(x)).reduce((w,{month:j,data:K})=>(w[j]=K,w),{});l(F)}catch(x){console.error("Failed to fetch forecast data:",x),y("예측 데이터를 불러오는데 실패했습니다.")}finally{f(!1)}})()},[]),s)return i.jsx(Pn,{type:"loading"});if(p)return i.jsx(Pn,{type:"error",message:p});const E=R=>i.jsxs("tr",{children:[i.jsx(_u,{isProbability:!0,children:R}),C.map(x=>{const F=(a[x.month]||{})[R]||{revenue:0};return i.jsx(_u,{children:F.revenue.toLocaleString()},`${x.year}-${x.month}`)})]},R),b=(R,x)=>`${x}.${R}`;return i.jsxs("div",{className:"space-y-4",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"년간 매출예측"}),i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"w-full border-collapse text-sm my-5",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx(xu,{children:"확률"}),C.map(R=>i.jsx(xu,{children:b(R.month,R.year)},`${R.year}-${R.month}`))]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:A.map(E)})]})})]})},Px=({children:a,className:l="",...s})=>i.jsx("div",{className:`bg-white border border-gray-200 rounded-lg overflow-hidden ${l}`,...s,children:a}),Dx=({current:a,pageSize:l,total:s,onPageChange:f,onPageSizeChange:p,className:y=""})=>{const _=Math.ceil(s/l);return i.jsxs("div",{className:`flex justify-between items-center p-4 border-t border-gray-200 ${y}`,children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"페이지당 행:"}),i.jsxs("select",{className:"text-sm border border-gray-300 rounded-md px-2 py-1",value:l,onChange:C=>p(Number(C.target.value)),children:[i.jsx("option",{value:10,children:"10"}),i.jsx("option",{value:20,children:"20"}),i.jsx("option",{value:50,children:"50"})]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(De,{variant:"outline",size:"sm",disabled:a===1,onClick:()=>f(a-1),children:"이전"}),i.jsxs("span",{className:"text-sm text-gray-600",children:[a," / ",_," 페이지 (총 ",s,"개)"]}),i.jsx(De,{variant:"outline",size:"sm",disabled:a===_,onClick:()=>f(a+1),children:"다음"})]})]})},Mx=[{key:"no",title:"No",align:"center"},{key:"confirmed",title:"확정여부",align:"center"},{key:"percentage",title:"확률",align:"center"},{key:"customer",title:"고객사/매출처",align:"left"},{key:"name",title:"건명",align:"left"},{key:"payment",title:"결제방법",align:"center"},{key:"classification",title:"매출구분",align:"center"},{key:"item",title:"매출품목",align:"center"},{key:"team",title:"사업부",align:"center"},{key:"revenue",title:"매출액",align:"right"},{key:"profit",title:"매출이익",align:"right"},{key:"date",title:"매출인식일",align:"center"},{key:"action",title:"Action",align:"center"}],Fx=({item:a,index:l,pageSize:s,currentPage:f})=>{var C,A,P,E,b,R;const p=(f-1)*s+l+1,y=((C=a.sfa)==null?void 0:C.sfa_item_price)||[],{fetchSfaDetail:_}=xn();return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-3 py-2 text-center text-sm",children:p}),i.jsx("td",{className:"px-3 py-2 text-center text-sm",children:a.is_confirmed?"YES":"NO"}),i.jsx("td",{className:"px-3 py-2 text-center text-sm",children:a.probability||"-"}),i.jsx("td",{className:"px-3 py-2 text-sm",children:((P=(A=a.sfa)==null?void 0:A.customer)==null?void 0:P.name)||"-"}),i.jsx("td",{className:"px-3 py-2 text-sm",children:(E=a.sfa)==null?void 0:E.name}),i.jsx("td",{className:"px-3 py-2 text-center text-sm",children:a.billing_type||"-"}),i.jsx("td",{className:"px-3 py-2 text-center text-sm",children:((R=(b=a.sfa)==null?void 0:b.sfa_classification)==null?void 0:R.name)||"-"}),i.jsx("td",{className:"px-3 py-2 text-center text-sm",children:y.map(x=>x.sfa_item_name).join(", ")||"-"}),i.jsx("td",{className:"px-3 py-2 text-center text-sm",children:y.map(x=>x.team_name).join(", ")||"-"}),i.jsx("td",{className:"px-3 py-2 text-right text-sm font-mono",children:new Intl.NumberFormat("ko-KR").format(a.amount)}),i.jsx("td",{className:"px-3 py-2 text-right text-sm font-mono",children:new Intl.NumberFormat("ko-KR").format(a.profit_amount)}),i.jsx("td",{className:"px-3 py-2 text-center text-sm",children:a.recognition_date}),i.jsx("td",{className:"px-3 py-2 text-center",children:i.jsx(De,{variant:"outline",size:"sm",onClick:()=>_(a.sfa.id),children:"View"})})]})},Ox=()=>{const{sfaData:a,loading:l,error:s,pagination:f,setPage:p,setPageSize:y}=xn();return l?i.jsx(Pn,{type:"loading"}):s?i.jsx(Pn,{type:"error",message:s}):a!=null&&a.length?i.jsxs(Px,{children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsx("tr",{className:"bg-gray-50 border-y border-gray-200",children:Mx.map(_=>i.jsx("th",{className:`px-3 py-2 text-sm font-semibold text-gray-700 whitespace-nowrap
                    ${_.align==="center"&&"text-center"}
                    ${_.align==="right"&&"text-right"}
                  `,children:_.title},_.key))})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:a.map((_,C)=>i.jsx(Fx,{item:_,index:C,pageSize:f.pageSize,currentPage:f.current},_.id))})]})}),i.jsx(Dx,{current:f.current,pageSize:f.pageSize,total:f.total,onPageChange:p,onPageSizeChange:y})]}):i.jsx(Pn,{type:"empty"})},Lx=()=>{const{setLayout:a,setDrawer:l,resetFilters:s}=xn();return i.jsxs(bt,{direction:"horizontal",spacing:"sm",className:"mb-5",children:[i.jsx(De,{variant:"outline",onClick:()=>l({visible:!0,controlMode:"add"}),children:"매출등록"}),i.jsx(De,{variant:"outline",onClick:()=>a("search"),children:"상세조회"}),i.jsx(De,{variant:"outline",onClick:()=>a("forecast"),children:"매출예측"}),i.jsx(De,{variant:"outline",onClick:()=>{s(),a("default")},children:"초기화"})]})},$x=a=>{const[l,s]=L.useState([]),[f,p]=L.useState(!1),[y,_]=L.useState(null),C=async A=>{if(!A){s([]);return}p(!0),_(null);try{const P=await Zn.getSfaItems(A);s(P)}catch(P){console.error("Failed to fetch SFA items:",P),_(P),s([])}finally{p(!1)}};return L.useEffect(()=>{C(a)},[a]),{data:l,isLoading:f,error:y,refetch:C}},Bx=()=>{var F,w,j,K,$,le,fe,Se,M,V;const{updateDetailFilter:a}=Nu(),{data:l,isLoading:s,error:f}=Fu(["re_payment_method","sfa_percentage","sfa_sales_type","sfa_classification"]),p={name:"",customer:"",sfaSalesType:"",sfaClassification:"",salesItem:"",team:"",billingType:"",probability:""},[y,_]=L.useState({dateRange:{startDate:ze().startOf("month").format("YYYY-MM-DD"),endDate:ze().endOf("month").format("YYYY-MM-DD")},...p}),{data:C,isLoading:A}=Mu(),{data:P,refetch:E}=$x();L.useEffect(()=>{y.sfaClassification&&E(y.sfaClassification)},[y.sfaClassification]);const b=k=>{console.log(">> handleInputChange : ",k.target.value);const{name:X,value:ee}=k.target;_(X==="startDate"||X==="endDate"?Ae=>({...Ae,dateRange:{...Ae.dateRange,[X]:ee}}):X==="sfaClassification"?Ae=>({...Ae,salesItem:"",[X]:ee}):Ae=>({...Ae,[X]:ee}))},R=k=>{_(X=>({...X,customer:k.id}))},x=k=>{k.preventDefault(),a(y)},S=()=>{_({dateRange:{startDate:ze().startOf("month").format("YYYY-MM-DD"),endDate:ze().endOf("month").format("YYYY-MM-DD")},...p})};return i.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-5 mb-5",children:i.jsxs(As,{onSubmit:x,className:"space-y-4",children:[i.jsxs(Ar,{direction:"horizontal",spacing:"lg",children:[i.jsxs(Ue,{children:[i.jsx(qe,{children:"기준일자"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(it,{type:"date",name:"startDate",value:y.dateRange.startDate,onChange:b}),i.jsx("span",{className:"text-gray-500",children:"~"}),i.jsx(it,{type:"date",name:"endDate",value:y.dateRange.endDate,onChange:b})]})]}),i.jsxs(Ue,{children:[i.jsx(qe,{children:"매출구분"}),i.jsxs(dt,{name:"sfaClassification",value:y.sfaClassification,onChange:b,children:[i.jsx("option",{value:"",children:"선택하세요"}),(w=(F=l==null?void 0:l.sfa_classification)==null?void 0:F.data)==null?void 0:w.map(k=>i.jsx("option",{value:k.id,children:k.name},k.id))]})]}),i.jsxs(Ue,{children:[i.jsx(qe,{children:"매출유형"}),i.jsxs(dt,{name:"sfaSalesType",value:y.sfaSalesType,onChange:b,children:[i.jsx("option",{value:"",children:"선택하세요"}),(K=(j=l==null?void 0:l.sfa_sales_type)==null?void 0:j.data)==null?void 0:K.map(k=>i.jsx("option",{value:k.id,children:k.name},k.id))]})]})]}),i.jsxs(Ar,{direction:"horizontal",spacing:"lg",children:[i.jsxs(Ue,{children:[i.jsx(qe,{children:"매출처"}),i.jsx(Tr,{value:y.customer,onSelect:R,size:"small"})]}),i.jsxs(Ue,{children:[i.jsx(qe,{children:"매출품목"}),i.jsxs(dt,{name:"salesItem",value:y.salesItem,onChange:b,children:[i.jsx("option",{value:"",children:"선택하세요"}),($=P==null?void 0:P.data)==null?void 0:$.map(k=>i.jsx("option",{value:k.name,children:k.name},k.id))]})]}),i.jsxs(Ue,{children:[i.jsx(qe,{children:"확률"}),i.jsxs(dt,{name:"probability",value:y.probability,onChange:b,children:[i.jsx("option",{value:"",children:"선택하세요"}),i.jsx("option",{value:"confirmed",children:"확정"}),(fe=(le=l.sfa_percentage)==null?void 0:le.data)==null?void 0:fe.map(k=>i.jsx("option",{value:k.name,children:k.name},k.id))]})]})]}),i.jsxs(Ar,{direction:"horizontal",spacing:"lg",children:[i.jsxs(Ue,{children:[i.jsx(qe,{children:"건명"}),i.jsx(it,{type:"text",name:"name",value:y.name,onChange:b,placeholder:"건명 입력"})]}),i.jsxs(Ue,{children:[i.jsx(qe,{children:"사업부"}),i.jsxs(dt,{name:"team",value:y.team,onChange:b,children:[i.jsx("option",{value:"",children:"선택하세요"}),(Se=C==null?void 0:C.data)==null?void 0:Se.map(k=>i.jsx("option",{value:k.name,children:k.name},k.id))]})]}),i.jsxs(Ue,{children:[i.jsx(qe,{children:"결제유형"}),i.jsxs(dt,{name:"billingType",value:y.billingType,onChange:b,children:[i.jsx("option",{value:"",children:"선택하세요"}),(V=(M=l.re_payment_method)==null?void 0:M.data)==null?void 0:V.map(k=>i.jsx("option",{value:k.name,children:k.name},k.id))]})]})]}),i.jsxs(bt,{direction:"horizontal",className:"justify-center",children:[i.jsx(De,{type:"button",variant:"primary",onClick:x,children:"검색"}),i.jsx(De,{type:"button",variant:"outline",onClick:S,children:"초기화"})]})]})})},Yx=()=>{const{pageLayout:a,drawerState:l}=xn(),{components:s}=a;return i.jsxs(i.Fragment,{children:[i.jsxs(Ny,{children:[i.jsx(Lx,{}),s.searchForm&&i.jsx(Bx,{}),s.forecastTable&&i.jsx(Rx,{}),s.monthlyStatus&&i.jsx(Tx,{}),s.sfaTable&&i.jsx(Ox,{})]}),l.visible&&i.jsx(Ex,{})]})},Ux=()=>i.jsx(Qy,{children:i.jsx(Yx,{})});export{Ux as default};
